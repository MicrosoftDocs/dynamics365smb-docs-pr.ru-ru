---
title: открытые операции книги товаров
description: Узнайте, почему уровень запасов равен нулю, хотя существуют открытые операции книги товаров.
author: edupont04
ms.service: dynamics365-business-central
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: ''
ms.date: 10/01/2020
ms.author: edupont
ms.openlocfilehash: 1222f3b7ed3c71ded3f653bb121b920c170c40f5
ms.sourcegitcommit: ddbb5cede750df1baba4b3eab8fbed6744b5b9d6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2020
ms.locfileid: "3924269"
---
# <a name="design-details-known-item-application-issue"></a>Сведения о проектировании: известная проблема применения товара
В этой статье рассматривается проблема, когда уровень запасов равен нулю несмотря на наличие открытых записей книги товаров в [!INCLUDE[d365fin](includes/d365fin_md.md)].  

В начале статьи перечислены типичные признаки проблемы, затем рассматриваются основы применения товара в поддержку описанных причин этой проблемы. В конце статьи приведен способ обхода проблемы с такими открытыми операциями книги товаров.  

## <a name="symptoms-of-the-issue"></a>Признаки проблемы  
 Ниже приведены типичные симптомы проблемы с нулевым значением запасов несмотря на наличие открытых операций книги товаров:  

-   Следующее сообщение при попытке закрыть учетный период: «Склад не может быть закрыт, так как имеются отрицательные остатки для одного или нескольких товаров».  

-   Ситуация с операцией книги товаров, когда открыты как исходящая операция книги товаров, так и связанная с ней входящая операция книги товаров.  

     См. в следующем примере ситуацию с операцией книги товаров.  

     |Номер операции|Дата учета|Тип операции|Тип документа|Номер документа|Номер товара|Код склада|Количество|Сумма себестоимости (факт.)|Кол-во по выст. счетам|Остаток|Открытые|  
     |---------|------------|----------|-------------|------------|--------|-------------|--------|------------------------|-----------------|------------------|----|  
     |333|28.01.2018|Продажа|Расходная накладная продажи|102043|ТЕСТ|СИНИЙ|-1|-10|-1|-1|Да|  
     |334|28.01.2018|Продажа|Расходная накладная продажи|102043|ТЕСТ|СИНИЙ|1|10|1|1|Да|  

## <a name="basics-of-item-application"></a>Основы применения товара  
 Операция применения товара создается для каждой складской транзакции, чтобы связать получателя стоимости с его источником стоимости, чтобы стоимость можно было передать в соответствии с методом учета себестоимости. Дополнительные сведения см. в разделе [Сведения о проектировании: применение товара](design-details-item-application.md).  

-   Для входящей операции книги товаров операция применения товара создается, когда создается операция книги товаров.  

-   Для исходящей операции книги товаров операция применения товара создается при учете операции книги товаров, ЕСЛИ имеется открытая входящая операция книги товаров с доступным количеством, которое можно применить. Если нет открытой входящей операции книги товаров, к которой возможно применение, то исходящая операция книги товаров остается открытой до тех пор, пока не будет учтена входящая операция книги товаров, к которой можно применить исходящую операцию.  

 Имеется два типа применения товара:  

-   Применение количества  

-   Применение себестоимости  

### <a name="quantity-application"></a>Применение количества  
 Применения количества выполняются для всех складских транзакций и создаются автоматически или вручную в особенных процессах. При создании вручную применения количества называются фиксированным применением.  

 Следующая диаграмма показывает, как выполняются применения количества.  

![Порядок корректировки себестоимости от приобретения до продажи](media/helene/TechArticleInventoryZero2.png "Порядок корректировки себестоимости от приобретения до продажи")

 Обратите внимание выше, что операция книги товаров 1 (Покупка) является как поставщиком товара, так и источником стоимости для примененной операции книги товаров, операции книги товаров 2 (Продажа).  

> [!NOTE]  
>  Если исходящая операция книги товара оценена по средней себестоимости, то примененная входящая операции книги товаров не является уникальным источником себестоимости. Она является только частью в вычислении средней себестоимости за период.  

### <a name="cost-application"></a>Применение себестоимости  
Применения себестоимости создаются только для входящих транзакций, в которых поле **Примен. из товарной операции** заполняется для предоставления фиксированного применения. Обычно это происходит в связи со сценарием кредит-ноты продажи или отмены отгрузки. Применение себестоимости обеспечивает, что товар вводится обратно в запасы как с той же стоимостью, с какой он был отгружен.  

Следующая диаграмма показывает, как выполняются применения стоимости.  

|Номер операции|Дата учета|Тип операции|Тип документа|Номер документа|Номер товара|Код склада|Количество|Сумма себестоимости (факт.)|Кол-во по выст. счетам|Остаток|Открытые|  
|---------|------------|----------|-------------|------------|--------|-------------|--------|------------------------|-----------------|------------------|----|  
|333|28.01.2018|Продажа|Расходная накладная продажи|102043|ТЕСТ|СИНИЙ|-1|-10|-1|-1|Да|  
|334|28.01.2018|Продажа|Расходная накладная продажи|102043|ТЕСТ|СИНИЙ|1|10|1|1|Да|  

 Обратите внимание выше, что входящая операция книга товаров 3 (Возврат продажи) является получателем себестоимости для исходной исходящей операции книги товаров 2 (Продажа).  

## <a name="illustration-of-a-basic-cost-flow"></a>Иллюстрация базового потока стоимости  
 Предположим полный поток стоимости, где товар получен, отгружен, за него выставлен счет, он возвращен с точным\- обращением стоимости и отгружен еще раз.  

 Следующая диаграмма иллюстрирует поток стоимости.  

![Порядок корректировки себестоимости от продажи до возврата продажи](media/helene/TechArticleInventoryZero4.png "Порядок корректировки себестоимости от продажи до возврата продажи")

 Обратите внимание выше, что стоимость передается в операцию книги товаров 2 (Продажа), затем в операцию книги товаров 3 (Возврат продажи), и наконец в операцию книги товаров 4 (Продажа 2).  

## <a name="reasons-for-the-issue"></a>Причины проблемы  
 Проблема с нулевым значением запасов несмотря на наличие открытых операций книги товаров может быть вызвана следующими сценариями:  

-   Сценарий 1. Отгрузка и счет учтены, хотя товар недоступен. Учет затем точно обращается с помощью кредит-ноты продаж.  

-   Сценарий 2. Отгрузка учтена, хотя товар недоступен. Учет затем отменяется с помощью функции отмены отгрузки.  

 Следующая диаграмма демонстрирует, как применения товара осуществляются в обоих сценариях.  

![Порядок корректировки себестоимости в обоих направлениях](media/helene/TechArticleInventoryZero6.png "Порядок корректировки себестоимости в обоих направлениях")  

 Обратите внимание выше на то, что применение стоимости выполняется (представлено с помощью синих стрелок) для обеспечения того, чтобы операции книги товаров 2 (Возврат продажи) была бы назначена та же стоимость, что и операции книги товаров, которую она обращает, операция книги товаров 1 (Продажа 1). Однако применение количества (показано красными стрелками) не производится.  

 Операция книги товаров 2 (Возврат продажи) не может быть одновременно получателем стоимости исходной операции книги товаров и в это же время источником товаров и их источником стоимости. Таким образом, исходная операция книги товаров 1 (Продажа 1) остается открытой до появления допустимого источника.  

## <a name="identifying-the-issue"></a>Идентификация проблемы  
 Для выяснения, созданы ли открытые операции книги товаров, выполните следующие действия для соответствующего сценария:  

 Для сценария 1 проблема выявляется следующим образом:  

-   На странице **Учтенная кредит-нота продажи** или **Учтенная возвратная накладная** выполните поиск из поля **Примен.\-из товарной операции**, чтобы посмотреть, заполнено ли это поле, и в этом случае к какой операции книги товаров применена стоимость приходной накладной.  

 Для сценария 2 укажите проблему одним из следующих способов:  

-   Найдите открытую исходящую операцию книги товаров и входящую операцию книги учета товаров с тем же номером в поле **Номер документа** и значение «Да» в поле **Коррекция**. См. следующий пример такой ситуации с операцией книги товаров.  

|Номер операции|Дата учета|Тип операции|Тип документа|Номер документа|Номер товара|Код склада|Количество|Сумма себестоимости (факт.)|Кол-во по выст. счетам|Остаток|Открытые|Корректировка|  
|---------|------------|----------|-------------|------------|--------|-------------|--------|------------------------|-----------------|------------------|----|---------|
|333|28.01.2018|Продажа|Расходная накладная продажи|102043|ТЕСТ|СИНИЙ|-1|-10|-1|-1|Да|Нет|  
|334|28.01.2018|Продажа|Расходная накладная продажи|102043|ТЕСТ|СИНИЙ|1|10|1|1|Да|**Да**|  

-   На странице **Учтенная расх. накладная продажи** выполните поиск из поля **Примен. из товарной операции**, чтобы посмотреть, заполнено ли это поле, и в этом случае к какой операции книги товаров применена стоимость приходной накладной.  

> [!NOTE]  
>  Применения себестоимости не могут быть определены на странице **Примененные операции по товару**, так как на этой странице отображаются только применения количества.  

 Для обоих сценариев определите участвующее применение себестоимости следующим образом:  

1.  Откройте таблицу **Операция применения товара**.  

2.  Примените фильтр в поле **Номер товарной операции**, используя номер операции книги товаров с возвратом продажи.  

3.  Проанализируйте операцию применения товара, учитывая следующее:  

     Если поле **Номер исход. товарной операции** заполнено для входящей операции книги товаров (положительное количество), это означает, что входящая операция книги товаров является получателем стоимости исходящей операции книги товаров.  

     См. следующий пример операции применения товара.  

     |Номер операции|Номер товарной операции|Номер вход. товарной операции|Номер исход. товарной операции|Количество|Дата учета|Применение себестоимости|  
     |---------|---------------------|----------------------|-----------------------|--------|------------|----------------|  
     |299|334|334|333|1|28.01.2018|Да|  
<!--![Why is inventory zero 8](media/helene/TechArticleInventoryZero8.png "Whyisinventoryzero\_8")  -->

 Обратите внимание выше, что входящая операция книги товаров 334 применена по стоимости к исходящей операции книги товаров 333.  

## <a name="workaround-for-the-issue"></a>Обходное решение проблемы  
 На странице **Журнал товаров** выполните учет следующих строк для рассматриваемого товара:  

-   Приход для закрытия открытой исходящей операции книги товара.  

-   Расход с тем же количеством.  

     Эта корректировка балансирует приход склада с помощью прихода и закрывает открытую входящую операцию книги товаров.  

 В результате эти запасы равны нулю, и все операции книги товаров закрыты.  

## <a name="see-also"></a>См. также  
[Сведения о проектировании: применение товара](design-details-item-application.md)   
[Сведения о проектировании: себестоимость запасов](design-details-inventory-costing.md)  
