---
title: Использование шаблонов Word для массовых сообщений
description: 'Шаблоны Word могут упростить массовое создание документов, персонализированных для определенных сущностей.'
author: brentholtorf
ms.author: bholtorf
ms.reviewer: bholtorf
ms.topic: conceptual
ms.date: 02/01/2023
ms.custom: bap-template
ms.search.forms: '9989_Primary, 13, 9992_Primary, 9983_Primary'
ms.service: dynamics-365-business-central
---

# <a name="use-word-templates-for-bulk-communication"></a>Использование шаблонов Word для массовых сообщений

Шаблоны Microsoft Word могут упростить массовые сообщения в печатном виде или по электронной почте с такими сущностями, как контакты, клиенты и поставщики. Например, можно создавать:

* Брошюры для оповещения клиентов о кампании продаж
* Письма для информирования поставщиков о новой политике закупок
* Приглашения на предстоящее мероприятие для привлечения контактных лиц

> [!NOTE]
> При настройке шаблонов Word необходимо использовать устройство с Microsoft Word 2019 или более поздней версии и с установленной операционной системой Windows.

## <a name="set-up-the-source-of-data"></a>Настройка источника данных

Используйте объекты в [!INCLUDE[prod_short](includes/prod_short.md)] в качестве источника данных для шаблона и добавьте поля слияния, чтобы персонализировать документы для каждого объекта. Поля слияния берутся из сущности в [!INCLUDE[prod_short](includes/prod_short.md)]. Когда вы применяете шаблон Word к сущности, данные из полей слияния вставляются в документ.

При создании нового шаблона на странице **Шаблоны Word** мастер настройки поможет вам пошагово выполнить следующие действия:

1. Выберите один или несколько объектов для использования в качестве источника данных. Например, если вы хотите создать брошюру для кампании по продажам, вы, вероятно, выберете в качестве источника объект «Клиент».
2. Выберите другие объекты в качестве дополнительных источников данных. Узнайте больше в разделе [Добавление записей, связанных или несвязанных с объектом-источником](#add-entries-that-are-related-or-unrelated-to-the-source-entity).
3. Загрузка пустого шаблона. Вы можете сразу настроить шаблон в Word или загрузить пустой шаблон и пройти мастер до конца. Когда ваш шаблон будет готов, используйте действие **Загрузить** на странице **Шаблоны Word**, чтобы заменить пустой шаблон готовым шаблоном. Узнайте больше в разделе [Настройка шаблона в Word](#set-up-the-template-in-word).
4. Загрузите подготовленный шаблон.
5. Введите код и имя, идентифицирующие шаблон.

При скачивании шаблона вы получаете ZIP-файл, содержащий два файла.

|Файл  |Описание  |
|---------|---------|
|DataSource.xlsx     | Файл источника данных предоставляет поля, которые вы можете использовать в шаблоне. Не редактируйте файл источника данных. Вы можете использовать только файл шаблона Word и файл источника данных, которые вы скачали, и вы должны хранить эти файлы в одном и том же месте.     |
|Шаблон Word     | Файл DOCX для использования в качестве шаблона.        |

Чтобы узнать о настройке шаблона в Word, перейдите к разделу [Настройка шаблона в Word](#set-up-the-template-in-word).

## <a name="add-entries-that-are-related-or-unrelated-to-the-source-entity"></a>Добавление записей, связанных или несвязанных с объектом-источником

Вы также можете объединять данные из других объектов. Чтобы добавить другие объекты в качестве источников данных, используйте одно из следующих действий на странице **Шаблоны Word** или при использовании мастера настройки:

|Действие  |Описание  |
|---------|---------|
|**Добавить связанную сущность**  | Вы можете использовать данные из объектов, связанных с объектом-источником. Например, данные объекта «Клиент» можно объединить с данными из объекта «Контакт». Объекты связаны, когда поле одного объекта ссылается на поле другого объекта. Поле в объекте «Клиент» ссылается на поле в объекте «Контакт», поэтому эти объекты связаны. Таким общим полем часто является какой-либо идентификатор, например имя, код или числовой идентификатор.        |
|**Добавить несвязанную сущность**| Вы можете использовать данные из объектов, не связанных с объектом-источником. Пусть, например, вы создаете шаблон для объекта «Клиент». Вы можете добавить объект «Информация о компании», чтобы включить свои контактные данные. Главное преимущество состоит в том, что, если вы измените свою контактную информацию, она автоматически обновится и в вашем шаблоне. После добавления несвязанного объекта вы можете добавить связанные с ним объекты.         |

Для несвязанных объектов вы должны выбрать конкретную запись. Поскольку вы можете добавить объект только один раз, для использования другой записи вы должны удалить объект и снова добавить его с новой записью.

Вы можете создать иерархию связанных и несвязанных объектов. Связи между объектами отображаются в виде древовидной структуры. Поле **Связь объекта** также показывает информацию о связи. Для несвязанных объектов в поле отображается запись, создающая связь.

При добавлении объектов вы можете использовать поле **Префикс поля**, чтобы указать префикс для имен полей. Позже, когда вы будете добавлять поля в шаблон, префикс поможет отличать поля, происходящие из источника, от полей из других объектов.

### <a name="select-the-fields-to-include"></a>Выбор полей для включения

Для каждого объекта вы можете указать поля, которые должны быть доступны для шаблона. Выберите число в столбце **Количество выбранных полей**, чтобы получить доступ к списку доступных полей. На странице **Выбор полей** используйте флажок **Включить** для указания полей. Для некоторых объектов поля, которые обычно используются предприятиями, включены по умолчанию. Вы можете отредактировать список, например, чтобы удалить поля по умолчанию. Вносимые вами изменения применяются только к шаблону, над которым вы работаете.

> [!NOTE]
> Общее количество полей, которые вы можете добавить из всех объектов, составляет 250.

> [!NOTE]
> Вы или ваш партнер Майкрософт можете добавлять к объектам настраиваемые поля. Когда вы это сделаете, мы добавим к именам полей префикс **CALC** и присвоим им тип поля **Вычисляемое**. Тип поля называется "вычисляемое", чтобы подчеркнуть, что поле может отображать значения разных типов, например текст, числа, даты и т. д.

## <a name="to-create-a-word-template-in-business-central"></a>Чтобы создать шаблон Word в Business Central

1. Выберите значок ![Лампочка, которая открывает функцию «Что вы хотите сделать»](media/ui-search/search_small.png "Что вы хотите сделать"), значок введите **Шаблоны Word**, а затем выберите связанную ссылку.
2. Выберите **Создать**, затем **Создать шаблон**, а затем следуйте инструкциям в мастере настройки. [!INCLUDE[tooltip-inline-tip](includes/tooltip-inline-tip_md.md)]

> [!TIP]
> Вы также можете создать шаблон прямо со страницы для сущности, выбрав действие **Применить шаблон Word**, чтобы открыть мастер настройки, а затем **Создать шаблон**. Когда вы это сделаете, источник данных будет выбран за вас в зависимости от типа сущности.

## <a name="set-up-the-template-in-word"></a>Настройка шаблона в Word

Когда вы настраиваете шаблон в Word, на вкладке **Рассылки** вы можете добавить поля слияния, выбрав **Вставить поле слияния**. Поля слияния берутся из файла источника данных, который вы скачали для объекта. Они действуют как заполнители, которые сообщают Word, где в документе разместить информацию о сущности.

:::image type="content" source="media/word-tmpl-merge-field.PNG" alt-text="Добавление полей объединения в Microsoft Word":::

## <a name="apply-a-template"></a>Применение шаблона

Когда ваш шаблон Word будет готов, на странице **Шаблоны Word** вы можете выбрать **Применить** для создания документов. Когда вы применяете шаблон Word к сущности, данные из полей слияния вставляются в документ. Вы можете создать один документ, содержащий разделы для каждой сущности, или **разделить**, чтобы создать новый документ для каждой сущности.

Вы можете использовать действие **Применить шаблоны Word** для применения шаблонов к одному или нескольким объектам одного типа, например к клиенту, непосредственно в контексте страницы для этого объекта. Например, на страницах **Клиент** или **Поставщик**.

## <a name="use-word-templates-with-email"></a>Использование шаблонов Word с электронной почтой

Вы можете использовать шаблоны Word для добавления содержимого в сообщения электронной почты. Когда вы составляете электронное письмо, вы можете выбрать действие **Использовать шаблон Word** для применения содержимого шаблона в сообщении. У вас должны быть созданы шаблоны для объекта. Вы можете использовать один шаблон за раз, и когда вы переключаетесь между шаблонами, сообщение изменяется, чтобы отразить содержимое из выбранного шаблона.

Кроме того, вы можете использовать действие **Добавить файл из шаблона Word**, чтобы прикрепить содержимое шаблона к электронному письму в виде файла. Файл будет использовать формат, который вы указали для выходных данных шаблона.

:::image type="content" source="media/email-word-tmpl.PNG" alt-text="Варианты использования содержимого из шаблона Word в электронном письме":::

## <a name="edit-a-word-template"></a>Редактирование шаблона Word

Вы можете внести следующие изменения в ваши шаблоны Word:

* Чтобы отредактировать основной текст или объединить поля, включенные в шаблон, используйте действие **Скачать**, внесите изменения, а затем используйте действие **Загрузить**
* Чтобы изменить источники данных, используйте действие **Изменить связанные объекты**
* Чтобы заменить шаблон Word новым шаблоном, используйте действие **Загрузить**
* Удаление шаблона

## <a name="see-also"></a>См. также

[Управление макетами отчетов и документов](ui-manage-report-layouts.md)  
[Настройка электронной почты](admin-how-setup-email.md)  
