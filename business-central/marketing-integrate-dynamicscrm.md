---
title: Управление клиентами с помощью Dynamics 365 for Sales| Документы Майкрософт
description: Dynamics 365 for Sales можно использовать из Business Central для сопоставления данных и интеграции и синхронизации на всех этапах процесса от интереса до получения денег.
documentationcenter: ''
author: edupont04
ms.service: dynamics365-business-central
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: integration, synchronize, map, Sales
ms.date: 01/24/2019
ms.author: edupont
ms.openlocfilehash: bba9fb9a83856cea43e4f4215e7c148b713252a9
ms.sourcegitcommit: 1bcfaa99ea302e6b84b8361ca02730b135557fc1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/08/2019
ms.locfileid: "805240"
---
# <a name="integrating-with-dynamics-365-for-sales"></a>Интеграция с Dynamics 365 for Sales
Если вы используете Dynamics 365 for Sales для взаимодействия с клиентами, вы можете использовать [!INCLUDE[d365fin](includes/d365fin_md.md)] для обработки заказов и финансов, а также обеспечить плавную интеграцию с процессом продвижения от интереса до получения выручки.

> [!NOTE]
> В этом разделе предполагается, что как [!INCLUDE[d365fin](includes/d365fin_md.md)], так и интегрированное решение Sales, развернуты в среде SaaS. Смешивание интернет-версий и локальных версий возможно, но требует особенной конфигурации. Дополнительные сведения см. в разделе [Подготовка к интеграции Dynamics 365 for Sales On-Premises](/dynamics365/business-central/dev-itpro/administration/prepare-dynamics-365-for-sales-for-integration).

После настройки приложения для интеграции с Sales вы получите доступ к данным Sales из [!INCLUDE[d365fin](includes/d365fin_md.md)] и наоборот в некоторых случаях. Эта интеграция позволяет работать с типами данных, которые являются общими для обеих служб, такими как клиенты, контакты и сведения о продажах, синхронизировать эти данные и следить за их актуальностью в обеих службах.  

Например, менеджер по продажам в Sales может использовать прайс листы из [!INCLUDE[d365fin](includes/d365fin_md.md)] при создании заказа на продажу. При добавлении товара в строку заказа на продажу в Sales он также сможет просмотреть уровень запасов (доступность) товара в [!INCLUDE[d365fin](includes/d365fin_md.md)].

Обработчики заказов в [!INCLUDE[d365fin](includes/d365fin_md.md)], в свою очередь, могут обрабатывать особые характеристики заказов на продажу, передаваемые автоматически или вручную из Sales, например могут автоматически создавать и учитывать допустимые строки заказов на продажу для товаров или ресурсов, которые были внесены в Sales в качестве вписанных продуктов. Дополнительные сведения см. в разделе "Обработка особых данных в заказах на продажу".

> [!IMPORTANT]  
> [!INCLUDE[d365fin](includes/d365fin_md.md)] интегрируется только с Dynamics 365 for Sales. Другие применения или решения Dynamics 365, которые меняют стандартные процессы или модель данных в Sales, например Project Service Automation, могут нарушить интеграцию между [!INCLUDE[d365fin](includes/d365fin_md.md)] и Sales.

## <a name="standard-sales-entity-mapping-for-synchronization"></a>Сопоставление стандартных объектов Sales для синхронизации
Объекты Sales, например организации, интегрируются с аналогичными типами записей [!INCLUDE[d365fin](includes/d365fin_md.md)], например с клиентами. Для работы с данными Sales необходимо настроить сопоставления, называемые связями, между записями [!INCLUDE[d365fin](includes/d365fin_md.md)] и записями объектов Sales. Например, можно настроить связи между определенным клиентом в [!INCLUDE[d365fin](includes/d365fin_md.md)] и соответствующей организацией в Sales.

В следующей таблице перечисляются типы записей [!INCLUDE[d365fin](includes/d365fin_md.md)] (таблицы) и соответствующие объекты Sales, которые можно синхронизировать в готовом для использования виде.

|[!INCLUDE[d365fin](includes/d365fin_md.md)]|Продажи|Направление синхронизации|Фильтр по умолчанию|
|-------------------------------------------|-----|-------------------------|--------------|
|Менеджер по продажам/закупкам|Пользователь|Sales -> Business Central|Фильтр контакта Sales: **Состояние** равно **Нет**, **Пользователь лицензирован** — **Да**, режим интеграции пользователя — **Нет**|
|Клиент|Организация|Business Central -> Sales и Sales -> Business Central|Фильтр организации Sales: **Тип отношения** — **Клиент**, **Состояние** — **Активно**.|
|Контакт|Контакт|Business Central -> Sales и Sales -> Business Central|Фильтр по контактам Business Central: **Тип** — **Человек** и контакт назначен организации. Фильтр по контактам Sales: контакт назначен организации, родительский тип клиента — **Организация**.|
|Валюта|Валюта транзакции|Business Central -> Sales| |
|Единица измерения|Группа единиц|Business Central -> Sales| |
|Пункт меню|Продукт|Business Central -> Sales и Sales -> Business Central|Тип контактов Sales: **Тип продукта** — **Товарный запас**|
|Ресурс|Продукт|Business Central -> Sales и Sales -> Business Central|Тип контактов Sales: **Тип продукта** — **Услуги**|
|Ценовая группа клиента|Прайс-лист|Business Central -> Sales| |
|Цена продажи|Прайс-лист на продукцию|Business Central -> Sales|Фильтр контакта Business Central: **Код продажи** не пустой, **Тип продажи** — **Ценовая группа клиента**|
|Возможность|Возможность|Business Central -> Sales и Sales -> Business Central| |
|Заголовок счета продажи|Счет|Business Central -> Sales| |
|Строка счета продажи|Продукт счета|Business Central -> Sales| |

Синхронизируемые объекты Sales и таблицы [!INCLUDE[d365fin](includes/d365fin_md.md)] определяются объектами сопоставления таблиц в таблице 5335 **Сопоставление таблиц интеграции**. Можно просмотреть сопоставления и настроить фильтры на странице 5335 **Сопоставление таблиц интеграции**. Сопоставление между полями в записях [!INCLUDE[d365fin](includes/d365fin_md.md)] и полями в объектах Sales определяются с помощью объектов сопоставления полей в таблице 5336 **Сопоставление таблиц интеграции** и дополнительной логики сопоставления.

### <a name="field-mapping-for-the-sales-account-option"></a>Сопоставленяи полей для организаций Sales
Три таблицы [!INCLUDE[d365fin](includes/d365fin_md.md)] сопоставляются с полями параметров объекта **Организация**.   

Записи в таблице, которые не связаны с параметрами Sales, будут пропущены во время синхронизации. Это означает, что поле **Параметр** в Sales останется пустым.

В следующей таблице показаны сопоставления таблиц Business Central для поля **Параметр** в объекте **Организация**.

|Стол|Поле "Параметр" в объекте "Организация" в Sales|
|----------------------|-------------------------------------------|
|Условия оплаты|Условия оплаты|
|Метод поставки|Адрес 1: условия перевозки|
|Экспедитор|Адрес 1: метод отгрузки|

### <a name="synchronization-rules"></a>Правила синхронизации
В следующей таблице описаны правила, управляющие синхронизацией между таблицами Business Central и объектами Sales.

> [!NOTE]  
> Изменения данных в Sales, которые вносятся учетной записью подключения Sales, игнорируются. Изменения не будут синхронизированы. Таким образом, рекомендуется не вносить изменения в данные с использованием учетной записи подключения Sales.

|Стол|Правило|
|-----|----|
|Клиенты|Перед синхронизацией клиента с организацией продавец, который назначен для клиента, должен быть связан с пользователем в Sales. Поэтому когда запускается задание синхронизации "КЛИЕНТЫ — Dynamics 365 for Sales" и оно настроено на создание новых записей, убедитесь, что выполняется синхронизация продавцов с пользователями Sales, прежде чем клиенты синхронизируются с организациями Sales. <br /> <br />Задание синхронизации "КЛИЕНТЫ — Dynamics 365 for Sales" синхронизирует только организаций Sales с типом связи "Клиент".|
|Контакты|В Business Central будут созданы только контакты Sales, связанные с организацией. Значение кода менеджера по продажам определяет владельца связанного объекта в Sales.|
|Валюты|Валюты связываются с валютами транзакций в Sales на основе кодов ISO. Только валюты со стандартным кодом ISO будут связаны и синхронизированы с валютами транзакций.|
|Единицы измерения|Единицы измерения синхронизируются с группами единиц в Sales. Для группы единиц может быть задана только одна единица измерения.|
|Товаров|При синхронизации товаров с продуктами Sales, Business Central автоматически создает прайс-лист в Sales. Чтобы избежать ошибок синхронизации, не следует изменять данный прайс-лист вручную.|
|Менеджеры по продажам|Менеджеры по продажам связываются с пользователям системы в Sales. Пользователь должен быть активирован и иметь лицензию, а также не должен быть пользователем интеграции. Обратите внимание, что это первая таблица, которую нужно синхронизировать, так как она используется для клиентов, контактов, возможных сделок и счетов продажи.|
|Ресурсы|Ресурсы синхронизируются с продуктами Sales, имеющими тип "Услуга".|
|Ценовые группы клиентов|Ценовые группы клиентов синхронизируются с прайс-листами Sales.|
|Цены продажи|Цены Sales с типом продажи "Ценовая группа клиента" и определенным кодом продаж, синхронизируются со строками прайс-листов Sales.|
|Возможные сделки|Возможные сделки синхронизируются с возможными сделками Sales. Значение кода менеджера по продажам определяет владельца связанного объекта в Sales.|
|Учтенные счета продажи|Учтенные счета продажи синхронизируются со счетами продажи. Прежде чем счет можно будет синхронизировать, рекомендуется синхронизировать все остальные объекты, которые могут быть использованы в нем, от менеджеров по продажам до прайс-листов. Значение кода менеджера по продажам в заголовке счета определяет владельца связанного объекта в Sales.|

## <a name="setting-up-the-connection"></a>Настройка подключения
На домашней странице можно получить доступ к мастеру настройки **Настройка подключения к Microsoft Dynamics 365**, которое поможет настроить подключение. После этого будет установлено надежное связывание записей Sales с записями [!INCLUDE[d365fin](includes/d365fin_md.md)].  

> [!NOTE]  
>   Ниже описан мастер настройки, но можно выполнить те же задачи вручную на странице **Настройка подключения к Sales**.

В руководстве по сопровождаемой настройке можно выбрать, какие данные синхронизировать между двумя службами. Также можно указать, что требуется импортировать существующее решение Sales. В этом случае необходимо указать учетную запись администратора.

### <a name="setting-up-the-user-account-for-importing-the-solution"></a>Настройка учетной записи пользователя для импорта решения
Для импорта существующего решения Sales руководство по настройке использует учетную запись администратора. Эта учетная запись должна принадлежать действительному пользователю Sales со следующими ролями безопасности:

* Системный администратор  
* Настройщик решения  

Дополнительные сведения см. в разделах [Создание пользователей в Microsoft Dynamics 365 (online) и назначение ролей безопасности](/dynamics365/customer-engagement/admin/create-users-assign-online-security-roles) и [Управление пользователями и разрешениями](ui-how-users-permissions.md).  

Эта учетная запись используется только во время настройки. После импорта решения в [!INCLUDE[d365fin](includes/d365fin_md.md)] учетная запись больше не требуется.

### <a name="setting-up-the-user-account-for-synchronization"></a>Настройка учетной записи пользователя для синхронизации
Интеграция полагается на общую учетную запись пользователя. Поэтому в подписке Office 365 следует создать специального пользователя, который будет использоваться для синхронизации между двумя службами. Эта учетная запись уже должна быть допустимым пользователем в Sales, но не требуется назначать роли безопасности этой учетной записи, поскольку руководство по настройке сделает это за вас. Следует указать эту учетную запись пользователя один или несколько раз в руководстве по настройке в зависимости от того, какой объем синхронизации требуется включить. Дополнительные сведения см. в разделе [Создание пользователей в Microsoft Dynamics 365 (online) и назначение ролей безопасности](/dynamics365/customer-engagement/admin/create-users-assign-online-security-roles).

Если вы включаете *доступность товара*, учетная запись пользователя должна иметь ключ доступа к веб-службам. Это двухэтапный процесс на странице [!INCLUDE[d365fin](includes/d365fin_md.md)] для этой учетной записи пользователя: вы должны нажать кнопку **Изменить ключ веб-службы**, а затем в руководстве по настройке подключения к Sales указать пользователя как пользователя веб-службы OData.

Если вы включаете *интеграцию заказа на продажу*, следует указать пользователя, который может обработать эту синхронизацию — пользователя интеграции или другую учетную запись пользователя.

### <a name="coupling-records"></a>Связывание записей
В руководстве по сопровождаемой настройке можно выбрать, какие данные синхронизировать между двумя службами. Позднее можно также настроить синхронизацию определенных типов данных. Это называется *связыванием*, и в этом разделе приведены рекомендации относительно того, что следует учитывать.

Например, если необходимо просмотреть учетные записи Sales как клиентов в [!INCLUDE[d365fin](includes/d365fin_md.md)], следует связать два типа записей. Это не очень сложно: вы открываете страницу **Список клиентов** в [!INCLUDE[d365fin](includes/d365fin_md.md)], и на ленте отображается действие для связывания этих данных с Sales. После этого можно указать, какие клиенты [!INCLUDE[d365fin](includes/d365fin_md.md)] соответствуют определенным учетным записям в Sales.

В некоторых областях эта функция полагается на то, что вы свяжете определенные наборы данных до других наборов данных, как показано в следующем списке:

* Клиенты и учетные записи  
  * Связывание менеджеров по продажам со списком с пользователей Sales в первую очередь  
* Товары и ресурсы  
  * Связывание единиц измерения со списком групп единиц Sales в первую очередь  
* Товары и цены ресурсов  
  * Связывание ценовых групп клиентов с ценами Sales в первую очередь  

> [!NOTE]  
>   При использовании цен в иностранных валютах убедитесь, что вы связываете валюты с валютами транзакций Sales.

Заказы на продажу Sales зависят дополнительной информации, такой как клиенты, единицы измерения, валюты, ценовые группы клиентов, товары или ресурсы. Чтобы интеграция с заказами на продажу работала без проблем, необходимо сначала связать клиентов, единицы измерения, валюты, ценовые группы клиентов, товары или ресурсов.

### <a name="synchronizing-records-fully"></a>Синхронизация записей в полном объеме
В конце руководства по сопровождаемой настройке можно выбрать действие **Запустить полную синхронизацию**, чтобы начать синхронизацию всех записей [!INCLUDE[d365fin](includes/d365fin_md.md)] со всеми связанными записями в подключенном решении Sales. На странице **Просмотр полной синхронизации CRM** выберите действие **Начать**. Синхронизация начнется для выполнения работ согласно зависимостям. Например, записи валюты синхронизируются до записей клиентов. Полная синхронизации может занять много времени, поэтому она выполняется в фононом режиме, чтобы можно было продолжать работать в [!INCLUDE[d365fin](includes/d365fin_md.md)].

Чтобы проверить ход выполнения отдельных работ в полной синхронизации, выполните детализацию в поле **Состояние операции очереди работ**, **Состояние работы в таблицу интеграции** или **Состояние работы из таблицы интеграции** на странице **Просмотр полной синхронизации CRM**.

На странице **Настройка подключения к Microsoft Dynamics 365** можно просмотреть подробную информацию по полной синхронизации в любое время. Отсюда также можно открыть страницу **Сопоставления таблиц интеграции** для просмотра детальной информации о таблицах в [!INCLUDE[d365fin](includes/d365fin_md.md)] или в решении Sales, которые должны быть синхронизированы.

## <a name="handling-special-sales-order-data"></a>Обработка особых данных в заказах на продажу
Заказы на продажу в Sales передаются в [!INCLUDE[d365fin](includes/d365fin_md.md)] автоматически, если установлен флажок **Автоматическое создание заказов на продажу** на странице **Настройка подключения Microsoft Dynamics 365**. В таких заказах на продажу поле **Название** исходного заказа переносится и сопоставляется с полем **Номер внешнего документа** в заказе на продажу в [!INCLUDE[d365fin](includes/d365fin_md.md)].

Также это может работать, если исходный заказ на продажу содержит вписанные продукты, т. е. товары и ресурсы, которые не зарегистрированы ни в одном продукте.. В этом случае необходимо заполнить поля **Тип выписанного продукта** и **Номер вписанного продукта**. на странице **Настройка модуля "Продажи"** таким образом, чтобы незарегистрированные продажи продуктов сопоставлялись указанными номерам товаров и ресурсов для финансового анализа.

Если описание товара в исходном заказе на продажу является слишком длинным, то создается дополнительная строка заказа типа "Комментарий", чтобы в ней хранился полный текст заказа на продажу в [!INCLUDE[d365fin](includes/d365fin_md.md)].

## <a name="see-also"></a>См. также
[Подготовка к интеграции с Dynamics 365 for Sales On-Premises](/dynamics365/business-central/dev-itpro/administration/prepare-dynamics-365-for-sales-for-integration)  
[Управление отношениями](marketing-relationship-management.md)  
[Работа с [!INCLUDE[d365fin](includes/d365fin_md.md)]](ui-work-product.md)  
[Изменение набора отображаемых функций](ui-experiences.md)  
[Управление пользователями и разрешениями](ui-how-users-permissions.md)    
[Адаптация организации и пользователей к Dynamics 365 (сетевая версия)](/dynamics365/customer-engagement/admin/onboard-your-organization-and-users-to-dynamics-365-online)  

## [!INCLUDE[d365fin](includes/free_trial_md.md)]  
