---
title: Расчет сроков планирования заказов
description: 'Функция расчета сроков позволяет рассчитать ближайшую дату, в которую товарная позиция будет доступна для отгрузки или доставки.'
author: edupont04
ms.topic: conceptual
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: null
ms.date: 06/29/2021
ms.author: edupont
---
# <a name="calculate-order-promising-dates"></a>Расчет сроков планирования заказов

Организация должна иметь возможность информировать клиентов о датах доставки заказов. С помощью страницы **Строки планирования заказов** это можно сделать из заказа на продажу.  

[!INCLUDE[prod_short](includes/prod_short.md)] вычисляет даты отгрузки и доставки на основе известных и ожидаемых дат доступности, которые затем могут быть обещаны клиентам.  

Если в строке заказа продажи задана требуемая дата отгрузки, эта дата будет использована в качестве отправной точки для следующих расчетов:  

- требуемая дата доставки - время отгрузки = плановая дата поставки  
- плановая дата поставки - исходящие - время обработки склада = дата поставки  

Если на дату отгрузки товар имеется в наличии, процесс продажи может быть продолжен. Если на дату отгрузки товар отсутствует, отображается предупреждение контроля склада.  

Если не указать требуемую дату доставки в строке заказа продажи, либо если соблюсти требуемая дата доставки невозможно, вычисляется самая ранняя дата, на которую доступны товары. Затем эта дата вводится в поле **Дата отгрузки** в строке, и дата, в которую планируется отгрузки товаров, а также дата, в которую они будут доставлены клиенту, рассчитываются по следующим формулам:  

- дата отгрузки + исходящие - время обработки склада = плановая дата отгрузки  
- плановая дата поставки + время отгрузки = плановая дата доставки  

## <a name="about-order-promising"></a>О планировании заказов

Функция планирования заказов позволяет дать обещание отгрузить или доставить заказ в конкретный день. Рассчитывается дата, когда товар будет свободен для обещания или возможен для обещания, и создаются строки заказа для утвержденных дат. Функция рассчитывает ближайшую дату, в которую товарная позиция будет доступна для отгрузки или доставки. Она также создает строки заявок, в случае если товары необходимо сначала купить или произвести, ,для тех дат, которые вы принимаете.

[!INCLUDE[prod_short](includes/prod_short.md)] использует две основные концепции:  

- Доступно для распределения (ATP)  
- В наличии (CTP)  

### <a name="available-to-promise"></a>Доступно для распределения

"Доступно для распределения (ATP)" рассчитывает даты на основе системы резервирования. Он выполняет проверку наличия незарезервированных количеств в складских запасах с учетом запланированного производства, покупок, перемещений и возвратов продаж. На основе этой информации [!INCLUDE[prod_short](includes/prod_short.md)] вычисляет дату доставки заказа клиента, поскольку товары доступны, будь то в виде запасов или плановых поступлений.  

### <a name="capable-to-promise"></a>В наличии

"В наличии" (CTP) предполагает сценарий "что если", который применяется только к количествам товаров, которые не в запасах или не в запланированных заказах. На основе этого сценария [!INCLUDE[prod_short](includes/prod_short.md)] рассчитывает наиболее раннюю дату, когда товар может быть доступен, если он должен быть изготовлен, закуплен или перемещен.

#### <a name="example"></a>Пример

Если имеется заказ на 10 штук и 6 штук доступны в запасах или в запланированных заказах, расчет "В наличии" будет основан на 4 штуках.

### <a name="calculations"></a>Расчеты

Когда [!INCLUDE[prod_short](includes/prod_short.md)] вычисляет дату доставки клиента, выполняются две задачи:  

- Вычисляет наиболее раннюю дату доставки, когда клиент не запрашивал конкретную дату доставки.  
- Проверяет, запрашивал ли клиент дату доставки и можно ли уложиться в обещанные клиенту сроки.  

Если клиент не запрашивает конкретную дату доставки, дата отгрузки приравнивается к рабочей дате, и складское наличие основывается на этой дате. Если товар на складе, [!INCLUDE[prod_short](includes/prod_short.md)] вычисляет время доставки заказа. Это выполняется следующими формулами:  

- Дата поставки + Время обработка исходящего склада = Плановая дата поставки  
- Плановая дата поставки + Время отгрузки = Плановая дата доставки  

[!INCLUDE[prod_short](includes/prod_short.md)] затем проверяет реалистичность вычисленной даты доставки путем обратного вычисления во времени, чтобы определить, когда товар должен быть в наличии для соблюдения обещанной даты. Это выполняется следующими формулами:  

- Плановая дата доставки - Время отгрузки = Плановая дата поставки  
- Плановая дата поставки - Исходящие - обработка склада = Дата поставки  

Дата отгрузки используется для выполнения проверки наличия. Если товар доступен на эту дату, [!INCLUDE[prod_short](includes/prod_short.md)] подтверждает, что запрошенная/обещанная доставка может осуществиться путем установки даты плановой доставки на дату запрошенной/обещанной доставки. Если товар отсутствует, то возвращается пустая дата, и обработчик заказов может затем использовать функцию CTP.  

На основе новых значений даты и времени рассчитываются все связанные даты согласно формулам, указанным ранее в этом разделе. Расчет CTP выполняется дольше, но он дает точные данные, когда клиенту требуется доставка товара. Даты, вычисляемые на основе CTP, представлены в полях **Плановая дата доставки** и **Самая ранняя дата отгрузки** на странице **Строки планирования заказов**.  

Обработчик заказов завершает процесс CTP путем принятия дат. Это означает, что строка планирования и операция резервирования создаются для товара до расчетных дат для обеспечения выполнения заказа.  

В добавление к внешнему заказу, который можно выполнить на странице **Строки планирования заказов**, можно также определить даты внутренней или внешней доставки для товаров по спецификации. Дополнительные сведения см. в разделе [Просмотр наличия товаров](inventory-how-availability-overview.md).

## <a name="to-set-up-order-promising"></a>Настройка планирования заказов

1. Выберите ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **Настройка планирования заказов**, а затем выберите связанную ссылку.  
2. Введите число и код единицы времени в поле **Смещение (время)**. Выберите один из следующих кодов.  

    |Код|Описание|  
    |----------|-----------------|  
    |**д**|Календарный день|  
    |**w**|Неделя|  
    |**м**|Месяц|  
    |**к**|Квартал|  
    |**г**|Год|  

    Например, «3н» указывает на то, что время смещения составляет три недели. Для обозначения текущего периода используйте префикс "т" с любым из этих кодов. Например, если для времени смещения следует указать текущий месяц, введите **тм**.  
3. Введите серию номеров в поле **Серия номеров планирования заказов**, выбрав строку из списка на странице **Серии номеров**.  
4. Введите шаблон расчета сроков в поле **Шаблон планирования заказов**, выбрав строку из списка на странице **Шаблоны журналов заявок - список**.  
5. Укажите журнал заявок в поле **Журнал планирования заказов**, выбрав строку из списка на странице **Названия журналов заявок**.

### <a name="inbound-and-outbound-warehouse-handling-times-in-order-promising"></a>Время обработки входящего и исходящего складского заказа при обещании заказа

Если требуется учитывать в расчетах входящее время обработки склада при планирования заказов в строке покупки, на странице **Настройка модуля "Запасы"** можно задать время обработки по умолчанию для использования в документах продажи и покупки. Вы также можете ввести определенное время для каждого из ваших местоположений на странице **Карточка склада**. 

#### <a name="to-enter-default-inbound-and-outbound-warehouse-handling-times-for-sales-and-purchase-documents"></a>Ввод времени обработки входящих и исходящих складских документов по умолчанию для документов покупки и продажи

1. Выберите ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **Настройка запасов**, а затем выберите связанную ссылку.  
2. На экспресс-вкладке **Общее** в полях **Входящие — время обработки склада** и **Исходящие — время обработки склада** введите количество дней, которые необходимо учитывать в расчетах при планировании заказов.  

#### <a name="to-enter-inbound-and-outbound-warehouse-handling-times-on-locations"></a>Ввод времени обработки на складе входящих и исходящих товаров на складах

1. Выберите ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") значок введите **Склад**, а затем выберите связанную ссылку.  
2.  Откройте соответствующую карточку склада.  
3.  На экспресс-вкладке **Склад** в полях **Входящие — время обработки склада** и **Исходящие — время обработки склада** введите количество дней, которые необходимо учитывать в расчетах при планировании заказов.  

> [!NOTE]  
>  При создании заказа на покупку, если вы выберете **Склад** в поле **Получатель** на экспресс-вкладке **Отгрузка и оплата**, а затем выберите склад в поле **Код склада**, поля **Исходящие — время обработки склада** и **Входящие — время обработки склада** будут использовать время обработки, указанное для склада. Для заказов на продажу то же самое верно, если вы выберете местоположение в поле **Код склада**. Если для данного склада время обработки не указано, поля **Исходящие — время обработки склада** и **Входящие — время обработки склада** будут пустыми. Если вы оставите поле **Код склада** пустым в документах купли и продажи, при расчете используется время обработки, указанное на странице **Настройка запасов**.

## <a name="to-make-an-item-critical"></a>Создание критического товара

Чтобы товар можно было включить в расчет планирования заказа, его необходимо отметить как критически важный. Эта настройка гарантирует, что некритические товары не вызывают неуместные расчеты планирования заказов.   
1.  Выберите ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") значок введите **Товары**, а затем выберите связанную ссылку.  
2.  Откройте соответствующую карточку товара.  
3.  На экспресс-вкладке **Планирование** выберите поле **Критический**.  

## <a name="to-calculate-an-order-promising-date"></a>Расчет сроков планирования заказов

1.  Выберите ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") значок введите **Заказ на продажу**, а затем выберите связанную ссылку.  
2.  Откройте соответствующий заказ на продажу и выберите строки заказа на продажу, которые должно рассчитать приложение.  
3.  Выберите действие **Планирование заказов**, затем выберите действие **Строки планирования заказов**.  
4.  Выберите строку, затем выберите один из следующих вариантов:  

    - Если требуется рассчитать ближайшую дату, когда товар будет доступен по складу, запланированному поступлению и суммарной потребности, выберите **Доступно для распределения**.  
    - Если известно, что в настоящее время товар отсутствует на складе и требуется рассчитать ближайшую дату, когда товар будет доступен путем подачи новых заявок на пополнение запасов, выберите **В наличии**.  
5.  Нажмите кнопку **Принять**, чтобы принять ближайшую доступную дату отгрузки.  

## <a name="see-related-microsoft-training"></a>См. соответствующее [обучение Microsoft](/training/modules/promising-sales-order-delivery-dynamics-365-business-central/)

## <a name="see-also"></a>См. также

[Продажи](sales-manage-sales.md)  
[Расчет даты для покупок](purchasing-date-calculation-for-purchases.md)  
[Работа с [!INCLUDE[prod_short](includes/prod_short.md)]](ui-work-product.md)


[!INCLUDE[footer-include](includes/footer-banner.md)]
