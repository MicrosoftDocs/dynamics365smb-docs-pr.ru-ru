---
title: 'Сведения о проектировании: резервирование, трассировка заказов и отправка сообщений о действиях | Документация Майкрософт'
description: Система резервирования является комплексной и включает взаимосвязанные и параллельные функции трассировки заказов и указаний.
author: SorenGP
ms.service: dynamics365-business-central
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: design, replenishment, reordering
ms.date: 10/01/2020
ms.author: edupont
ms.openlocfilehash: 99c7410e31291213486d8843ba125359615c1477
ms.sourcegitcommit: ddbb5cede750df1baba4b3eab8fbed6744b5b9d6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2020
ms.locfileid: "3911059"
---
# <a name="design-details-reservation-order-tracking-and-action-messaging"></a>Сведения о проектировании: резервирование, трассировка заказов и отправка сообщений о действиях
Система резервирования является комплексной и включает взаимосвязанные и параллельные функции трассировки заказов и указаний.  

 В основе системы резервирования лежит связь операции спроса и соответствующей операции поставки, осуществляемая через резервирование или трассировку заказов. Резервирование — это создаваемая пользователем связь, а запись трассировки заказа — это создаваемая системой связь. Количество товара, введенное в систему резервирования, является зарезервированным товаром или товаром, для которого включена трассировка заказа, но не может принадлежать обоим типам одновременно. Способ обработки товара в системе зависит от настройки товара.  

 Система резервирования взаимодействует с системой планирования, создавая указания в строках планирования во время прогонов планирования. Сообщение о действии можно рассматривать как приложение к записи трассировки заказа. Сообщения о действиях, созданные динамически для трассировки заказов или во время выполнения планирования, предоставляют удобное средство для эффективного планирования поставок.  

> [!NOTE]  
>  Система планирования игнорирует зарезервированные количества, то есть жесткую связь между поставкой и спросом невозможно изменить с помощью планирования.  

 Система резервирования также формирует структурную основу системы трассировки заказов. Дополнительные сведения см. в разделе [Сведения о проектировании: трассировка товара](design-details-item-tracking.md).  

 Дополнительные сведения о работе системы резервирования см. в техническом документе «Таблица "Операция резервирования"» на веб-странице [PartnerSource](https://go.microsoft.com/fwlink/?LinkId=258348).  

## <a name="reservation"></a>Резервирование  
 Резервирование — это надежная связь, которая объединяет определенную поставку с определенным предложением. Эта ссылка непосредственно влияет на последующую складскую транзакцию и обеспечивает правильное применение операций с товарами для целей учета затрат. Резервирование переопределяет метод учета себестоимости товара по умолчанию. Дополнительные сведения см. в разделе "Сведения о проектировании: методы учета себестоимости".  

 Страницу **Резервирование** можно открыть из всех строк заказа типа спрос и предложение. На этой странице пользователь может определить операцию спроса или поставки, для которой требуется создать связь. Резервирование состоит из пары записей с одним и тем же номером операции. Одна запись имеет отрицательный знак и указывает на спрос. Другая запись имеет положительный знак и десятые доли в поставку. Эти записи сохраняются в таблице **Операция резервирования** со значением статуса **Резервирование**. Пользователь может просматривать все резервирования на странице **Операции резервирования**.  

### <a name="offsetting-in-reservations"></a>Смещение в резервированиях  
 Резервирования выполняются на основании доступных количеств товаров. Наличие товара рассчитывается согласно основным условиям следующим образом:  

 доступное количество = запасы + запланированные поступления - полные потребности  

 В следующей таблице показаны подробные сведения об операциях сети заказов, являющихся частью расчета доступности.  

||Поле в T27|Исходная таблица|Фильтр таблицы|Поля источника|  
|-|------------------|------------------|------------------|------------------|  
|**Наличие**|Запасы|Товары - книга операций|Н/Д|Количество|  
|**Запланир. поступления**|Поступление по утв. заказам (баз. кол-во)|Строка произв. заказа|=Утвержденный|Остаток (баз.)|  
|**Запланир. поступления**|Поступл. по запущ. заказу (кол-во)|Строка произв. заказа|=Выпущено|Остаток (баз.)|  
|**Запланир. поступления**|Кол-во в заказе на сборку|Заголовок сборки|=Заказ|Остаток (баз.)|  
|**Запланир. поступления**|Кол-во в заказах на покупку|Строка покупки|=Заказ|Недопоставл. кол-во (баз.)|  
|**Запланир. поступления**|Остат. кол-во для получ. по заказу на перемещ.|Строка перемещения|Н/Д|Недопоставленное кол-во|  
|**Полная потребность**|Кол-во в заказах на продажу|Строка продажи|=Заказ|Недопоставл. кол-во (баз.)|  
|**Полная потребность**|Плановая потребность (кол-во)|Компонент произв. заказа|<>Смоделировано|Остаток (баз.)|  
|**Полная потребность**|Количество в компоненте сборки|Строка сборки|=Заказ|Остаток (баз.)|  
|**Полная потребность**|Остат. кол-во для отгрузки по заказу на перемещ.|Строка перемещения|Н/Д|Недопоставленное кол-во|  

 Дополнительные сведения см. в разделе [Сведения о проектировании: наличие на складе](design-details-availability-in-the-warehouse.md).  

### <a name="manual-reservation"></a>Резервирование вручную  
 Если пользователь намеренно создает резервирование, он полностью владеет им и на нем лежит ответственность за соответствующие товары. Это означает, что пользователь также должен вручную изменить или отменить резервирование. Такие внесенные вручную изменения могут вызвать автоматические изменения задействованных резервирований.  

 В следующей таблице показано возможное время внесения изменений и сами возможные изменения.  

|Действие пользователя|Отклик системы|  
|-----------------|---------------------|  
|Уменьшение зарезервированного количества|Связанные поля количества обновятся.|  
|Изменение полей даты|Связанные поля даты обновятся.<br /><br /> **Примечание.** Если срок оплаты спроса меняется на дату, предшествующую дате отгрузки или сроку оплаты поставки, резервирование будет отменено.|  
|Удаление заказа|Резервирование отменяется.|  
|Изменение склада, ячейки, варианта, серийного номера или номера партии|Резервирование отменяется.|  

> [!NOTE]  
>  Функция поздней привязки также может изменить резервирования без уведомления пользователя, сменив неконкретные резервирования серийных номеров или номеров партии. Дополнительные сведения см. в разделе "Сведения о проектировании: трассировка и резервирование товара".  

### <a name="automatic-reservations"></a>Автоматические резервирования  
 Карточку товара можно настроить таким образом, чтобы всегда автоматически выполнять резервирование из спроса, например заказов на продажу. В этом случае резервирование выполняется в соответствии с запасом, заказами на покупку, заказами на сборку и производственными заказами. Если поставка недостаточная, выдается предупреждение.  

 Кроме того, товары автоматически резервируются с помощью различных функций планирования для поддержки связи спроса с определенной поставкой. Операции трассировки заказов для таких ссылок планирования содержат **Резервирование** в поле **Статус резервирования** таблицы **Операция резервирования**. Автоматические резервирования создаются в следующих ситуациях:  

-   Для многоуровневого производственного заказа в поле **Политика производства** соответствующего родительского и дочерних элементов задается значение **Изготовление на заказ**. Система планирования создает резервирования между родительским производственным заказом и относящимися к нему производственными заказами, чтобы обеспечить их совместную обработку. Такая привязка резервирования переопределяет себестоимость по умолчанию и метод применения товара.  

-   Производственный заказ, заказ на сборку или заказ на покупку, в котором для поля **Политика дозаказа** соответствующего товара задано значение **Заказ**. Система планирования создает резервирования между требованием и плановой поставкой, чтобы обеспечить создание конкретной поставки. Дополнительные сведения см. в разделе [Заказ](design-details-handling-reordering-policies.md#order).  

-   Производственный заказ, созданный из заказа на продажу с помощью функции **Планирование заказа на продажу**, связан с заказом на продажу путем автоматического резервирования.  

-   Заказ на сборку, созданный автоматически для строки заказа на продажу для обеспечения количества в поле **($ T_37_900 Qty. to Assemble to Order $)**. Автоматическое резервирование связывает спрос по продажам и поставку сборки так, чтобы обработчики заказов на продажу могли выполнить настройку и напрямую пообещать клиенту сборочный элемент. Кроме того, при резервировании выход при сборке связывается со строкой заказа на продажу с помощью операции отгрузки, которая выполняет заказ клиента.  

 При наличии нераспределенной поставки или спроса система планирования автоматически присваивается статус резервирования типа **Излишек**. Это может стать результатам спроса, обусловленного прогнозируемым количеством или введенными пользователем параметрами планирования. Это юридический излишек, признаваемый системой, поэтому указания не возникают. Излишек также может быть настоящей излишней поставкой или спросом, который остается нетрассированным. Это признак дисбаланса в сети заказов, который заставляет систему создавать указания. Обратите внимание, что сообщение о действии, предлагающее изменение в количестве, всегда имеет тип **Излишек**. Дополнительные сведения см. в разделе "Пример. Трассировка заказов в продажах, производстве и перемещениях" этой статьи.  

 Автоматические резервирования создаются в процессе планирования и обрабатываются следующими способами:  

-   Они применяются к количествам товаров, которые являются частью расчета доступности, как и резервирования вручную. Дополнительные сведения см. в разделе "Смещение в резервированиях" этой статьи.  

-   Они включены и могут быть потенциально изменены в последующих прогонах планирования, в отличие от зарезервированных вручную товаров.  

## <a name="order-tracking"></a>Трассировка заказов  
 Функция трассировки заказов помогает планировщику поддерживать допустимый план поставки, предоставляя обзор смещений между спросом и поставкой в сети заказов. Записи трассировки заказов служат основой для создания динамических указаний и предложений строк планирования в процессе планирования.  

> [!NOTE]  
>  Система трассировки заказов смещает доступные запасы по мере попадания заказов в сеть заказов. Данное подразумевает, что система не определяет приоритетность заказов, которые могут являться более срочными с точки зрения срока оплаты. Следовательно изменение приоритетов соответствующим образом зависит от логики системы планирования или здравого смысла планировщика.  

> [!NOTE]  
>  Политика трассировки заказов и функция получения указаний не интегрированы с работами. Это означает, что спрос, связанный с работой, не отслеживается автоматически. Поскольку он не отслеживается, это может привести к тому, что существующее пополнение со сведениями о работе будет отслеживаться для другого спроса, например заказа на продажу. Следовательно, может возникнуть ситуация, в которой ваша информации о доступных запасах не будет синхронизирована.  

### <a name="the-order-network"></a>Сеть заказов  
 Система трассировки заказов основана на принципе, что сеть заказов должна всегда находиться в равновесии, в котором каждый попадающий в систему спрос уравновешивается соответствующим предложением и так далее. Система обеспечивает это идентификацией логических связей между всеми операциями спроса и предложения в сети заказов.  

 Этот принцип подразумевает, что изменение спроса приводит к соответствующему дисбалансу на стороне поставки в сети заказов. И наоборот, изменение в поставке приводит к соответствующему дисбалансу на стороне спроса в сети заказов. Фактически сеть заказов находится в состояния постоянного изменения, поскольку пользователи вводят, изменяют и удаляют заказы. Функция трассировки заказов обрабатывает заказы динамически, реагируя на каждое изменение, которое вводится в систему и становится частью сети заказов. Сразу после создания новых записей трассировки заказов сеть заказов балансируется, но только до внесения последующих изменений.  

 С целью повышения прозрачности вычислений в системе планирования на странице **Отмена трассировки элементов планирования** отображаются неотслеживаемые суммы, представляющие разницу в количестве между известным спросом и предложенной поставкой. Каждая строка на данной странице относится к причине избыточного количества, например **Общий заказ**, **Уровень страхового запаса**, **Фикс. кол-во дозаказа**, **Минимальное кол-во заказа**, **Округление** или **Демпфер**.  

### <a name="offsetting-in-order-tracking"></a>Смещение в трассировке заказов  
 В противоположность резервированиям, которые можно выполнить с доступными количествами товаров, трассировку заказов можно выполнить для всех объектов сети заказов, которые являются частью расчета чистых потребностей в системе планирования. Чистые требования вычисляются следующим образом.  

 чистые потребности = общие потребности + точка дозаказа - запланированные поступления - плановые поступления - прогнозное доступное сальдо  

> [!NOTE]  
>  Трассировка заказа не включена для спроса, связанного с прогнозами или параметрами планирования.  

### <a name="example-order-tracking-in-sales-production-and-transfers"></a>Пример. Трассировка заказов в продажах, производстве и перемещениях  
 В следующем сценарии отображаются создание операций трассировки заказа в таблице **Операция резервирования** в результате различных сетевых изменений заказа.  

 Допустим, имеются следующие данные по двум товарам, настроенным для трассировки заказов.  

|Товар 1|Name|“Компонент”|
|-|-|-|
||Наличие|100 единиц на складе КРАСНЫЙ<br /><br />- 30 единиц ПАРТИИ A<br />- 70 единиц ПАРТИИ В|  
|Товар 2|Name|“Произведенный товар”|
||Производственная спецификация|Кол-во 1 на "Компонент"|  
||Спрос|Продажа 100 единиц на складе СИНИЙ|  
||Поставка|Запущенный производственный заказ (созданный с помощью функции **Планирование заказа на продажу** для продажи 100 единиц)|  

На странице **Настройка модуля Производство** в поле **Компоненты по складам** установлено значение **КРАСНЫЙ**.

 Следующие операции отслеживания заказов существуют в таблице **Операция резервирования** на основании данных из таблицы.  

 ![Записи отслеживания заказа в таблице "Операция резервирования"](media/supply_planning_RTAM_1.png "supply_planning_RTAM_1")  

### <a name="entry-numbers-8-and-9"></a>Номера операций 8 и 9  
 Для удовлетворения потребности в компоненте в ПАРТИИ А и ПАРТИИ В соответственно создаются связи трассировки заказа, ведущие от спроса в таблице 5407 **Компонент произв. заказа** к поставке в таблице 32 **Операция книги товаров**. Поле **Статус резервирования** содержит значение **Отслеживание**, чтобы обозначить, что эти операции являются динамическими ссылками трассировки заказов между спросом и предложением.  

> [!NOTE]  
>  Поле **Номер партии** пусто в строках требования, так как номера партий не определены в строках компонентов запущенного производственного заказа.  

### <a name="entry-numbers-10"></a>Номер операции 10  
 Из спроса по продажам в таблице 37 **Строка продажи** создается связь трассировки заказа, ведущая к поставке в таблице 5406 **Строка произв. заказа**. Поле **Статус резервирования** содержит значение **Резервирование**, поле **Связывания** содержит значение **Заказ-в-заказ**. Это происходит из-за того, что выпущенный производственный заказ был создан специально для заказа на продажу и должен оставаться связанным с ним, в отличие от ссылок трассировки со статусом резервирования **Отслеживание**, которые создаются и изменяются динамически. Дополнительные сведения см. в разделе "Автоматические резервирования" этой статьи.  

 На данном этапе сценария в 100 единиц ПАРТИИ А и ПАРТИИ В перемещаются на склад СИНИЙ в заказе на перемещение.  

> [!NOTE]  
>  На этом этапе учитывается только отгрузка заказа на перемещение, а не приемка.  

 Теперь следующие операции отслеживания заказов существуют в таблице **Операция резервирования**.  

 ![Записи отслеживания заказа в таблице "Операция резервирования"](media/supply_planning_RTAM_2.png "supply_planning_RTAM_2")  

### <a name="entry-numbers-8-and-9"></a>Номера операций 8 и 9  
 Статус операций трассировки заказов для двух партий компонентов, отражающих спрос в таблице 5407, меняется с **Трассировка** на **Излишек**. Причина в том, что поставки, с которыми они были связаны ранее, в таблице 32, были использованы отгрузкой заказа на перемещение.  

 Настоящий излишек, как в этом случае, отражает излишнюю поставку или спрос, который остается нетрассированным. Это признак дисбаланса в сети заказов, в результате которого система планирования создаст сообщение о действии, если не устранить проблему динамически.  

### <a name="entry-numbers-12-to-16"></a>Номера операций с 12 по 16  
 Поскольку две партии компонента учтены в заказе на перемещение как отгруженные, но не полученные, все связанные положительные операции трассировки заказа имеют тип резервирования **Излишек**, указывая, что они не распределены никакому спросу. Для каждого номера партии одна операция связана с таблицей 5741 **Строка перемещения**, а одна операция связана с операцией книги товаров на транзитном складе, на котором теперь существуют товары.  

 На данном этапе сценария заказ на перемещение компонентов с СИНЕГО склада на КРАСНЫЙ учитывается как полученный.  

 Теперь следующие операции отслеживания заказов существуют в таблице **Операция резервирования**.  

 ![Записи отслеживания заказа в таблице "Операция резервирования"](media/supply_planning_RTAM_3.png "supply_planning_RTAM_3")  

 Операции трассировки заказов теперь аналогичны первому пункту сценария, до учета заказа на перемещение как только отгруженный, за исключением того что операции с компонентом теперь имеют статус резервирования **Излишек**. Это вызвано тем, что потребность в компонентах все еще на КРАСНОМ складе, что соответствует тому, что поле **Код склада** строки компонентов производственного заказа содержит значение **КРАСНЫЙ**, как настроено в поле настройки **Компоненты по складам**. Поставка, выделенная этому спросу, была перенесена на СИНИЙ склад и теперь не может быть полностью отслежена, если только потребность в компонентах в строке производственного заказа будет изменена на СИНИЙ склад.  

 На данном этапе сценария в поле **Код склада** в строке производственного заказа задано значение **СИНИЙ**. Кроме того, на странице **Строки трассировки товаров** 30 единиц ПАРТИИ А и 70 единиц ПАРТИИ В назначаются строке производственного заказа.  

 Теперь следующие операции отслеживания заказов существуют в таблице **Операция резервирования**.  

 ![Записи отслеживания заказа в таблице "Операция резервирования"](media/supply_planning_RTAM_4.png "supply_planning_RTAM_4")  

### <a name="entry-numbers-21-and-22"></a>Номера операций 21 и 22  
 Поскольку потребность в компоненте на складе СИНИЙ изменилась и поставка доступна как операция книги товаров на складе СИНИЙ, все операции трассировки заказов для двух номеров партий теперь полностью отслеживаются, что указывается статусом резервирования **Трассировка**.  

 Теперь поле **Номер партии** заполнено в операции трассировки заказа для таблицы 5407, поскольку номера партий были назначены строкам компонентов производственного заказа.  

 Дополнительные примеры операций трассировки заказов в таблице **Операция резервирования** см. в техническом документе «Таблица "Операция резервирования"» на веб-странице [PartnerSource](https://go.microsoft.com/fwlink/?LinkId=258348) (требуется вход).

## <a name="action-messaging"></a>Отправка сообщений о действиях  
 Если система отслеживания заказов обнаружит дисбаланс в сети заказов, она автоматически создает указание, чтобы уведомить пользователя. Сообщения о действиях —это создаваемые системой запросы на действие пользователя, включающие сведения о дисбалансе и предложения по восстановлению баланса в сети заказов. Они отображаются как строки планирования на странице **Журнал планирования** при выборе команды **Получение указаний**. Кроме того, сообщения о действиях отображаются в строках планирования, созданных при выполнении планирования для отражения предложений системы планирования по восстановлению баланса в сети заказов. В обоих случаях предложения выполняются в сети заказов при выборе команды **Выполнить указание**.  

 Сообщение о действии относится к одному уровню спецификации за раз. Если пользователь принимает сообщение о действии, это может привести к появлению дополнительных сообщений о действиях на следующем уровне спецификации.  

 Во следующей таблице показаны существующие указания.  

|Указание|Описание|  
|--------------------|---------------------------------------|  
|**Изменить кол-во**|Изменение количества в существующем заказе на поставку для удовлетворения измененного или нового спроса.|  
|**Перепланирование**|Перепланирование срока оплаты в существующем заказе.|  
|**Переплан. и изм. кол-во**|Перепланирование срока оплаты и изменение количества в существующем заказе.|  
|**Новое**|Создание нового заказа, если спрос невозможно удовлетворить, с помощью любого из предыдущих сообщений о действиях.|  
|**Отмена**|Отмена существующего заказа.|  

 Система трассировки заказов всегда пытается разрешить неравновесие в существующей сети заказов. Если это невозможно, отображается сообщение о действии для создания нового заказа. Ниже представлен список с указанием приоритета, который система трассировки использует при определении способа восстановления баланса. Если в систему заказов введен дополнительный спрос, система пытается выполнить трассировку заказов с помощью следующих проверок:  

1.  Проверка любого излишка в существующей записи трассировки заказов для этого спроса.  
2.  Проверка плановых и запланированных поступлений в порядке даты приемки. Выбирается последняя возможная дата.  
3.  Проверка доступных запасов.  
4.  Проверка того, существует ли заказ на поставку в текущей записи трассировки заказа. Если это так, система создает сообщение о действии типа **Изменить**, чтобы увеличить заказ.  
5.  Проверка того, что не существует заказа на поставку в текущей записи трассировки заказа. Если это так, система создает сообщение о действии типа **Создать**, чтобы создать новый заказ.  

 Неудовлетворенный спрос проходит через список и погашает доступную поставку в каждой точке. Любой оставшийся спрос всегда удовлетворяется при проверке 4 или 5.  

 При уменьшении объема спроса система трассировки заказов пытается устранить дисбаланс путем выполнения предыдущих проверок в обратном порядке. Это означает, что существующие указания можно изменить или даже удалить в случае необходимости. Система трассировки заказов всегда представляет чистые результаты вычислений пользователю.  

## <a name="order-tracking-and-planning"></a>Трассировка и планирование заказа  
 При запуске системы планирования удаляются все существующие операции трассировки заказов и операции указаний. Система воссоздает их как предложения строк планирования в соответствии с парами спрос-предложение и приоритетами. Если цикл планирования завершился, сеть заказов находится в равновесии.  

### <a name="planning-system-versus-order-tracking-and-action-messaging"></a>Система планирования, трассировка заказов и отправка сообщений о действиях  
 В следующем сравнении показаны различия между методами, используемыми системой планирования для создания предложений строк планирования, и методами, используемыми системой отслеживания заказов для создания записей отслеживания заказов и указаний.  

-   Система планирования обрабатывает всю схему спроса и предложения для конкретного товара, в то время как трассировка заказов обрабатывает только заказ, который ее активировал.  

-   Система планирования работает со всеми уровнями иерархии спецификации, в то время как трассировка заказов может работать только с одним уровнем спецификации за раз.  

-   Система планирования устанавливает связи между спросом и предложением в соответствии с приоритетной датой оплаты. При трассировке заказов создаются связи между спросом и поставкой в соответствии с порядком ввода заказов.  

-   Система планирования учитывает параметры планирования, в то время как трассировка заказов — нет.  

-   Система планирования создает ссылки в пакетном режиме, активируемом пользователем, уравновешивая спрос и предложение, в то время как система отслеживания заказов создает ссылки автоматически и динамически по мере ввода заказов пользователем.  

## <a name="see-also"></a>См. также  
[Сведения о проектировании: основные понятия системы планирования](design-details-central-concepts-of-the-planning-system.md)   
[Сведения о проектировании: планирование поставок](design-details-supply-planning.md)
