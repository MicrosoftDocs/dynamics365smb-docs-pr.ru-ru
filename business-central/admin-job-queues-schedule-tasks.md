---
title: Планирование автоматического выполнения работ
description: Запланированные задания обрабатываются очередью работ. Эти работы выполняют отчеты и модули Codeunit. В настройках можно указать однократное или периодически повторяющееся выполнение работы.
author: edupont04
ms.topic: conceptual
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.form: '672, 673, 674, 671'
ms.date: 10/01/2021
ms.author: edupont
---
# Использование очередей работ для планирования задач

Страница "Операции очереди работ" позволяет пользователям планировать и запускать определенные отчеты, а также модули codeunit. В настройках можно указать однократное или периодически повторяющееся выполнение работы. Например, вы можете запускать отчет **Статистика продаж * менеджера** еженедельно, чтобы отслеживать продажи по продавцам каждую неделю, или вы можете запускать модуль codeunit **Делегировать запросы на утверждение** ежедневно, чтобы предотвратить накопление документов.

На странице **Операции очереди работ** перечисляются все существующие работы. Если вы добавляете новую запись очереди заданий, которую нужно запланировать, вы должны предоставить некоторую информацию. Например.

* Тип объекта, который вы хотите запустить, например отчет или codeunit. У вас должно быть разрешение на запуск определенного отчета или codeunit.
* Имя и ИД объекта. 
* Параметры для определения поведения записи очереди заданий. Например, можно добавить параметр, чтобы только отправить учтенные заказы на продажу. 
* Когда и как часто будет запускаться запись очереди заданий.

> [!IMPORTANT]  
> Если вам назначен набор разрешений SUPER, который входит в комплект [!INCLUDE[prod_short](includes/prod_short.md)], у вас есть разрешение на запуск всех объектов, входящих в вашу лицензию. Если у вас роль делегированного администратора, вы можете создавать и планировать операции очереди работ, но запускать их могут только администраторы и лицензированные пользователи. Пользователи с лицензией на устройство не могут ни создавать, ни запускать операции очереди работ.

После того как очереди заданий настроены и работают, статус может изменяться в пределах каждого повторяющегося периода, как указано ниже:

* **На удержании**  
* **Готово**  
* **В работе**  
* **Ошибка**  
* **Завершен**  

После успешного выполнения задания оно будет удалено из очереди, если только это задание не является повторяющимся. Если это повторяющееся задание, в поле **Самая ранняя дата/время начала** будет показано, когда ожидается следующий запуск задания.  

## Отслеживание состояния или ошибок в очереди заданий

Данные, произведенные при выполнении очереди заданий, хранятся в базе данных, чтобы можно было устранить ошибки очереди работ.  

Для каждой записи очереди заданий вы можете просмотреть и изменить статус. При создании записи очереди работ она будет иметь статус **На удержании**. Можно установить состояние **Готово** и затем вернуть, например, состояние **На удержании**. В противном случае сведения о состоянии обновляются автоматически.

В следующей таблице описываются значения поля **Статус**.

| Состояние | Описание |
|--|--|
| Готово | Задание в очереди готово к запуску. |
| В работе | Задание в очереди выполняется. Это поле обновляется, когда выполняется очередь заданий. |
| На удержании | Статус задания в очереди по умолчанию, когда оно создается. Выберите действие **Установить статус Готово** для изменения статуса на **Готово**. Выберите действие **Поставить на удержание**, чтобы вернуть статус **На удержании**. |
| Ошибка | Произошла ошибка. Выберите **Показать ошибку** для просмотра сообщения об ошибке. |
| Завершенные | Задание в очереди завершено. |

> [!Tip]  
> Выполнение заданий в очереди прекращается при возникновении ошибки. Например, это может быть проблемой при подключении к внешней службе, например к банковским данным. Если служба временно недоступна и задание в очереди не может подключиться к ней, появится сообщение об ошибке, а выполнение прекратится. Вам придется вручную перезапустить задание в очереди. Тем не менее этой ситуации можно попробовать избежать с помощью полей **Максимальное кол-во попыток запуска** и **Задержка перед повторным запуском (с)** . В поле **Максимальное кол-во попыток запуска** можно указать, сколько раз нужно перезапускать задание в случае сбоев. В поле **Задержка перед повторным запуском (с)** указывается время между попытками перезапуска в секундах. Комбинация этих двух полей может перезапускать задание в очереди, пока внешняя служба не станет доступной.

### Просмотр статуса любого задания

1. Выберите ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **Операции очереди работ**, а затем выберите связанную ссылку.
2. На странице **Операции очереди работ**, выберите запись очереди заданий, затем выберите действие **Операции журнала**.  

> [!TIP]
> Вы также можете просмотреть состояние записей очереди заданий, используя Application Insights в Microsoft Azure для более глубокого анализа на основе телеметрии. Дополнительные сведения см. в разделах [Мониторинг и анализ телеметрии](/dynamics365/business-central/dev-itpro/administration/telemetry-overview) и [Анализ телеметрии трассировки жизненного цикла очереди заданий](/dynamics365/business-central/dev-itpro/administration/telemetry-job-queue-lifecycle-trace) в содержимом [!INCLUDE [prod_short](includes/prod_short.md)] для разработчиков и администраторов.

## Просмотр запланированных задач

На странице **Запланированные задачи** в [!INCLUDE [prod_short](includes/prod_short.md)] показано, какие задачи готовы к запуску в очереди заданий. На странице также отображается информация о компании, в которой настроено выполнение каждой задачи. Однако могут выполняться только задачи, отмеченные как принадлежащие к текущей среде.  

Например, все запланированные задания останавливаются, если компания находится в среде, которая является копией другой среды. Используйте страницу **Запланированные задачи**, чтобы задать, какие задачи готовы к запуску в очереди заданий.  

> [!NOTE]
> Внутренние администраторы и лицензированные пользователи могут планировать запуск задач. Делегированные администраторы могут настраивать и планировать запуск задач, но запускать их могут только лицензированные пользователи.

## Часть "Моя очередь работ"

Раздел **Моя очередь работ** в вашем ролевом центре показывает операции очереди заданий, которые вы запустили, но они еще не завершены. По умолчанию раздел не виден, но вы можете добавить его в ролевой центр. Дополнительные сведения см. в разделе [Персонализация рабочей области](ui-personalization-user.md).  

Раздел содержит следующую информацию:

* Какие документы с вашим кодом в поле **Код исполнителя** обрабатываются или помещены в очередь, включая те, которые связаны с фоновой обработкой. 
* Происходили ли ошибки при учете документов или выполнении заданий из очереди. 

Раздел "Моя очередь заданий" также позволяет отменить учет документа.

### Просмотр ошибки из части "Моя очередь работ"

1. Для операции со статусом **Ошибка** выберите действие **Показать ошибку**.
2. Просмотрите сообщение об ошибке и устраните проблему.

## Примеры того, что можно запланировать с помощью очереди заданий

### Планирование отчетов

Можно запланировать выполнение отчета или пакетного задания на заданную дату и время. Запланированные отчеты и пакетные задания вводятся в очередь заданий и обрабатываются в запланированное время, как и другие задания. После выбора действия **Отправить** необходимо выбрать вариант **Запланировать**, а затем ввести такую информацию, как принтер, время и дата, а также повторение.  

Дополнительные сведения см. в разделе [Планирование выполнения отчета](ui-work-report.md#ScheduleReport)

### Планирование синхронизации между [!INCLUDE[prod_short](includes/prod_short.md)] и [!INCLUDE[prod_short](includes/cds_long_md.md)]

Если вы интегрировали [!INCLUDE[prod_short](includes/prod_short.md)] с [!INCLUDE[prod_short](includes/cds_long_md.md)], очередь заданий позволяет запланировать синхронизацию данных. В зависимости от направления и правил, которые вы определили, задание в очереди может создавать записи в одном приложении для соответствия записям в другом. Хороший пример — при регистрации контакта в [!INCLUDE[crm_md](includes/crm_md.md)] задание в очереди может автоматически настроить контакт в [!INCLUDE[prod_short](includes/prod_short.md)]. Дополнительные сведения см. в разделе [Планирование синхронизации между Business Central и Dynamics 365 Sales](admin-scheduled-synchronization-using-the-synchronization-job-queue-entries.md).

### Планирование учета заказов на продажу и покупку

Очередь заданий можно использовать для планирования запуска бизнес-процессов в фоновом режиме. Например, фоновые задания удобны, если несколько пользователей пробуют одновременно разместить заказы на продажу, но только один заказ может обрабатываться одновременно. Дополнительные сведения см. в разделе [Настройка фонового учета с очередями работ](ui-batch-posting.md#to-set-up-background-posting-with-job-queues)

## Мониторинг очереди заданий с помощью телеметрии

Как администратор вы можете использовать [Application Insights](/azure/azure-monitor/app/app-insights-overview) для сбора и анализа телеметрии, которую можно использовать для выявления проблем. Дополнительные сведения см. в разделе [Мониторинг и анализ телеметрии](/dynamics365/business-central/dev-itpro/administration/telemetry-overview) в материалах для разработчиков и администрирования.  

## См. также

[Администрация](admin-setup-and-administration.md)  
[Настройка Business Central](setup.md)  
[Изменение базовых настроек](ui-change-basic-settings.md)  
[Анализ телеметрии трассировки жизненного цикла очереди заданий](/dynamics365/business-central/dev-itpro/administration/telemetry-job-queue-lifecycle-trace)  


[!INCLUDE[footer-include](includes/footer-banner.md)]