---
title: Настройка принтеров универсальной печати
description: 'Узнайте, как использовать универсальная печать для обеспечения облачной печати в Business Central.'
author: jswymer
ms.author: jswymer
ms.reviewer: jswymer
ms.service: dynamics365-business-central
ms.topic: how-to
ms.date: 01/26/2023
ms.custom: bap-template
---

# <a name="set-up-universal-print-printers"></a>Настройка принтеров универсальной печати

[!INCLUDE[azure-ad-to-microsoft-entra-id](~/../shared-content/shared/azure-ad-to-microsoft-entra-id.md)]

Универсальная печать — это служба на основе подписки Microsoft 365, полностью работающая на Microsoft Azure. Она обеспечивает централизованное управление принтером через портал универсальной печати. [!INCLUDE[prod_short](includes/prod_short.md)] делает принтеры, настроенные в универсальной печати, доступными для пользователей клиентов через расширение **Интеграция универсальной печати**.

![Настройка универсальной печати.](media/Universal-Print-arch.png)

Полная настройка требует, чтобы вы работали как в Microsoft Azure с помощью [Портала Azure](https://portal.azure.com), так и в [!INCLUDE[prod_short](includes/prod_short.md)]. Настройка разделена на две основные задачи, как описано в этой статье:

1. В Microsoft Azure настройте универсальную печать и добавьте принтеры, которые вы хотите использовать в Business Central, в общие ресурсы печати. Перейдите к [этому разделу](#set-up-universal-print-and-printers-in-microsoft-azure).
2. В [!INCLUDE[prod_short](includes/prod_short.md)] добавьте принтеры из общих ресурсов печати в универсальную печать. Перейдите к [этому разделу](#add-printers-in-business-central-online) в Интернете или [сюда](#add-printers-in-business-central-on-premises) в локальной среде.

## <a name="prerequisites"></a>Предварительные требования

- Поддерживаемые принтеры

  [!INCLUDE[prod_short](includes/prod_short.md)] поддерживает те же принтеры, что и универсальная печать, и эти принтеры могут быть как совместимые с универсальной печатью, так и несовместимые. Несовместимые принтеры не могут напрямую взаимодействовать с универсальной печатью, поэтому им требуется дополнительное программное обеспечение для подключения, которое предоставляется универсальной печатью. Некоторые старые принтеры могут не поддерживаться. 

- Универсальная печать:

  - Подписка/лицензия на универсальную печать для вашей организации.

    Подробнее см. в разделе [Лицензирование универсальной печати](/universal-print/fundamentals/universal-print-license).

  - У вас есть роли **Администратор принтера** и **Глобальный администратор** в Azure.

    Для управления универсальной печатью ваша учетная запись должна иметь роли **Администратор принтера** и **Глобальный администратор** в Microsoft Entra ID. Эти роли необходимы только для управления универсальной печатью. Они не требуются тем, кто настраивает принтеры из [!INCLUDE[prod_short](includes/prod_short.md)].

- [!INCLUDE[prod_short](includes/prod_short.md)] (сетевая и локальная версии):

  - [!INCLUDE[prod_short](includes/prod_short.md)] выпуск 2021, волна 1, или новее.
  - Установлено расширение **Интеграция универсальной печати**.

    Это расширение публикуется и устанавливается по умолчанию как часть сетевой и локальной версии [!INCLUDE[prod_short](includes/prod_short.md)]. Вы можете проверить, установлено ли оно, на странице **Управление расширениями**. Подробнее см. в разделе [Установка и удаление расширений в Business Central](ui-extensions-install-uninstall.md).
- [!INCLUDE[prod_short](includes/prod_short.md)] (только локальная версия):
  - Проверка подлинности Microsoft Entra ID или по NavUserPassword настроена.
    > [!NOTE]
    >  Расширение универсальной печати не поддерживает проверку подлинности между службами (S2S). Для отправки заданий на печать в службу универсальной печати через Graph API требуется вошедший в систему пользователь.
  - Приложение для Business Central регистрируется в вашем клиенте Microsoft Entra и [!INCLUDE[prod_short](includes/prod_short.md)].

    Как и другие службы Azure, которые работают с [!INCLUDE[prod_short](includes/prod_short.md)], универсальная печать требует регистрации приложения для [!INCLUDE[prod_short](includes/prod_short.md)] в Microsoft Entra ID. Регистрация приложения предоставляет услуги аутентификации и авторизации между [!INCLUDE[prod_short](includes/prod_short.md)] и универсальной печатью.

    Ваше развертывание может уже использовать регистрацию приложения для других служб Azure, например Power BI. Если да, то используйте существующую регистрацию приложения для универсальной печати, а не добавляйте новую. Единственное, что вам нужно сделать в этом случае, — это изменить регистрацию приложения, чтобы включить соответствующие разрешения на печать для Microsoft Graph API: **PrinterShare.ReadBasic.All**, **PrintJob.Create** и **PrintJob.ReadBasic.** 

    Чтобы зарегистрировать приложение и установить соответствующие разрешения, выполните действия, описанные в статье [Регистрация приложения в Microsoft Entra ID](/dynamics365/business-central/dev-itpro/administration/register-app-azure#register-an-application-in-azure-active-directory).

## <a name="set-up-universal-print-and-printers-in-microsoft-azure"></a>Настройка универсальной печати и принтеров в Microsoft Azure

Прежде чем вы сможете начать управлять принтерами универсальной печати в Business Central, необходимо выполнить несколько задач, чтобы настроить универсальную печать и запустить ее в Azure с теми принтерами, которые вы хотите использовать.

Подробные инструкции по настройке см. в разделе [Начало работы: настройка универсальной печати](/universal-print/fundamentals/universal-print-getting-started) в документации по универсальной печати. Вот обзор шагов, которые вам необходимо выполнить. Большинство этих шагов выполняется на портале Azure.

1. Назначьте лицензии универсальной печати себе и другим пользователям.

    Как вы назначаете лицензию, зависит от того, интегрируетесь ли вы с Business Central Online или On-Premises.

    - С [!INCLUDE[prod_short](includes/prod_short.md)] Online вы назначаете лицензии с помощью центра администрирования Microsoft 365.

      Подробнее см. в разделе [Справка центра администрирования Microsoft — назначение лицензий пользователям](/microsoft-365/admin/manage/assign-licenses-to-users).

    - Если у вас локальная версия [!INCLUDE[prod_short](includes/prod_short.md)], вы назначаете лицензии в своем арендаторе с помощью портала Azure.

      Подробнее см. в статье [Назначение или удаление лицензий на портале Azure](/azure/active-directory/fundamentals/license-users-groups).

2. Установите соединитель универсальной печати для регистрации принтеров, которые не могут напрямую взаимодействовать с универсальной печатью.

    Большинство имеющихся на рынке принтеров не могут напрямую взаимодействовать с универсальной печатью, поэтому необходимо установить соединитель универсальной печати. Подробнее см. в разделе [Установка соединителя универсальной печати](/universal-print/fundamentals/universal-print-connector-installation).

3. Зарегистрируйте свои принтеры в службе универсальной печати.

    При регистрации принтера служба универсальной печати узнает о принтере.

    - Для принтеров, которые могут напрямую взаимодействовать со службой универсальной печати, следуйте инструкциям производителя принтера.

    - Для других принтеров зарегистрируйте принтеры с помощью соединителя универсальной печати. 

      Подробнее см. в разделе [Регистрация принтера](/universal-print/fundamentals/universal-print-connector-printer-registration).

4. Изменение свойств принтера (необязательно)

    После регистрации принтера вы можете просматривать и изменять свойства принтера, например настройки по умолчанию.

    Подробнее см. в разделе [Управление настройками принтера с помощью портала универсальной печати](/universal-print/portal/configure-printer-settings).

5. Поделитесь принтерами с пользователями.

    Любой принтер, который вы хотите использовать в [!INCLUDE[prod_short](includes/prod_short.md)], необходимо открыть для *общего доступа* в службе универсальной печати. Любой пользователь, которому требуется доступ к принтеру, должен быть добавлен в качестве участника общего доступа к принтеру. Подробнее см. в разделе [Общий доступ к принтеру](/universal-print/portal/share-printers).

    > [!TIP]
    > Вы всегда можете добавить или удалить пользователей позже. Подробнее см. в разделе [Разрешения принтера](/universal-print/portal/share-printers#configure-user-permissions-for-a-printer-share).

6. Включите преобразование документов.

    Универсальная печать отображает содержимое для печати в формате XPS. Некоторые существующие на рынке старые принтеры не поддерживают рендеринг содержимого XPS — во многих случаях поддерживается только формат PDF. Печать на этих принтерах завершится ошибкой, если служба универсальной печати не настроена для преобразования документов в формат, поддерживаемый принтером.

    Подробнее см. в разделе [Обзор преобразования документов](/universal-print/portal/document-conversion).

Теперь вы готовы добавить принтеры в [!INCLUDE[prod_short](includes/prod_short.md)], настроить принтеры по умолчанию для отчетов и начинать печатать.  

## <a name="add-printers-in-business-central-online"></a>Добавление принтеров в Business Central Online

После того как принтеры настроены и к ним предоставлен общий доступ в службе универсальной печати, вы готовы добавить их в [!INCLUDE[prod_short](includes/prod_short.md)] для использования. Есть два способа добавить принтеры универсальной печати. Вы можете добавить принтеры все сразу или по отдельности.

Добавление принтеров по отдельности позволяет настраивать один и тот же принтер универсальной печати в [!INCLUDE[prod_short](includes/prod_short.md)] более одного раза. Затем для каждого добавленного принтера вы можете изменить настройки печати, такие как лоток для бумаги, размер и ориентация. Таким образом вы можете настроить принтеры для различных отчетов и документов, требующих особого вывода.

> [!NOTE]
> Вы используете [!INCLUDE[prod_short](includes/prod_short.md)] локальную версию? Если это так, перейдите к [следующему разделу](#add-printers-in-business-central-on-premises), первоначальная настройка немного отличается.  
<!-- To Do Adding printers individually lets you duplicate printers with custom , like different paper trays and paper size and orientation.  To add printers individually, you'll need to know printer's share name in Universal Print. -->

1. Выберите значок ![Лампочка, которая открывает функцию «Что вы хотите сделать»](media/ui-search/search_small.png "Что вы хотите сделать"), значок, введите **Управление принтером**, затем выберите связанную ссылку.
2. Выберите пункт **Универсальная печать**, затем выберите один из следующих параметров:

   - **Добавить все принтеры универсальной печати**, чтобы добавить все принтеры, которые еще не добавлены. Вы можете использовать этот параметр, даже если принтеры уже добавлены.
   - **Добавить принтер универсальной печати**, чтобы добавить конкретный принтер.  
3. Следуйте инструкциям на экране.

    - Если вы выбрали **Добавить все принтеры универсальной печати**, то запускается настройка **Добавление принтеров универсальной печати**. 

    - Если вы выбрали **Добавить принтер универсальной печати**, то откроется страница **Параметры универсальной печати**. Заполните поле **Имя**, затем выберите **...** рядом с полем **Общий ресурс печати в универсальной печати**, чтобы выбрать общий принтер, содержащий принтер универсальной печати. Заполните требуемым образом остальные поля. [!INCLUDE[tooltip-inline-tip](includes/tooltip-inline-tip_md.md)].

После добавления принтера вы можете просматривать и изменять его настройки со страницы **Управление принтером**. Просто выберите принтер, затем выберите **Изменить параметры принтера**.

## <a name="add-printers-in-business-central-on-premises"></a>Добавление принтеров в Business Central локальная версия

<!--With [!INCLUDE[prod_short](includes/prod_short.md)] on-premises, unlike online, users aren't automatically authenticated with the registered app in Azure used for the Universal Print service. So, before any Business Central user (including admins) can add or even use Universal Print printers, they'll have to authenticate with the Azure app and grant access to the Universal Print service. The following procedure describes how to initiate this authentication flow. Each user typically only has to do this task once.-->

Прежде чем пользователь сможет добавить или использовать принтеры универсальной печати в Business Central, он должен авторизовать доступ к службам Azure, используемым службой универсальной печати, и предоставить ему разрешение на такие данные и операции, как:

- Вход в систему и чтение профиля пользователя
- Чтение основной информации о задании печати
- Создание заданий печати

Обычно это делается при первом подключении к зарегистрированному в Azure приложению, используемому для универсальной печати. В Business Central Online этот поток авторизации выполняется беспрепятственно, без взаимодействия с пользователем. Но локальная версия Business Central работает по-другому. Для этого требуется, чтобы вы или любой другой пользователь, который хочет использовать принтеры универсальной печати, инициировал поток проверки подлинности&mdash;обычно только один раз. Самый прямой способ описан в следующих шагах. Менее прямым способом является подключение к другой интегрированной службе, которая использует то же зарегистрированное приложение Azure, например Power BI или OneDrive. Каждый пользователь обычно должен выполнить эту задачу только один раз.

> [!NOTE]
> Если вы являетесь администратором, мы рекомендуем выполнить эту задачу раньше других пользователей. Затем сообщите пользователям, которым потребуется использовать принтеры универсальной печати, как это сделать. Если зарегистрированному в Azure приложению для универсальной печати требуется согласие администратора на разрешения API, будет проще предоставить согласие от имени организации. Вы можете предоставить согласие администратора на портале Azure или при выполнении следующих шагов. 

<!-- To Do Adding printers individually lets you duplicate printers with custom , like different paper trays and paper size and orientation.  To add printers individually, you'll need to know printer's share name in Universal Print. -->
### <a name="connect-to-universal-print-for-the-first-time"></a>Подключитесь к универсальной печати в первый раз

Выполните эти шаги, чтобы подключиться к службе универсальной печати в первый раз.

1. Выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **Управление принтером**, затем выберите связанную ссылку.
2. Выберите **Универсальная печать** > **Добавить все принтеры универсальной печати**, чтобы запустить руководство по настройке (мастер) **Добавление принтеров универсальной печати**.
3. Следуйте инструкциям на экране, пока не дойдете до страницы **РАЗРЕШЕНИЯ СЛУЖБЫ MICROSOFT ENTRA**.

    <!--The MICROSOFT ENTRA SERVICE PERMISSIONS page appears. You'll be prompted to give consent to Azure Services. You'll be lead through the process of verifying your Microsoft Entra ID setup, checking your Universal Print license, and then adding the printers.-->

   ![Показана страница РАЗРЕШЕНИЯ СЛУЖБЫ MICROSOFT ENTRA](media/azure-ad-services-permissions.png "Показана страница РАЗРЕШЕНИЯ СЛУЖБЫ MICROSOFT ENTRA")

4. Выберите ссылку **Авторизовать службы Azure**.

   1. Если появится страница **Запрошено разрешение**, внимательно прочитайте ее и выберите **Принять**, чтобы согласиться и продолжить. Если вы работаете в качестве администратора, вы можете выбрать **Согласие от имени организации**, если вы хотите дать согласие для всех пользователей.

      ![Показывает страницу разрешений запроса Azure](media/azure-ad-permissions-requested.png "Страница разрешений запроса Azure").

   2. Если вас попросят, войдите в со своим именем пользователя и паролем.

5. После успешного завершения авторизации вы вернетесь на страницу **Добавить принтеры универсальной печати**. Чтобы завершить настройку, выберите **Далее** > **Готово**.

После добавления принтера вы можете просматривать и изменять его настройки со страницы **Управление принтером**. Просто выберите принтер, затем выберите **Изменить параметры принтера**.

После первоначального входа в систему вы можете использовать принтеры универсальной печати для печати отчетов и других заданий на печать. Для получения дополнительной информации перейдите к [Печать отчета](ui-work-report.md#PrintReport). Если вы хотите добавить, удалить или изменить какие-либо принтеры, просто вернитесь на страницу **Управление печатью** и выберите **Универсальная печать**.

## <a name="common-problems-and-resolutions"></a>Распространенные проблемы и способы их решения

В этом разделе вы узнаете о распространенных проблемах, с которыми могут столкнуться пользователи при попытке настроить или использовать принтеры универсальной печати.

### <a name="you-dont-have-access-to-the-printer-your-printer"></a>У вас нет доступа к принтеру \<your-printer\>.

Если пользователь получает это сообщение при попытке распечатать документ на принтере универсальной печати, это может быть вызвано одним из следующих условий:

- У пользователя нет лицензии Universal Print, назначенной его учетной записи Microsoft 365 или Azure Active AD. 
- Пользователь не назначен общему принтеру в универсальной печати.
- (Локальный) Регистрация приложения Azure, используемая для универсальной печати, не работает или была недавно изменена с момента последнего входа пользователя в систему.
- (Локально) Пользователь еще не вошел в зарегистрированное приложение Azure для приложения универсальной печати и не дал согласие в первый раз.

## <a name="there-was-an-error-fetching-printers-shared-to-you"></a>Произошла ошибка при извлечении принтеров, к которым вам предоставлен доступ.

Если пользователь получает это сообщение при попытке добавить принтер универсальной печати со страницы **Управление принтером**, обычно это связано с тем, что он еще не выполнил вход в зарегистрированное приложение Azure для приложения универсальной печати и не дал согласие в первый раз. 
<!--
### <a name="troubleshooting"></a>Troubleshooting

#### <a name="you-dont-see-the-a-printer-in-the"></a>You don't see the a printer in the

The printer is not shared in Universal Print.

### <a name="you-get-an-error-when-tryong-to-add-all-or-a-single-printer"></a>You get an error when tryong to add all or a single printer

You have'nt been assigned a Uincersla Print license.

There was an error fetching printers shared to you. You don't have access to the data. Make sure your account has been assigned a Universal Print license and you have the required permissions.
or 
You don't seem to have access to Universal Print. Make sure you have a Universal Print subscription, and that your account has been assigned a Universal Print license.

## <a name="could-not-upload-the-document-to-print-job-50"></a>Could not upload the document to print job 50.

There is a technical problem withe the printer. Unsupported document-format: application/pdf. Supported formats: Attribute document-format-supported: SimpleIppValue-Type:MimeMediaType-Value:application/oxps




-->

## <a name="next-steps"></a>Дальнейшие шаги
[Настройка принтеров по умолчанию](ui-specify-printer-selection-reports.md).

## <a name="see-also"></a>См. также

[Обзор принтеров](admin-printer-setup-overview.md)  
[Настройка принтеров с поддержкой электронной почты](admin-printer-setup-email.md)
[Печать отчета](ui-work-report.md#PrintReport)  
[Работа с [!INCLUDE[prod_short](includes/prod_short.md)]](ui-work-product.md)  
[Запуск пакетных заданий](ui-how-run-batch-jobs.md)  

[!INCLUDE[footer-include](includes/footer-banner.md)]
