---
title: Синхронизация и выполнение заказов на продажу
description: Настройте и запустите импорт и обработку заказа на продажу из Shopify.
ms.date: 05/16/2022
ms.topic: article
ms.service: dynamics365-business-central
author: edupont04
ms.author: andreipa
ms.reviewer: solsen
ms.openlocfilehash: e7c54cc620011d238942c093a05918e2f4e57c7d
ms.sourcegitcommit: f071aef3660cc3202006e00f2f790faff849a240
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/18/2022
ms.locfileid: "8768139"
---
# <a name="synchronize-and-fulfill-sales-orders"></a>Синхронизация и выполнение заказов на продажу

В этой статье описаны необходимые настройки и действия, которые необходимо выполнить для синхронизации и выполнения заказов на продажу.

## <a name="set-import-of-orders-on-the-shopify-shop-card"></a>Установите импорт заказов в карточке магазина Shopify

Обычный заказ Shopify может иметь дополнительные суммы сверху, например стоимость доставки или, если включено, чаевые. Эти суммы будут учтены непосредственно на счетах ГК. Выберите счет ГК, который следует использовать для определенных транзакций:

- **Счет стоимости доставки**
- **Счет проданных подарочных карт**, для получения дополнительной информации см. [Подарочная карта](synchronize-orders.md#gift-cards).
- **Счет чаевых**  

Включите **Автоматическое создание заказов**, чтобы автоматически создавать торговые документы в [!INCLUDE[prod_short](../includes/prod_short.md)] сразу же после импорта заказа Shopify.
Документ продажи в [!INCLUDE[prod_short](../includes/prod_short.md)] содержит ссылку на заказ Shopify. При включении **№ заказа Shopify в строке док.** эта информация будет повторяться в строке продаж типа *Комментарий*.

В поле **Источник налоговой области** вы можете определить приоритет выбора кода налоговой области или бизнес-группы НДС на основе адреса. Этот шаг актуален для стран, в которых действует налог с продаж, но может использоваться и для стран с НДС. Дополнительные сведения см. в разделе [Примечания относительно налогов](synchronize-orders.md#tax-remarks).

### <a name="shipment-method-mapping"></a>Сопоставление способов доставки

**Код способа доставки** для торговых документов, импортированных из Shopify, может быть заполнен автоматически. Вам нужно настроить параметр **Сопоставление способов доставки**.

1. Нажмите на значок поиска ![Лампочка, которая открывает функцию "Что вы хотите сделать"](../media/ui-search/search_small.png "Что вы хотите сделать"), значок, введите **магазин Shopify** и выберите связанную ссылку.
2. Выберите магазин, для которого вы хотите определить сопоставление, чтобы открыть страницу **Карточка магазина Shopify**.
3. Выберите действие **Сопоставление способов доставки**. Записи о способах доставки, определенных в настройках [**Перевозки**](https://www.shopify.com/admin/settings/payments) в вашем **центре администрирования Shopify** создаются автоматически.
4. В поле **Имя** вы можете увидеть название способа доставки из Shopify.
5. Введите **Код способа доставки** вместе с соответствующим способом доставки в [!INCLUDE[prod_short](../includes/prod_short.md)].

> [!NOTE]  
> Если с заказом на продажу связано несколько расходов на доставку; только один будет выбран в качестве метода доставки и назначен для торгового документа.

### <a name="payment-method-mapping"></a>Сопоставление способов оплаты

Чтобы заполнить **Код способа оплаты** для торговых документов, импортированных из Shopify автоматически, вам нужно настроить параметр **Сопоставление способов оплаты**.

1. Введите в поиске ![Лампочка, которая открывает функцию "Что вы хотите сделать".](../media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **магазин Shopify** и выберите связанную ссылку.
2. Выберите магазин, для которого вы хотите определить сопоставление, чтобы открыть страницу **Карточка магазина Shopify**.
3. Выберите действие **Сопоставление способов оплаты**.
4. В полях **Шлюз** и **Эмитент кредитной карты** введите название способа оплаты из Shopify. Запись создается автоматически при импорте заказов Shopify.
5. Введите **Код способа оплаты** вместе с соответствующим способом оплаты в [!INCLUDE[prod_short](../includes/prod_short.md)].
6. Установите **приоритет** для случаев, когда клиент использует несколько способов оплаты. В торговом документе выбирается способ оплаты с наивысшим приоритетом. Если оба способа оплаты имеют одинаковый приоритет, используется способ оплаты с наибольшей суммой.

## <a name="run-order-synchronization"></a>Запуск синхронизации заказов

Следующая процедура описывает, как импортировать и обновить заказы на продажу.

> [!NOTE]  
> Архивные заказы в Shopify нельзя импортировать. Деактивируйте параметр **Автоматически архивировать заказ** в разделе **Обработка заказов** в настройках **Оформление заказа** в вашем **центре администрирования Shopify**, чтобы убедиться, что все заказы импортируются в [!INCLUDE[prod_short](../includes/prod_short.md)]. Если вам нужно импортировать архивные заказы, используйте действие **Разархивировать заказы** на странице [Заказы](https://www.shopify.com/admin/orders) центра администрирования Shopify.

1. Введите в поиске ![Лампочка, которая открывает функцию "Что вы хотите сделать".](../media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **магазин Shopify** и выберите связанную ссылку.
2. Выберите магазин, для которого вы хотите импортировать заказы, чтобы открыть страницу **Карточка магазина Shopify**.
3. Выберите действие **Заказы**.
4. Выберите действие **Синхронизировать заказы из Shopify**.
5. При необходимости определите фильтры для заказов. Например, вы можете импортировать полностью оплаченные заказы или заказы с низким уровнем риска.
6. Нажмите кнопку **ОК**.

Кроме того, вы можете выполнить поиск пакетного задания **Синхронизировать заказы из Shopify**.

После завершения импорта вы можете изучить данные заказа Shopify и найти всю сопутствующую информацию, такую как платежные операции, стоимость доставки, выполнение, уровень риска. Вы также можете увидеть подтверждение заказа, отправленное клиенту, выбрав действие **Страница статуса Shopify**.

> [!NOTE]  
> Вы можете перейти в окно **Заказы Shopify** напрямую и посмотреть заказы со статусом *открытый* из всех магазинов. Для просмотра выполненных заказов вам необходимо открыть страницу **Заказы Shopify** из конкретного окна **Карточка магазина Shopify**.

## <a name="create-sales-document-in-business-central"></a>Создание документа продажи в Business Central

Если переключатель **Автоматическое создание заказов** включен в **карточке магазина Shopify**, [!INCLUDE[prod_short](../includes/prod_short.md)] пытается создать торговый документ после импорта заказа. В случае, если в процессе возникают проблемы, например, если клиент или продукт отсутствуют, вам необходимо устранить проблему и попытаться снова создать заказ на продажу.

### <a name="to-create-sales-document"></a>Как создать документ продажи

1. Введите в поиске ![Лампочка, которая открывает функцию "Что вы хотите сделать".](../media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **магазин Shopify** и выберите связанную ссылку.
2. Выберите магазин, для которого вы хотите синхронизировать заказы, чтобы открыть страницу **Карточка магазина Shopify**.
3. Выберите действие **Заказы**.
4. Выберите заказ, для которого вы хотите создать документ продажи, и выберите действие **Создать документы продажи**.
5. Выберите **Да**.

Если заказ Shopify требует выполнения, будет создан **Заказ на продажу** для выполнения заказов Shopify. Например, для тех, которые содержат только подарочную карту, создается **Счет продажи**.

Теперь торговый документ создан, и им можно управлять с помощью стандартных функций [!INCLUDE[prod_short](../includes/prod_short.md)].

### <a name="manage-missing-customers"></a>Управление отсутствующими клиентами

Если ваши настройки препятствуют автоматическому созданию клиента, а существующий клиент не может быть найден, вы можете назначить клиента для заказа Shopify вручную. Имеется несколько вариантов:

- Вы можете назначить **Код клиента (покупателя)** непосредственно в **заказе Shopify** путем выбора клиента из списка существующих клиентов.
- Вы можете выбрать код шаблона клиента, создать и назначить клиента через действие **Создать нового клиента** в **заказе Shopify**.
- Вы можете сопоставить существующего клиента со связанным **клиентом Shopify** в окне **Клиенты Shopify**, а затем выбрать действие **Сопоставление полей** в **заказе Shopify**.

### <a name="tax-remarks"></a>Примечания относительно налогов

В то время как импортированный заказ Shopify содержит информацию о налогах, налоги пересчитываются при создании документа продажи. Вот почему важно, чтобы настройки НДС (налогов) были правильными в [!INCLUDE[prod_short](../includes/prod_short.md)].

- Множественные ставки налога (НДС) на товары. Например, для некоторых категорий товаров действуют сниженные налоговые ставки. Эти элементы должны существовать в [!INCLUDE[prod_short](../includes/prod_short.md)] и быть сопоставленным с товарами Shopify. В противном случае при автоматическом создании отсутствующих позиций будет использоваться товарная группа НДС.

- Ставки налога в зависимости от адреса. Используйте поле **Приоритет налоговой области** вместе с таблицей **Шаблоны клиентов** для перезаписи стандартной логики, которая заполняет **Код налоговой области** в документе продажи. Поле **Приоритет налоговой области** указывает приоритет, откуда функция должна брать информацию о стране (регионе) и штате (провинции). Затем находится соответствующая запись в шаблонах клиентов Shopify и используется **Код налоговой области**, **Облагается налогом** и **НДС бизнес-группа** при создании торгового документа.

## <a name="synchronize-shipments-to-shopify"></a>Синхронизация отгрузок в Shopify

Когда заказ на продажу, созданный из заказа Shopify, отгружается, вы можете синхронизировать отгрузки в Shopify.

1. Введите в поиске ![Лампочка, которая открывает функцию "Что вы хотите сделать".](../media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **Синхронизировать отгрузки в Shopify**, а затем выберите связанную ссылку.
2. При необходимости определите фильтры для отгрузок. Например, вы можете обновить отгрузку, размещенную на определенную дату.
3. Нажмите кнопку **ОК**.

Заказ в Shopify будет отмечен как выполненный. Клиент автоматически получает уведомление об отгрузке по электронной почте или текстовое сообщение (SMS). Если в отправлении указаны экспедитор и код отслеживания, информация об отслеживании будет включена в электронное письмо.

> [!NOTE]  
> Не забудьте запустить **Синхронизация заказов из Shopify**, чтобы обновить статус выполнения заказа в [!INCLUDE[prod_short](../includes/prod_short.md)]. Функционал соединителя также архивирует полностью оплаченные и выполненные заказы как в Shopify, так и в [!INCLUDE[prod_short](../includes/prod_short.md)] при выполнении условий.

### <a name="shipping-agents-and-tracking-url"></a>Экспедиторы и URL-адрес для отслеживания

Если документ **Учтенная расходная накладная продажи** содержит **код экспедитора** и/или **номер отслеживания посылки**, эта информация будет отправлена на Shopify и конечному покупателю в электронном письме с подтверждением доставки.

Компания, обеспечивающая отслеживание, заполняется на основе записи об экспедиторе со следующими приоритетами (от высшего к низшему):

- **Компания в Shopify, обеспечивающая отслеживание**
- **Название**
- **Код**

Если поле **URL-адрес для отслеживания посылки** заполнено для записи экспедитора, то подтверждение доставки также будет содержать URL-адрес для отслеживания.

## <a name="gift-cards"></a>Подарочные карты

В магазине Shopify можно продавать подарочные карты, которыми в дальнейшем можно расплачиваться за реальные товары.

При работе с подарочными картами важно ввести значение в поле **Счет проданных подарочных карт** в окне **Карточка магазина в Shopify**. Проданная подарочная карта будет синхронизирована с заказами в строке. Примененная подарочная карта также будет импортирована вместе с заказом, но уже как транзакция. Обратите внимание, что подарочная карта не уменьшает сумму счета.

Чтобы просмотреть выпущенные и примененные подарочные карты, выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать.](../media/ui-search/search_small.png "Что вы хотите сделать"), введите **Подарочные карты**, а затем выберите связанную ссылку.

## <a name="transactions"></a>Транзакции

Платежные операции, совершенные в Shopify, синхронизируются с заказами и могут быть просмотрены из заказа *Shopify*.

Чтобы просмотреть все транзакции, выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать.](../media/ui-search/search_small.png "Что вы хотите сделать"), введите **Транзакции**, а затем выберите связанную ссылку.

## <a name="payouts"></a>Выплаты

Если в вашем магазине включены платежи Shopify, вы будете получать платежи через *выплаты Shopify*, когда клиент платит с помощью платежей Shopify и ускоренного оформления заказов.

1. Введите в поиске ![Лампочка, которая открывает функцию "Что вы хотите сделать".](../media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **магазин Shopify** и выберите связанную ссылку.
2. Выберите магазин, для которого вы хотите синхронизировать выплаты, чтобы открыть страницу **Карточка магазина Shopify**.
3. Выберите действие **Синхронизировать выплаты**.

Чтобы просмотреть все выплаты, выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать.](../media/ui-search/search_small.png "Что вы хотите сделать"), введите **Выплаты**, а затем выберите связанную ссылку.

## <a name="see-also"></a>См. также

[Начало работы с соединителем для Shopify](get-started.md)  
