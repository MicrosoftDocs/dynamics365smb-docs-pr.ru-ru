---
title: Синхронизация и выполнение заказов на продажу
description: Настройка и запуск импорта и обработки заказов на продажу из Shopify.
ms.date: 03/25/2024
ms.topic: article
ms.service: dynamics-365-business-central
ms.search.form: '30110, 30111, 30112, 30113, 30114, 30115, 30121, 30122, 30123, 30128, 30129, 30150, 30151, 30145, 30147'
author: brentholtorf
ms.author: bholtorf
ms.reviewer: andreipa
---

# Синхронизация и выполнение заказов на продажу

В этой статье описаны необходимые настройки и действия, которые необходимо выполнить для синхронизации и выполнения заказов на продажу с помощью Shopify в [!INCLUDE[prod_short](../includes/prod_short.md)].

## Установите импорт заказов в карточке магазина Shopify

Введите **код валюты**, если ваш интернет-магазин использует валюту, отличную от локальной валюты (LCY). Для указанной валюты должен быть настроен обменный курс. Если ваш интернет-магазин использует ту же валюту, что и [!INCLUDE[prod_short](../includes/prod_short.md)], оставьте поле пустым. 

Валюта магазина доступна в разделе [Store details](https://www.shopify.com/admin/settings/general) панели администрирования Shopify. Shopify можно настроить для приема разных валют. Однако в заказах, импортированных в [!INCLUDE[prod_short](../includes/prod_short.md)], используется валюта магазина.

Обычный заказ Shopify может включать в себя затраты в дополнение к подытогу, например стоимость доставки или — если соответствующая функция включена — чаевые. Эти суммы учитываются непосредственно на счете ГК, который вы хотите использовать для определенных типов транзакций:

* **Счет для расходов на доставку**
* **Счет проданных подарочных карт**; для получения дополнительной информации см. раздел [Подарочная карта](synchronize-orders.md#gift-cards)
* **Счет чаевых**  

Включите **Автоматическое создание заказов**, чтобы автоматически создавать торговые документы в [!INCLUDE[prod_short](../includes/prod_short.md)] сразу же после импорта заказа Shopify.

Если вы хотите, чтобы документ продажи выпускался автоматически, включите переключатель **Автоматически выпускать заказ на продажу**.

Если вы не хотите отправлять клиентам автоматические подтверждения отгрузки, отключите переключатель **Отправить подтверждение отгрузки**. Отключение этого переключателя может быть полезно, если вы продаете цифровые товары или хотите использовать другой механизм уведомлений.

Если вы выберете поле **№ заказа Shopify в строке док.**, [!INCLUDE [prod_short](../includes/prod_short.md)] вставляет строки продажи типа **Комментарий** с номером заказа Shopify.

> [!NOTE]
> Документ продажи в [!INCLUDE[prod_short](../includes/prod_short.md)] связан с заказом Shopify, и вы можете добавлять **№ заказа Shopify** на страницы со списками и страницы-карточки для заказов на продажу, счетов и расходных накладных. Подробнее о добавлении полей см. в статье [Начало персонализации с помощью режима персонализации](../ui-personalization-user.md#start-personalizing-by-using-the-personalization-mode). 

В поле **Приоритет налоговой области** укажите, как следует выбирать код налоговой области для адресов в заказах. Импортируемый заказ Shopify содержит информацию о налогах. Налоги пересчитываются при создании документов продажи, поэтому важно, чтобы параметры НДС или налога в [!INCLUDE[prod_short](../includes/prod_short.md)] были правильными. Подробнее о налогах см. в статье [Настройка налогов для подключения к Shopify](setup-taxes.md).

Укажите, как вы будете обрабатывать возвраты товаров и денег:

* **Пустое значение** означает, что вы не импортируете и не обрабатываете возвраты товаров и денег.
* **Только импорт** означает, что вы импортируете информацию, но создавать соответствующую кредит-ноту будете вручную.
* **Автоматически создать кредит-ноту** означает, что вы импортируете информацию и [!INCLUDE[prod_short](../includes/prod_short.md)] автоматически создает кредит-ноты. Для использования этого варианта необходимо включить переключатель **Автоматически создавать заказы на продажу**.

Укажите место для возврата товаров и счета ГК для возвратов денег за товары и других возмещений.

* **Счет для возвратов денег за товары, не возвращенные в запасы** определяет номер счета ГК для товаров, для которых вы не хотите производить корректировку запасов.
* **Счет для возвратов денег** определяет номер счета ГК для разницы между итоговой возвращенной суммой и итоговой стоимостью товаров.

Подробнее см. в статье [Возвраты товаров и денег](synchronize-orders.md#returns-and-refunds)

### Сопоставление способов доставки

**Код способа доставки** для торговых документов, импортированных из Shopify, может быть заполнен автоматически. Вам нужно настроить параметр **Сопоставление способов доставки**.

1. Выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать 1.](../media/ui-search/search_small.png "Что вы хотите сделать"), введите **Магазины Shopify**, а затем выберите соответствующую ссылку.
2. Выберите магазин, для которого вы хотите определить сопоставление, чтобы открыть страницу **Карточка магазина Shopify**.
3. Выберите действие **Сопоставление способов доставки**. Записи о способах доставки, определенных в настройках [**Перевозки**](https://www.shopify.com/admin/settings/payments) в вашем **центре администрирования Shopify** будут созданы автоматически.
4. В поле **Имя** вы можете увидеть название способа доставки из Shopify.
5. Введите **Код способа доставки** вместе с соответствующим способом доставки в [!INCLUDE[prod_short](../includes/prod_short.md)].

> [!NOTE]  
> Если с заказом на продажу связано несколько расходов на доставку; только один будет выбран в качестве метода доставки и назначен для торгового документа.

### Сопоставление складов

Сопоставление складов необходимо для заполнения поля **Код склада** для строк документов продаж, импортированных из Shopify. Это важно, когда переключатель **Склад обязателен** на карточке **Настройка запасов** включен; в противном случае вы не сможете создавать документы продажи.

1. Выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать 1.](../media/ui-search/search_small.png "Что вы хотите сделать"), введите **Магазины Shopify**, а затем выберите соответствующую ссылку.
2. Выберите магазин, для которого вы хотите настроить сопоставление местоположений, чтобы открыть страницу **Карточка магазина Shopify**.
3. Выберите действие **Места**, чтобы открыть **Адреса магазинов Shopify**.
4. Выберите действие **Получить места Shopify** для импорта всех местоположений, определенных в Shopify. Вы можете найти их в меню [**Места**](https://www.shopify.com/admin/settings/locations) настроек вашей панели **администратора Shopify**. 
5. Введите **Код местоположения по умолчанию** с соответствующим расположением в [!INCLUDE[prod_short](../includes/prod_short.md)].

> [!NOTE]  
> Сопоставление складов также используется для синхронизации запасов. Подробнее см. в статье [Синхронизация запасов в Shopify](synchronize-items.md#sync-inventory-to-shopify).
  
## Запуск синхронизации заказов

Следующая процедура описывает, как импортировать и обновить заказы на продажу.

> [!NOTE]  
> Архивные заказы в Shopify нельзя импортировать. Если вам нужно проверить статус заказа, откройте заказ на странице [заказов](https://www.shopify.com/admin/orders) **панели администрирования Shopify** и просмотрите сведения о нем.
> 
> Деактивируйте параметр **Автоматически архивировать заказ** в разделе **Обработка заказов** в настройках **Оформление заказа** на вашей панели **администрирование Shopify**, чтобы убедиться, что все заказы импортируются в [!INCLUDE[prod_short](../includes/prod_short.md)]. Если вам нужно импортировать архивные заказы, используйте действие **Unarchive Orders** на странице [Orders](https://www.shopify.com/admin/orders) панели **Shopify admin**. 

1. Выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать 1.](../media/ui-search/search_small.png "Что вы хотите сделать"), введите **Магазины Shopify**, а затем выберите соответствующую ссылку.
2. Выберите магазин, для которого вы хотите импортировать заказы, чтобы открыть страницу **Карточка магазина Shopify**.
3. Выберите действие **Заказы**.
4. Выберите действие **Синхронизировать заказы из Shopify**.
5. При необходимости определите фильтры для заказов. Например, вы можете импортировать полностью оплаченные заказы или заказы с низким уровнем риска.

   > [!NOTE]  
   > При фильтрации по тегу следует использовать токены фильтра `@` и `*`. Например, если вы хотите импортировать заказы, содержащие *tag1*, используйте `@*tag1*`. `@` гарантирует, что в результатах не будет учитываться регистр, а `*` позволяет найти заказы с несколькими тегами.

6. Нажмите кнопку **ОК**.

Кроме того, вы можете выполнить поиск пакетного задания **Синхронизировать заказы из Shopify**.

Вы можете запланировать задачу для автоматического выполнения. Дополнительные сведения см. а разделе [Планирование повторяющихся задач](background.md#to-schedule-recurring-tasks).

### Внутренняя логика

Соединитель Shopify импортирует заказы в два этапа:

1. Импортирует заголовки заказов в таблицу **Заказы Shopify к импорту**, когда они соответствуют определенным условиям:

   * Они не архивированы. Это означает, что вы можете включать или исключать заказы из синхронизации, архивируя или разархивируя их в администрировании Shopify.
   * Они были созданы или изменены после последней синхронизации. Это означает, что вы можете принудительно повторно импортировать определенный заказ, если измените его — например, добавив **Примечания** или **Тег**.

2. Импортирует заказы Shopify и дополнительную информацию.

   * Соединитель Shopify обрабатывает все записи в таблице **Заказы Shopify к импорту**, которые соответствуют критериям фильтрации, определенным вами на странице запроса **Синхронизировать заказы из Shopify**. Это могут быть, например, теги, канал или статус выполнения. Если вы не указали никаких фильтров, соединитель обрабатывает все записи.
   * При импорте заказа из Shopify соединитель Shopify запрашивает дополнительную информацию у Shopify:

     * Заголовок заказа
     * Строки заказа
     * Информацию о доставке и выполнении
     * Транзакции
     * Возвраты и возмещения, если они настроены

Страницу **Заказы Shopify к импорту** удобно использовать для устранения неполадок при импорте заказов. Вы можете оценить доступные заказы и предпринять следующие действия:

* Проверить, не заблокировала ли ошибка импорт определенного заказа, и изучить подробности ошибки. Проверьте поле **С ошибкой**.
* Обработать только конкретные заказы. Вам нужно будет заполнить поле **Код магазина**, выбрать один или несколько заказов, а затем выбрать действие **Импорт выбранных заказов**.
* Удалить заказы со страницы **Заказы Shopify к импорту**, чтобы исключить их из синхронизации.

## Проверка импортированных заказов

После завершения импорта вы можете изучить данные заказа Shopify и найти всю сопутствующую информацию, такую как платежные операции, стоимость доставки, уровень риска, атрибуты заказа и теги или выполнения, если заказ уже был выполнен в Shopify. Вы также можете увидеть любое подтверждение заказа, отправленное клиенту, выбрав действие **Страница статуса Shopify**.

> [!NOTE]  
> Вы можете перейти в окно **Заказы Shopify** напрямую и посмотреть заказы со статусом *открытый* из всех магазинов. Для просмотра выполненных заказов вам необходимо открыть страницу **Заказы Shopify** с конкретной страницы **Карточка магазина Shopify**.

Перед созданием документов продажи в [!INCLUDE[prod_short](../includes/prod_short.md)] вы можете использовать действие **Синхронизировать заказ из Shopify** на странице **Заказ Shopify** для повторного импорта определенных заказов.

Вы также можете пометить заказ как оплаченный, что удобно делать в B2B-сценариях, где платежи обрабатываются без задействования механизма оформления заказов Shopify. Выберите действие**Пометить как оплаченный** на странице **Заказ Shopify**. Кроме того, вы можете пометить заказ как отмененный, чтобы запустить процесс возврата средств в Shopify. Выберите действие **Отменить заказ** на странице **Заказ Shopify**, заполните необходимые поля на странице **Отмена заказа Shopify** и нажмите **ОК**. Вам нужно будет запустить синхронизацию заказов, чтобы импортировать обновления в [!INCLUDE[prod_short](../includes/prod_short.md)].

## Создание документов продажи в Business Central

Если переключатель **Автоматическое создание заказов** включен в **карточке магазина Shopify**, [!INCLUDE[prod_short](../includes/prod_short.md)] пытается создать документ продажи после импорта заказа. Если возникают проблемы, например отсутствие клиента или продукта, вам необходимо устранить проблему, а затем повторно создать заказ на продажу.

### Для создания документов продажи

1. Выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать 1.](../media/ui-search/search_small.png "Что вы хотите сделать"), введите **Магазины Shopify**, а затем выберите соответствующую ссылку.
2. Выберите магазин, для которого вы хотите синхронизировать заказы, чтобы открыть страницу **Карточка магазина Shopify**.
3. Выберите действие **Заказы**.
4. Выберите заказ, для которого вы хотите создать документ продажи, и выберите действие **Создать документы продажи**.
5. Выберите **Да**.

Если заказ Shopify требует выполнения, будет создан **Заказ на продажу**. Для выполненных заказов Shopify, таких как те заказы, которые содержат только подарочную карту или которые уже обработаны в Shopify, создается **Счет продажи**.

Созданным документом продажи можно управлять с помощью стандартных функций [!INCLUDE[prod_short](../includes/prod_short.md)].

Если вы хотите создать документ продажи заново, вы можете использовать действие **Отвязать обработанные документы** на странице **Заказ Shopify**. Обратите внимание, что это действие не удаляет уже созданный документ продажи. Вам нужно будет обработать его вручную.

### Управление отсутствующими клиентами

Если ваши не позволяют создавать клиентов автоматически, а соответствующего клиента найти не удается, вам необходимо назначить клиента заказу Shopify вручную. Существует несколько способов назначения клиентов заказам:

* Назначить **№ клиента покупателя** и **Код плательщика** непосредственно на странице **Заказы Shopify** путем выбора клиента из списка существующих клиентов.
* Выбрать шаблон клиента, а затем создать и назначить клиента с помощью действия **Создать нового клиента** на странице **Заказы Shopify**. Клиент Shopify должен иметь хотя бы один адрес. В заказах, созданных через канал продаж «POS-терминал Shopify», часто отсутствует информация об адресе.
* Сопоставить существующего клиента со связанным **клиентом Shopify** на странице **Клиенты Shopify**, а затем выбрать действие **Сопоставление полей** на странице **Заказы Shopify**.

### Как соединитель выбирает, какого клиента использовать

Функция *Импорт заказа из Shopify* пытается выбрать клиентов в следующем порядке:

1. Если **№ клиента по умолчанию** определяется в **шаблоне клиента Shopify** для **кода страны/региона получателя**, то используется **№ клиента по умолчанию** независимо от настроек в полях **Импорт клиентов из Shopify** и**Тип сопоставления клиентов**. Подробнее см. в разделе [Шаблон клиента для каждой страны](synchronize-customers.md#customer-template-per-countryregion).
2. Если для параметра **Импорт клиентов из Shopify** задано значение *Нет* и **№ клиента по умолчанию** определен на странице **Карточка магазина Shopify**, то используется **№ клиента по умолчанию** .

Дальнейшие действия зависят от параметра **Тип сопоставления клиентов**.

* Если это **Всегда брать клиента по умолчанию**, то соединитель использует клиента, определенного в поле **№ клиента по умолчанию** на странице **Карточка магазина Shopify**.
* Если это **По электронной почте/телефону**, соединитель сначала пытается найти существующего клиента по идентификатору, затем по электронной почте, а затем по номеру телефона. Если клиент не найден, соединитель создает нового клиента.
* Если это **По информации о плательщике**, соединитель сначала пытается найти существующего клиента по идентификатору, а затем по информации об адресе для выставления счета. Если клиент не найден, соединитель создает нового клиента.

> [!NOTE]  
> Соединитель использует информацию из адреса для выставления счетов и создает клиента для выставления счетов в формате [!INCLUDE[prod_short](../includes/prod_short.md)]. Клиент-покупатель аналогичен клиенту-плательщику.

Для B2B-заказов процедура аналогична, за тем исключением, что соединитель использует поля **№ организации по умолчанию**, **Импорт организаций из Shopify** и **Тип сопоставления организаций** на странице **Карточка магазина Shopify**. Обратите внимание, что поля **№ организации по умолчанию** нет на странице **Шаблон клиента Shopify**, так как в B2B-сценариях ожидается, что клиент будет иметь имя/название.

### Различные правила обработки заказов

Возможно, вы захотите обрабатывать заказы по-разному в соответствии с правилом. Например, для заказов из определенного канала продаж, такого как POS-терминал, должен использоваться клиент по умолчанию, однако в интернет-магазине должна фиксироваться реальная информация о покупателе.

Один из способов выполнить это требование — создать дополнительную карточку магазина Shopify и использовать фильтры на странице запроса **Синхронизировать заказы из Shopify**.

Предположим, что у вас есть интернет-магазин, а также POS-терминал Shopify. Для POS-терминала нужно использовать фиксированного клиента, а для интернет-магазина — создавать клиентов в [!INCLUDE[prod_short](../includes/prod_short.md)]. В следующей процедуре в общих чертах приведены необходимые шаги. Чтобы узнать больше, переходите к соответствующим справочным статьям.

1. Создайте магазин Shopify с именем *STORE* и привяжите его к своей учетной записи Shopify.
1. Настройте синхронизацию товаров/продуктов, чтобы этот магазин управлял информацией о продуктах.
1. Укажите, что клиенты импортируются вместе с заказами. Соединитель должен находить клиентов по их адресу электронной почты. Если он не находит адрес, он использует шаблон клиента для создания нового клиента.
1. Создайте магазин Shopify с именем *POS* и привяжите его к той же учетной записи Shopify.
1. Убедитесь, что синхронизация товаров/продуктов отключена.
1. Выберите соединитель, который использует клиента по умолчанию.
1. Создайте повторяющуюся операцию очереди заданий для отчета 30104 **Синхронизировать заказы из Shopify**. Выберите **STORE** в поле **Код магазина Shopify** и используйте фильтры для перехвата всех заказов, кроме тех, которые создаются каналом POS-терминала. Например, **<>POS-терминал**
1. Создайте повторяющуюся операцию очереди заданий для отчета 30104 **Синхронизировать заказы из Shopify**. Выберите **POS** в поле **Код магазина Shopify** и используйте фильтры для перехвата заказов, генерируемых каналом POS-терминала. Например, **POS-терминал**.

Каждая очередь заданий будет импортировать и обрабатывать заказы в соответствии с заданными фильтрами и использовать правила из карточки соответствующего магазина Shopify. Например, очереди работ будут создавать заказы POS-терминала для клиента по умолчанию.

> [!Important]
> Во избежание конфликтов при обработке заказов используйте одну и ту же категорию очереди заданий для обеих операций очереди заданий.

### Влияние правок заказов

В Shopify:

|Изменить|Влияние на заказы Shopify, еще не обработанные в [!INCLUDE[prod_short](../includes/prod_short.md)] | Влияние на заказы Shopify, уже обработанные в [!INCLUDE[prod_short](../includes/prod_short.md)] |
|------|-----------|-----------|
|Изменение склада выполнения | Склад выполнения синхронизируется с [!INCLUDE[prod_short](../includes/prod_short.md)]. | Склад выполнения синхронизируется с [!INCLUDE[prod_short](../includes/prod_short.md)].|
|Редактирование заказа и увеличение количества|В импортированном заказе будет использоваться новое количество.| Соединитель обнаружит изменение и пометит заказы. |
|Редактирование заказа и уменьшение количества|В импортированном заказе будет использоваться новое количество. Будет импортирован возврат денег Shopify с нулевой суммой, которую невозможно преобразовать в кредит-ноту.| Соединитель обнаружит изменение и пометит заказы. |
|Редактирование заказа и удаление существующего товара |Удаленный товар импортирован не будет. Будет импортирован возврат денег Shopify с нулевой суммой, которую невозможно преобразовать в кредит-ноту.| Соединитель обнаружит изменение и пометит заказы. |
|Отредактируйте заказ и добавьте новый товар | Первоначальные и добавленные товары будут импортированы. | Соединитель обнаружит изменение и пометит заказы. |
|Обработка заказа: выполнение, обновление платежной информации | Заголовок заказа будет обновлен. |Заголовок заказа будет обновлен. Выполнение не будет синхронизировано с Shopify.|
|Отмена оплаченного заказа | Заголовок заказа будет обновлен и будет обработан отдельно |Соединитель обнаружит изменение и пометит заказы. |
|Отмена неоплаченного заказа | Удаленный товар импортирован не будет. Будет импортирован возврат денег Shopify с нулевой суммой, которую невозможно преобразовать в кредит-ноту. |Соединитель обнаружит изменение и пометит заказы. |

Если заказ уже был обработан в [!INCLUDE[prod_short](../includes/prod_short.md)], соединитель выведет следующее сообщение об ошибке: *Заказ уже обработан в Business Central, однако из Shopify была получена измененная версия. Изменения не перенесены в обработанный заказ в Business Central. Обновите обработанные документы в соответствии с полученными из Shopify данными. Если вы хотите принудительно провести синхронизацию, используйте действие «Синхронизировать заказ из Shopify» на странице карточки заказа Shopify.*

В зависимости от статуса созданного документа продажи можно выполнить следующие действия:

1. Удалить созданный документ продажи
2. Выбрать действие **Отвязать обработанные документы**, чтобы сбросить индикатор **Обработано**.
3. Выбрать действие **Синхронизировать заказ из Shopify**, чтобы обновить отдельный заказ в соответствии с последними данными из Shopify.

В [!INCLUDE[prod_short](../includes/prod_short.md)]:

|Изменить|Уменьшение|
|------|-----------|
|Изменение склада на другой склад. Учет отгрузки. | Заказ будет помечен как выполненный. Будет использоваться склад выполнения из Shopify. |
|Уменьшение количества. Учет отгрузки. | Заказ Shopify будет отмечен как частично выполненный. |
|Увеличение количества. Учет отгрузки. | Выполнение не будет синхронизировано с Shopify. То же самое, как если бы выполнение было разделено в Shopify, но обработано как одна строка в [!INCLUDE[prod_short](../includes/prod_short.md)]. |
|Добавьте новый товар. Учет отгрузки. | Заказ Shopify будет отмечен как выполненный. Новые строки добавлены не будут. |

## Синхронизация отгрузок в Shopify

Когда заказ на продажу, созданный из заказа Shopify, отгружается, вы можете синхронизировать отгрузки с Shopify.

1. Выберите ![Лампочка, которая открывает функцию Что вы хотите сделать 1.](../media/ui-search/search_small.png "Что вы хотите сделать") введите **Синхронизировать отгрузки в Shopify**, затем выберите соответствующую ссылку.
2. При необходимости определите фильтры для отгрузок. Например, вы можете обновить отгрузку, размещенную на определенную дату.
3. Выберите **ОК**.

Заказ в Shopify будет отмечен как выполненный. Клиент автоматически получает уведомление об отгрузке по электронной почте или текстовое сообщение (SMS). Если в отправлении указаны экспедитор и код отслеживания, информация об отслеживании будет включена в электронное письмо.

Также можно использовать действие **Синхронизировать отгрузки** на страницах "Заказы на продажу Shopify" или "Магазин Shopify".

Вы можете запланировать задачу для автоматического выполнения. Дополнительные сведения см. а разделе [Планирование повторяющихся задач](background.md#to-schedule-recurring-tasks).

> [!Important]
> Для склада, указанного в строке учтенной расходной накладной (в том числе, если поле склада оставлено пустым), должна иметься соответствующая запись в складе Shopify. В противном случае эта строка не будет отправлена обратно в Shopify. Подробнее см. в разделе [Сопоставление складов](synchronize-orders.md#location-mapping).

Не забудьте запустить **Синхронизацию заказов из Shopify**, чтобы обновить статус выполнения заказа в [!INCLUDE[prod_short](../includes/prod_short.md)]. Функционал соединителя также архивирует полностью оплаченные и выполненные заказы как в Shopify, так и в [!INCLUDE[prod_short](../includes/prod_short.md)] при выполнении условий. 

### Экспедиторы и URL-адрес для отслеживания

Если документ **Учтенная расходная накладная продажи** содержит **код экспедитора** и/или **номер отслеживания посылки**, эта информация будет отправлена на Shopify и покупателю в электронном письме с подтверждением доставки.

Компания, обеспечивающая отслеживание, заполняется на основе записи об экспедиторе в следующем порядке (от высшего к низшему):

1. **Компания в Shopify, обеспечивающая отслеживание**
1. **Название**
1. **Код**

Если поле **URL-адрес для отслеживания посылки** заполнено для записи экспедитора, то подтверждение доставки также будет содержать URL-адрес для отслеживания.

## Возвраты товаров и денег

При интеграции Shopify и [!INCLUDE[prod_short](../includes/prod_short.md)] важно иметь возможность синхронизировать как можно больше бизнес-данных. Это упрощает поддержание уровней финансов и запасов в актуальном состоянии в [!INCLUDE[prod_short](../includes/prod_short.md)]. Данные, которые вы можете синхронизировать, включают возвраты товаров и возвраты денег, регистрируемые на портале администрирования Shopify или в Shopify POS.

Возвраты товаров и возвраты денег импортируются вместе с соответствующими заказами, если вы включили соответствующий тип обработки в карточке магазина Shopify.

Возвраты товаров импортируются только в информационных целях. С ними не связана никакая логика обработки.

Финансовые транзакции и, если необходимо, транзакции с запасами обрабатываются через возвраты денег. Возвраты денег могут включать в себя продукты или просто суммы, — например, если продавец решил компенсировать стоимость доставки или какую-то другую сумму.

Вы можете создавать кредит-ноты продаж для возвратов денег. Кредит-ноты могут иметь следующие типы строк:

|Тип|№|Комментарий|
|-|-|-|
|Счет ГК|Счет проданных подарочных карт| Используется для возвратов денег, связанных с подарочными картами.|
|Счет ГК|Счет для возвратов денег за товары, не возвращенные в запасы | Используется для возвратов денег, связанных с продуктами, которые не были возвращены в запасы. |
|Пункт меню |№ товара| Используется для возвратов денег, связанных с продуктами, которые были возвращены в запасы. Подходит для непосредственных возвратов денег или возвратов денег, связанных с другими возвратами денег. Код местонахождения в строке кредит-ноты устанавливается на основе значения, выбранного для места возврата.|
|Счет ГК| Счет для возвратов денег | Используется для других возвращенных сумм, которые не связаны с продуктами или подарочными картами. Например, это могут быть чаевые или если вы вручную указали сумму возврата в Shopify. |

> [!Note]
> Места возврата, включая пустые места, указанные в **карточке магазина Shopify**, используются в созданной кредит-ноте. Система игнорирует исходные места из заказов или отправок.

## Подарочные карты

В магазине Shopify можно продавать подарочные карты, которыми можно расплачиваться за реальные товары.

При работе с подарочными картами важно ввести значение в поле **Счет проданных подарочных карт** в окне **Карточка магазина в Shopify**. Проданная подарочная карта будет синхронизирована с заказами в строке. Примененная подарочная карта также будет импортирована вместе с заказом, но уже как транзакция. Обратите внимание, что подарочная карта не уменьшает сумму счета.

Чтобы просмотреть выпущенные и примененные подарочные карты, выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать.](../media/ui-search/search_small.png "Что вы хотите сделать"), введите **Подарочные карты**, а затем выберите соответствующую ссылку.

## См. также

[Начало работы с соединителем Shopify](get-started.md)  
