---
title: сопоставление таблицы и поля для синхронизации
description: 'Узнайте, как сопоставить таблицы и поля для синхронизации данных между Business Central и Microsoft Dataverse.'
author: brentholtorf
ms.author: bholtorf
ms.reviewer: bholtorf
ms.topic: conceptual
ms.date: 08/07/2024
ms.custom: bap-template
ms.search.keywords: 'sales, crm, integration, sync, synchronize, table mapping'
ms.service: dynamics-365-business-central
---
# <a name="mapping-the-tables-and-fields-to-synchronize"></a>сопоставление таблицы и поля для синхронизации

Основой синхронизации данных является сопоставление таблиц и полей в [!INCLUDE[prod_short](includes/prod_short.md)] с таблицами и столбцами в [!INCLUDE[prod_short](includes/cds_long_md.md)], чтобы они могли обмениваться данными. Сопоставление происходит через таблицы интеграции.

## <a name="mapping-integration-tables"></a>Сопоставление таблиц интеграции

Таблица интеграции — это таблица базе данных [!INCLUDE[prod_short](includes/prod_short.md)], представляющая таблицу, например счет, в [!INCLUDE[cds_long_md](includes/cds_long_md.md)]. Таблица интеграции включает поля, соответствующие столбцам в таблице [!INCLUDE[cds_long_md](includes/cds_long_md.md)]. Например, таблица интеграции "Счет" связывается с таблицей "Счета" в [!INCLUDE[cds_short_md](includes/cds_long_md.md)]. Для каждой таблице в [!INCLUDE[cds_short_md](includes/cds_short_md.md)], которую необходимо синхронизировать с данными в [!INCLUDE[prod_short](includes/prod_short.md)], должно быть соответствующее сопоставление таблиц интеграции.

Когда вы создаете связь между приложениями, [!INCLUDE[prod_short](includes/prod_short.md)] настраивает некоторые сопоставления по умолчанию. При желании вы можете изменить сопоставление таблиц. Дополнительные сведения см. в разделе [Сопоставление стандартных таблиц для синхронизации](admin-synchronizing-business-central-and-sales.md#standard-table-mapping-for-synchronization). Если вы изменили сопоставления по умолчанию и хотите отменить изменения, на странице **Сопоставления таблиц интеграции**, выберите **Использовать настройку синхронизации по умолчанию**.

> [!Note]
> Если вы используете локальную версию [!INCLUDE[prod_short](includes/prod_short.md)], сопоставления таблиц интеграции хранятся в таблице "5335 Сопоставления таблиц интеграции", где можно просмотреть и изменить сопоставления. Сложные сопоставления и правила синхронизации определены в модуле Codeunit 5341.

> [!TIP]
> При изменении связанной записи [!INCLUDE [prod_short](includes/prod_short.md)] автоматически синхронизирует данные с Dataverse. Автоматическая синхронизация отлично работает в большинстве случаев. Однако частое изменение большого количества связанных записей в таблице может замедлить синхронизацию данных.
>
> Чтобы избежать снижения производительности, на странице **Сопоставления таблиц интеграции** для любой таблицы можно включить или отключить синхронизацию данных на основе событий. По умолчанию синхронизация на основе событий включена, поэтому существующие интеграции не затрагиваются. Ваш администратор может включить или выключить синхронизацию для определенных таблиц.

### <a name="add-table-and-field-mappings-to-existing-integration-tables"></a>Добавить сопоставления таблиц и полей к существующим таблицам интеграции

На странице  **таблица интеграции Mappings**  можно использовать действие New сопоставление таблиц для добавления новых сопоставлений таблиц в таблицы интеграции. Это действие запускает руководство по настройке **Создание новых сопоставлений интеграции**, которое поможет вам настроить новые таблица интеграции и сопоставления полей.

Руководство позволяет сопоставлять таблицы [!INCLUDE [prod_short](includes/prod_short.md)] с существующими таблицами интеграции Dataverse. Вы также можете указать Dataverse уникальный идентификатор таблицы в **таблица интеграции Уникальный идентификатор Имя поля** и **таблица интеграции Изменено Имя поля**, которые необходимы для работы синхронизации данных.

> [!NOTE]
> Поиск по столбцу «Таблица» показывает все [!INCLUDE [prod_short](includes/prod_short.md)] таблицы, включая пользовательские таблицы, которые еще не сопоставлены. Он исключает те, которые уже существуют на вашей странице сопоставлений таблица интеграции. Поиск по столбцу таблица интеграции показывает только Dataverse таблицы (прокси-таблицы AL), которые являются частью готовых интеграций. Чтобы добавить дополнительные или пользовательские Dataverse таблицы, вам понадобится помощь разработчика для их создания и развертывания через расширение.

Действие «Дополнительно» открывает дополнительные параметры сопоставление таблиц, которые вы можете настроить. В разделе **Дополнительно** поле **Фильтр таблицы** позволяет указать фильтры для [!INCLUDE [prod_short](includes/prod_short.md)]. Используйте поле **таблица интеграции Filter** для Dataverse данных, которые следует учитывать при синхронизации данных, вместе с кодами шаблонов конфигурации в **Table Config. Template Code** и **Int. Tbl. Config. Code** для предварительного заполнения отсутствующих данных при поступлении новых данных из любого приложения.

Руководство также поможет вам указать поля, которые должен содержать новый сопоставление. Вы можете сопоставить [!INCLUDE [prod_short](includes/prod_short.md)] поле в столбце **Имя поля** с Dataverse именем поля в столбце **Имя поля интеграции** . Вы также можете указать **Направление**, всегда ли поле имеет одно и то же значение в столбце **Константа**, а также следует ли применять проверки или преобразования во время поля сопоставление.

> [!NOTE]
> Чтобы уменьшить количество ошибок, поиск по столбцу **таблица интеграции Поле** фильтрует список доступных полей. Чтобы сопоставить поля, которые не включены в фильтры, вам понадобится помощь разработчика.
>
> * Поля должны быть включены.
> * Вы не можете использовать руководство для сопоставления полей FlowField и FlowFilter.
> * Вы можете сопоставить только поля типа BigInteger, логический, Code, Date, DateFormula, DateTime, Decimal, Duration, GUID, Integer, Option и Text.

> [!TIP]
> Вы также можете добавлять новые сопоставления полей к существующим сопоставлениям таблица интеграции через страницу списка **Сопоставления полей интеграции**, доступ к которой можно получить, выбрав **Поля** на странице **Сопоставлениятаблица интеграции** .
>
> Просто выберите **Новое поле сопоставление**, чтобы открыть поле сопоставление шаг руководства по настройке **Создание новых сопоставлений интеграции**, а затем действуйте, как описано в этой статье.

Новые сопоставления полей, которые вы добавляете к существующему сопоставление таблиц, находятся в отключенном состоянии. Вы можете выбрать **Изменить список**, чтобы включить их позже.

### <a name="synchronization-rules"></a>Правила синхронизации

Сопоставление таблиц интеграции также включает в себя правила, управляющие тем, как задания синхронизации интеграции синхронизируют записи в таблице [!INCLUDE[prod_short](includes/prod_short.md)] и таблице в [!INCLUDE[prod_short](includes/cds_long_md.md)]. Примеры правил интеграции с Sales см. в разделе [Правила синхронизации](#synchronization-rules).

### <a name="strategies-for-auto-resolving-conflicts"></a>Стратегии автоматического разрешения конфликтов

Конфликты данных могут легко возникнуть, когда бизнес-приложения обмениваются данными на постоянной основе. Например, кто-то может удалить или изменить строку в одном из приложений или в обоих. Чтобы уменьшить количество конфликтов, которые вам придется разрешать вручную, вы можете указать стратегии разрешения, и [!INCLUDE[prod_short](includes/prod_short.md)] автоматически будет разрешать конфликты в соответствии с правилами в стратегиях.

Сопоставления таблиц интеграции включают правила, управляющие тем, как задания синхронизации синхронизируют записи. На странице **Сопоставление таблиц интеграции** в столбцах **Разрешение конфликтов удаления** и **Разрешение конфликтов обновления** вы можете указать, как [!INCLUDE[prod_short](includes/prod_short.md)] разрешает конфликты, возникающие из-за удаления записей в таблицах в одном или другом бизнес-приложении или обновления в обоих. 

В столбце **Разрешение конфликтов удаления** вы можете выбрать, чтобы [!INCLUDE[prod_short](includes/prod_short.md)] автоматически восстанавливал удаленные записи, удалял связи между записями или ничего не делал. Если вы ничего не сделаете, вы должны вручную разрешить конфликты. 

В столбце **Разрешение конфликтов обновления** вы можете выбрать, чтобы [!INCLUDE[prod_short](includes/prod_short.md)] автоматически отправлял обновление данных в таблицу интеграции при отправке данных в [!INCLUDE[prod_short](includes/cds_long_md.md)], получал обновление данных из таблицы интеграции при получении данных из [!INCLUDE[prod_short](includes/cds_long_md.md)] или ничего не делал. Если вы ничего не сделаете, вы должны вручную разрешить конфликты.

После того, как вы укажете стратегию, на странице **Ошибки синхронизации связанных данных**, вы можете выбрать действие **Повторить все** для автоматического разрешения конфликтов.

## <a name="mapping-integration-fields"></a>Сопоставление полей интеграции

Составление таблиц — это только первый шаг. Вы также должны сопоставить поля в таблицах. Сопоставления полей интеграции связывают поля в таблицах [!INCLUDE[prod_short](includes/prod_short.md)] с соответствующими столбцам в [!INCLUDE[prod_short](includes/cds_long_md.md)] и определяют, нужно ли синхронизировать данные в каждой таблице. Стандартное сопоставление таблиц, которое предоставляет [!INCLUDE[prod_short](includes/prod_short.md)], включает сопоставления полей, но вы можете изменить их. Дополнительные сведения см. в разделе [Просмотр сопоставлений таблиц](admin-synchronizing-business-central-and-sales.md#tip-for-admins-viewing-table-mappings).

> [!Note]
> Если вы используете локальную версию [!INCLUDE[prod_short](includes/prod_short.md)], сопоставления полей интеграции определены в таблице 5336 Сопоставление полей интеграции.

Вы можете вручную сопоставить поля или автоматизировать процесс, сопоставив несколько полей одновременно на основе критериев сопоставления их значений. Для получения дополнительной информации см. [Чтобы связать несколько записей на основе сопоставления значений поля](admin-how-to-couple-and-synchronize-records-manually.md).

### <a name="handle-differences-in-field-values"></a>Обработка различий в значениях полей

Иногда значения в полях, которые, вы хотите сопоставить, различаются. Например, в [!INCLUDE[crm_md](includes/crm_md.md)] код языка для США — "U.S.", а в [!INCLUDE[prod_short](includes/prod_short.md)] — "US". Это означает, что вы должны преобразовать значение при синхронизации данными. Это происходит через правила преобразования, которые вы определяете для полей. Вы определяете правила преобразования на странице **Сопоставления таблиц интеграции**, выбрав **Сопоставление**, затем **Поля**. Доступные готовые правила, но вы также можете создавать свои собственные. Для получения дополнительной информации см. [Правила преобразования](across-how-to-set-up-data-exchange-definitions.md#transformation-rules).

### <a name="handle-missing-option-values"></a>Обработка отсутствия значений параметров

[!INCLUDE[prod_short](includes/cds_long_md.md)] содержит столбцы набора параметров, предоставляющие значения параметров, которые можно сопоставить полям [!INCLUDE[prod_short](includes/prod_short.md)] типа **Параметр** для автоматической синхронизации. Во время синхронизации несопоставленные параметры игнорируются, а отсутствующие параметры добавляются к связанной таблице [!INCLUDE[prod_short](includes/prod_short.md)] и добавляются в системную таблицу **Сопоставление параметров CDS** для обработки вручную позже. Например, добавив отсутствующие параметры в любом продукте, а затем обновив сопоставление. Дополнительные сведения см. в разделе [Обработка отсутствующих значений параметров](admin-cds-missing-option-values.md).

## <a name="couple-records"></a>Связывание записей

Связывание сопоставляет строки в [!INCLUDE[prod_short](includes/cds_long_md.md)] с записями в [!INCLUDE[prod_short](includes/prod_short.md)]. Например, счета в [!INCLUDE[prod_short](includes/cds_long_md.md)] обычно связываются с клиентами в [!INCLUDE[prod_short](includes/prod_short.md)]. Связывание записей дает следующие преимущества:

* Оно делает возможной синхронизацию.
* Пользователи могут открывать записи или строки в одном бизнес-приложении из другого. Это требует, чтобы приложения уже были интегрированы.

Связывания могут быть настроены автоматически с помощью заданий синхронизации или вручную путем изменения записи в [!INCLUDE[prod_short](includes/prod_short.md)]. Для получения дополнительной информации см. [Синхронизация данных в [!INCLUDE[prod_short](includes/prod_short.md)] и [!INCLUDE[prod_short](includes/cds_long_md.md)]](admin-synchronizing-business-central-and-sales.md) и [Связывание и синхронизация записей вручную](admin-manual-synchronization-of-table-mappings.md#synchronize-individual-table-mappings).

## <a name="filter-records-and-rows"></a>Фильтрация записей и строк

Если вы не хотите синхронизировать все строки для конкретной таблицы в [!INCLUDE[prod_short](includes/cds_long_md.md)] или таблицы в [!INCLUDE[prod_short](includes/prod_short.md)], можно настроить фильтры для ограничения синхронизируемых данных. Можно установить фильтры на странице **Сопоставления таблиц интеграции**.  

1. Выберите значок ![Лампочка, которая открывает функцию «Что вы хотите сделать»](media/ui-search/search_small.png "Что вы хотите сделать"), значок, введите **Сопоставления таблиц интеграции**, а затем выберите связанную ссылку.
2. Для фильтрации записей [!INCLUDE[prod_short](includes/prod_short.md)] задайте значение в поле **Фильтр таблицы**.  
3. Для фильтрации строк [!INCLUDE[prod_short](includes/cds_long_md.md)] задайте значение в поле **Фильтр таблицы интеграции**.  

## <a name="create-new-records"></a>Создание новых записей

По умолчанию задания синхронизации интеграции выполнят синхронизацию только связанных записей в [!INCLUDE[prod_short](includes/prod_short.md)] и строк в [!INCLUDE[prod_short](includes/cds_long_md.md)]. Можно настроить сопоставления таблицы, чтобы новые записи или строки были созданы в назначении (например, [!INCLUDE[prod_short](includes/prod_short.md)]) для каждой строки в источнике (например, [!INCLUDE[prod_short](includes/cds_long_md.md)]), которая уже не связана.  

Например, задание синхронизации "ПРОДАВЦЫ — Dynamics 365 Sales" использует сопоставление таблицы ПРОДАВЦЫ. Задание синхронизации копирует данные из пользователей в [!INCLUDE[prod_short](includes/cds_long_md.md)] в продавцов в [!INCLUDE[prod_short](includes/prod_short.md)]. Если сопоставление таблицы настроено для создания записей, для каждого пользователя в [!INCLUDE[prod_short](includes/cds_long_md.md)], который еще не связан с продавцом в [!INCLUDE[prod_short](includes/prod_short.md)], в [!INCLUDE[prod_short](includes/prod_short.md)] создается новая строка продавца.  

### <a name="to-create-new-records-during-synchronization"></a>Создание записей во время синхронизации

1. Выберите ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **Сопоставления таблиц интеграции**, а затем выберите связанную ссылку.
2. В операции сопоставления таблицы в списке удалите значение в поле **Синхр. только связанные записи**.  

## <a name="use-configuration-templates-on-table-mappings"></a>Использование шаблонов конфигурации для сопоставлений таблицы

Шаблоны конфигурации можно назначить для сопоставлений таблицы, чтобы они использовали новые записи или строки, созданные в [!INCLUDE[prod_short](includes/prod_short.md)] или [!INCLUDE[prod_short](includes/cds_long_md.md)]. Для каждого сопоставления таблицы можно задать шаблон конфигурации, чтобы он использовался для новых записей [!INCLUDE[prod_short](includes/prod_short.md)], и другой шаблон, который должен использовать новые строки [!INCLUDE[prod_short](includes/cds_long_md.md)].  

При установке настройки синхронизации по умолчанию, в большинстве случаев буду автоматически созданы два шаблона конфигурации и применены для сопоставления таблицы для клиентов [!INCLUDE[prod_short](includes/prod_short.md)] и организаций [!INCLUDE[crm_md](includes/crm_md.md)]: **CDSCUST** и **CDSACCOUNT**.  

* **CDSCUST** создает и синхронизирует новых клиентов в [!INCLUDE[prod_short](includes/prod_short.md)] на основе учетных записей в [!INCLUDE[crm_md](includes/crm_md.md)].  

     Вы можете создать этот шаблон, скопировав существующий шаблон конфигурации для клиентов. **CDSCUST** создается только в том случае, если имеется существующий шаблон конфигурации, а поле **Код валюты** в шаблоне пустое. Если в поле шаблона конфигурации содержится значение, это значение будет использоваться вместо значения в сопоставленном столбце для организации [!INCLUDE[prod_short](includes/cds_long_md.md)]. Например, если в столбце **Страна/регион** в организации в [!INCLUDE[prod_short](includes/cds_long_md.md)] указано *U.S.*, а в поле **Страна/регион** в шаблоне конфигурации указано **GB**, используется **GB** в качестве **Страна/регион** в созданном клиенте в [!INCLUDE[prod_short](includes/prod_short.md)].  

* **CDSACCOUNT** создает и синхронизирует новую организацию в [!INCLUDE[prod_short](includes/cds_long_md.md)] на основе организации в [!INCLUDE[prod_short](includes/prod_short.md)].  

### <a name="to-specify-configuration-templates-on-a-table-mapping"></a>Указание шаблонов конфигурации для сопоставления таблицы

1. Выберите ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") значок, введите **Сопоставления таблиц интеграции**, а затем выберите связанную ссылку.
2. В операции сопоставления таблицы в списке в поле **Код шаблона конфигурации таблиц** выберите шаблон конфигурации для использования для новых записей в [!INCLUDE[prod_short](includes/prod_short.md)].  
3. Задайте в поле **Код шаблона конфигурации внутр. табл.** шаблон конфигурации для использования для новых записей в [!INCLUDE[prod_short](includes/cds_long_md.md)].

## <a name="see-also"></a>См. также

[Об интеграции Dynamics 365 Business Central с [!INCLUDE[prod_short](includes/cds_long_md.md)]](admin-prepare-dynamics-365-for-sales-for-integration.md )  
[Синхронизация Business Central и [!INCLUDE[prod_short](includes/cds_long_md.md)]](admin-synchronizing-business-central-and-sales.md)  
[Синхронизация по расписанию](admin-scheduled-synchronization-using-the-synchronization-job-queue-entries.md)  

[!INCLUDE[footer-include](includes/footer-banner.md)]
