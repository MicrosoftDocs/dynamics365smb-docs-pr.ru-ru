---
title: Обновление курсов валют (содержит видео)
description: 'Узнайте, как использовать Business Central для корректировки валютных курсов для сумм в разных валютах.'
author: brentholtorf
ms.author: bholtorf
ms.reviewer: bnielse
ms.topic: conceptual
ms.search.keywords: 'multiple currencies, adjust exchange rates, FX rates'
ms.search.form: '5, 118'
ms.date: 11/13/2023
ms.custom: bap-template
---
# Обновление валютных курсов

Если вы работаете с разными валютами, вам необходимо отслеживать изменения курсов валют. [!INCLUDE [prod_short](includes/prod_short.md)] позволяет управлять валютными курсами и обновлять их вручную или автоматически, а также настроить службу валютных курсов.

## Валюты

> [!TIP]  
> В [!INCLUDE[prod_short](includes/prod_short.md)] для получения информации об обменных курсах в реальном времени или исторических курсах необходимо обратиться к функциональности валют. Дополнительные сведения см. в разделе [Настройка дополнительной отчетной валюты](finance-how-setup-additional-currencies.md).

[!INCLUDE [finance-currencies-def](includes/finance-currencies-def.md)]

Вы можете указывать коды валют в списке **Валюты**, включая дополнительную информацию и параметры, необходимые для каждого кода валюты. Дополнительные сведения см. в разделе [Валюты](finance-set-up-currencies.md#curr)

### Пример транзакции с валютой дебиторской задолженности

[!INCLUDE [finance-currencies-example](includes/finance-currencies-example.md)]

## Валютные курсы

Обменные курсы — это инструмент для расчета стоимости каждой валютной операции в местной валюте (МВ). На странице **Валютные курсы** содержатся следующие поля:

|Поле|Описанием|  
|---------------------------------|---------------------------------------|  
|**Дата начала**|Дата вступления в силу курса валюты.|  
|**Код Валюты**|Код валюты, связанный с этим валютным курсом.|  
|**Связанный код валюты**|Если эта валюта входит в расчет валютной триангуляции, вы можете указать здесь код связанной валюты.|  
|**Курс валюты**|Эта сумма представляет собой сумму в валюте, код которой выбран в строке. Обычно она равна 1 или 100.|  
|**Связанный курс валюты - сумма**|Сумма в связанной валюте используется для вычисления курса, используемого для кода связанной валюты.|  
|**Корр. курс валюты**|Курс для кода валюты, выбранного в строке для использования пакетного задания **Коррекция валютных курсов**.|  
|**Связанный корр. курс валюты — сумма**|Курс для кода валюты, выбранного в строке для использования пакетного задания **Коррекция валютных курсов**.|  
|**Фикс. курс валюты**|Указывает, можно ли изменять валютный курс в счетах и строках журнала.|  

В целом значения полей **Сумма валютного курса** и **Связанный курс валюты - сумма** используются в качестве курса валюты по умолчанию для всех новых документов дебиторской и кредиторской задолженности, которые создаются в будущем. Документу присваивается курс валюты в соответствии с текущей рабочей датой.  

> [!Note]
> Собственно курс валюты рассчитывается по следующей формуле:
>
> `Currency Amount = Amount / Exchange Rate Amount * Relational Exch. Rate Amount`

Сумма в валюте корректировочного курса или сумма в относительной валюте корректировочного курса будет использоваться для обновления всех открытых банковских транзакций, а также транзакций расчетов с поставщиками или клиентами.  

> [!Note]
> Собственно курс валюты рассчитывается по следующей формуле:
>
> `Currency Amount = Amount / Adjustment Exch. Rate Amount * Relational Adjmt Exch. Rate Amt`

## Коррекция валютных курсов

В связи с постоянным колебанием курсов валют возникает необходимость в периодической корректировке эквивалентов в других валютах. Если вы этого не делать, суммы, которые вы конвертировали из иностранных (или других) валют и учли в главной книге в местной валюте, могут быть неверными. Кроме того, необходимо обновлять ежедневные операции, учтенные до момента ввода обменного курса на день.

Для корректировки вручную курсов валют в учтенных операциях по клиентам, поставщикам и банковским счетам можно использовать пакетное задание **Коррекция валютных курсов**. Это пакетное задание также обновляет суммы в других отчетных валютах в операциях ГК.  

> [!TIP]
> Вы можете воспользоваться службой для автоматического обновления курсов валют в системе. Дополнительные сведения см. в разделе [Настройка служб валютных курсов](finance-how-update-currencies.md#set-up-a-currency-exchange-rate-service). Однако это не приводит к корректировке обменных курсов в уже учтенных транзакциях. Чтобы обновить обменные курсы в опубликованных записях, используйте пакетное задание **Корректировка валютных курсов**.

Вы также можете указать, как при корректировке должны обрабатываться измерения для учтенных нереализованных прибылей и убытков, выбрав один из следующих вариантов в поле **Учет измерений**:  

* **Измерения операции-источника**: переносить значения измерений для операций ГК по нереализованным прибылям и убыткам из корректируемой операции.  
* **Без измерений**: не переносить значения измерений для нереализованных прибылей и убытков в операции ГК. [!INCLUDE [prod_short](includes/prod_short.md)] все равно будет использовать параметры измерений по умолчанию, например **Код обязателен**, **Единый код** или **Нет кода**. Если исходные операции транзакций имеют значения измерений, при корректировке создаются операции без значений измерений.  
* **Измерения счета ГК**: переносить значения измерений из параметров измерений исходной операции по счета ГК нереализованных прибылей и убытков в операции ГК.

> [!NOTE]
> Чтобы использовать возможность предварительного просмотра, необходимо включить **Обновление функции: включение использования новой расширяемой коррекции валютных курсов, включая проверку учета** на странице **[Управление функциями](https://businesscentral.dynamics.com/?page=2610)**.

> [!IMPORTANT]
> В связи с местными требованиями, существующими в Швейцарии, мы не рекомендуем включать **Обновление функции: включение использования новой расширяемой коррекции валютных курсов, включая проверку учета** в версии для Швейцарии (CH).

## Предварительный просмотр результатов корректировки

Вы можете предварительно просмотреть эффект, который корректировка валютных курсов окажет на результаты учета, прежде чем учитывать операции. Для этого выберите действие **Предварительный просмотр учета** на странице запроса отчета **Коррекция валютных курсов** (отчет 596). На странице запроса вы можете указать, что должно быть включено в предварительный просмотр:

* Детальные результаты учета в главной книге по операциям.
* Сводные результаты учета по валютам. Просто установите флажок **Корректировать по операции** в отчете **Коррекция валютных курсов**.

### Влияние на клиентов и поставщиков

Для корректировки валюты по счетам клиентов и поставщиков пакетное задание использует валютный курс, который был действителен на дату учета, указанную для пакетного задания. Пакетное задание рассчитывает разницу для отдельных валютных балансов и отражает суммы на счету ГК, указанном в поле **Счет нереализованной прибыли** или в поле **Счет нереализованных убытков** на странице **Валюты**. Балансирующие операции автоматически учитываются на счетах клиентов/поставщиков в главной книге.

Пакетное задание обрабатывает все открытые операции книги клиентов и поставщиков. В случае наличия курсовой разницы для операции пакетное задание создает новую детальную операцию книги клиентов или поставщиков. Новая операция отражает скорректированную сумму в операции книги клиентов или поставщиков.

#### Измерения в операциях клиентов или поставщиков

[!INCLUDE [prod_short](includes/prod_short.md)] назначает измерения из операций книги клиентов или поставщиков корректировочным операциям и учитывает корректировки для каждой комбинации значений измерений.

### Влияние на банковские счета

Для банковских счетов пакетное задание корректирует курсовую разницу, используя обменный курс на дату учета, указанную в пакетном задании. Пакетное задание рассчитывает разницу для каждого банковского счета, имеющего код валюты, и отражает суммы на счету ГК, указанном в поле **Счет реализованной прибыли** или поле **Счет реализованных убытков** на странице **Валюты**. Балансирующие операции автоматически учитываются на банковских счетах Главной книги, указанных в учетных группах банковских счетов. Пакетное задание рассчитывает одну операцию на валюту для каждой группы счетов.

#### Измерения в операциях банковских счетов

Корректирующим операциям для счета ГК банковского счета и для счета прибылей/убытков присваиваются стандартные измерения банковского счета.

### Влияние на счета ГК

Если учет ведется в другой отчетной валюте, пакетное задание может создать новые операции ГК для коррекции курсов между местной валютой и другой отчетной валютой. Пакетное задание вычисляет разницы для каждой операции главной книги. Затем оно корректирует их в зависимости от содержимого поля **Коррекция валютного курса** для каждого счета ГК.

#### Измерения в операциях счетов ГК

Корректирующим операциям присваиваются стандартные измерения из счетов, на которых они учитываются.

> [!Important]
> Перед использованием этого пакетного задания необходимо ввести корректировочные валютные курсы, которые будут использоваться для коррекции сальдо в иностранных валютах. Это делается на странице **Валютные курсы**.<br><br>  

> [!Video https://www.microsoft.com/videoplayer/embed/RE3Q24s?rel=0]

## Настройка службы валютных курсов

Для обновления валютных курсов можно использовать внешнюю службу, например FloatRates. 

> [!NOTE]
> Большинство служб валютных курсов предоставляют данные, совместимые с процессом импорта в [!INCLUDE[prod_short](includes/prod_short.md)]. Однако иногда данные форматируются по-другому, и вам нужно будет настроить процесс импорта. Для этого вы можете использовать платформу обмена данными, добавив свой собственный codeunit. Для этого вам, вероятно, понадобится помощь разработчика. Дополнительные сведения см. в разделе [Настройка определений обмена данными](across-how-to-set-up-data-exchange-definitions.md).

1. Выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать"), введите **Службы валютных курсов**, а затем выберите соответствующую ссылку.
2. Выберите действие **Создать**.
3. На странице **Служба валютных курсов** заполните требуемые поля. [!INCLUDE[tooltip-inline-tip](includes/tooltip-inline-tip_md.md)]
4. Чтобы включить службу включите переключатель **Включено**.

> [!NOTE]
> В следующем видео показан пример подключения к службе валютных курсов на примере Европейского центрального банка. В сегменте, который описывает, как настроить сопоставления полей, значение в столбце **Источник** напротив **Родительский узел кода валюты** вернет только первую найденную валюту. Настройка должна быть `/gesmes:Envelope/Code/Code/Code`.

<br><br>  
  
> [!Video https://www.microsoft.com/en-us/videoplayer/embed/RE4A1jy?rel=0]

## Обновление валютных курсов с использованием службы

Выполните следующие действия, чтобы обновить валютные курсы через службу:

1. Выберите значок ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать"), введите **Валюты**, а затем выберите соответствующую ссылку.
2. Выберите действие **Обновить валютные курсы**.

## Исправление ошибок

Время от времени вам может потребоваться исправить ошибку в платежной транзакции, связанную с корректировками прибылей и убытков в связи с конвертацией валют. Вы можете использовать действие **Сторнировать транзакцию** на страницах **Книга операций по банку**, **Книга операций по клиентам** и **Книга операций по поставщикам** для отмены применения и сторнирования платежной транзакции.

> [!NOTE]
> При отмене применения и сторнировании платежа для операции, с которой были связаны коррекции курса валют, при сторнировании учитываются операции сторнирования для корректировок. Возможно, вам придется снова запустить коррекцию курса валют, чтобы получить правильное текущее сальдо.

## См. также

## См. также

[Валюты в Business Central](finance-currencies.md)  
[Настройка валют](finance-set-up-currencies.md)  
[Настройка дополнительной отчетной валюты](finance-how-setup-additional-currencies.md)  
[Закрытие года и периодов](year-close-years-periods.md)  
[Работа с [!INCLUDE[prod_short](includes/prod_short.md)]](ui-work-product.md)

[!INCLUDE[footer-include](includes/footer-banner.md)]
