---
title: Работа с макетами Excel
description: Узнайте, как создавать и изменять макеты отчетов, созданные с помощью Excel.
author: jswymer
ms.topic: conceptual
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: customized report, document layout, logo, personalize
ms.search.form: 9650, 9652
ms.date: 03/14/2022
ms.author: jswymer
ms.openlocfilehash: 609678742ccf9593407e96ea412a377f37c8abf9
ms.sourcegitcommit: 8a12074b170a14d98ab7ffdad77d66aed64e5783
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2022
ms.locfileid: "8525227"
---
# <a name="working-with-excel-layouts"></a>Работа с макетами Excel

Макеты отчетов Excel основаны на книгах Microsoft Excel (файлы XLSX). Они позволяют создавать отчеты с использованием знакомых функций Excel для обобщения, анализа и представления данных, таких как формулы, сводные таблицы и сводные диаграммы.

![Показывает пример макета Excel.](media/excel-layout-2.png)

В этой статье объясняются некоторые из наиболее важных вещей, которые вам нужно знать, чтобы начать работу с макетами Excel.

## <a name="why-use-excel-layouts"></a>Зачем использовать макеты Excel?

Вот еще несколько преимуществ использования макетов Excel:

- Создавайте интерактивные отчеты с помощью визуализаций, таких как срезы
- Просматривайте необработанные данные из набора данных отчета, чтобы понять, как работает отчет и откуда берутся данные о визуальных элементах
- Используйте встроенные функции Office для постобработки подготовленных отчетов, например:
  - [Защита листов](https://support.microsoft.com/en-us/office/protect-a-worksheet-3179efdb-1285-4d49-a9c3-f4ca36276de6)
  - [Применение меток конфиденциальности](https://support.microsoft.com/en-us/office/apply-sensitivity-labels-to-your-files-and-email-in-office-2f96e7cd-d5a4-403b-8bd7-4cc636bae0f9)
  - [Добавление комментариев и заметок](https://support.microsoft.com/en-us/office/insert-comments-and-notes-in-excel-65f504d8-160b-4a05-ac30-46fbd5227a52)
  - [Прогнозирование и анализ](https://support.microsoft.com/en-us/office/introduction-to-what-if-analysis-22bffa5f-e891-4acc-bf7a-e4645c446fb4) 
- Используйте установленные надстройки и интеграции приложений, например потоки Power Automate или OneDrive.

## <a name="get-started"></a>Начало работы

В основном есть две задачи, связанные с настройкой макета Excel для отчета:

1. Создайте новый файл макета Excel.
2. Добавьте новый макет в отчет.

## <a name="task-1-create-the-excel-layout-file"></a>Задача 1. Создайте новый файл макета Excel

Существует три способа создания файла макета Excel для отчета, как описано в этом разделе

### <a name="from-any-report"></a>[Из любого отчета](#tab/any-report)

Вы можете использовать следующие шаги для создания макета Excel из любого отчета, независимо от текущего типа макета. Макет Excel будет содержать необходимый лист **Данные** и таблицу, лист **Метаданные отчета** и ничего больше.

[!INCLUDE[open-report-layouts-page](includes/open-report-layouts-page.md)]
2. В списке **Макеты отчетов** выберите любой макет для отчета, затем выберите действие **Выполнить отчет**.
3. На странице запроса отчета выберите **Отправить** > **Microsoft Excel Документ (только данные)** > **ОК**.

   На этом шаге загружается книга Excel, содержащая набор данных отчета.
4. Откройте загруженный файл в Excel, внесите изменения, затем сохраните файл.

### <a name="from-another-excel-layout-on-a-report"></a>[Из другого макета Excel в отчете](#tab/other-layout)

Если для отчета уже существует макет Excel, вы используете существующий макет в качестве отправной точки. Есть два подхода к получению копии макета. Вы можете экспортировать существующий макет со страницы **Макеты отчетов** или загрузить макет со страницы запроса отчета. Оба способа загружают файл макета Excel, который включает все листы существующего файла. Разница в том, что со страницы запроса макет будет включать фактические данные. Данные не требуются, но они помогают при разработке макета.

#### <a name="approach-1-export-the-layout-from-the-report-layouts-page"></a>Подход 1. Экспорт макета на странице **Макеты отчетов**

[!INCLUDE[open-report-layouts-page](includes/open-report-layouts-page.md)]
2. Выберите макет Excel из списка, затем выберите действие **Экспорт макета** в верхней части страницы.
3. Откройте файл в Excel, внесите изменения, затем сохраните файл.

#### <a name="approach-2-download-the-layout-from-the-reports-request-page"></a>Подход 2. Загрузите макет со страницы запроса отчета

[!INCLUDE[open-report-layouts-page](includes/open-report-layouts-page.md)]
2. В списке **Макеты отчетов** выберите любой макет для отчета, затем выберите действие **Выполнить отчет**.
3. На странице запроса отчета выберите **Загрузить**.
4. Откройте файл в Excel, внесите изменения, затем сохраните файл.

### <a name="from-al-code"></a>[Из кода AL](#tab/from-code)

Этот способ самый продвинутый. Для этого требуется знание кода AL, поэтому он нацелен на программистов. В этом случае макеты Excel являются частью пакета расширения, который вы устанавливаете. Дополнительные сведения см. в [Создание отчета макета Excel](/dynamics365/business-central/dev-itpro/developer/devenv-howto-excel-report-layout) в справке для разработчиков и ИТ-специалистов.

---

## <a name="task-2-add-the-excel-layout-to-the-report"></a>Задача 2. Добавьте макет Excel в отчет

Когда у вас есть файл макета Excel, следующая задача — добавить его в качестве нового макета для отчета.

[!INCLUDE[open-report-layouts-page](includes/open-report-layouts-page.md)]
2. Выберите **Создать макет**.
3. Задайте **Идентификатор отчета** для отчета.
4. Введите название в **Имя макета**.
5. Задайте **Параметры формата** как **Excel**.
6. Выберите **ОК** > **Выбрать**, чтобы открыть проводник на вашем устройстве. 
7. Найдите и выберите файл Excel, затем выберите **Открыть**.

   Выбранный файл загружается в макет, и вы возвращаетесь на страницу **Макеты отчетов**.
8. Если вы хотите увидеть, как отчет выглядит с новым макетом, выберите макет в списке, затем выберите **Выполнить отчет**.


<!--

**Data** sheet
  - An Excel layout must contain a sheet named **Data**.
  - The **Data** sheet can only include one table named **Data**.

**Data** table
  - The **Data** sheet must include a table that has the name **Data**.
  - The table must have at least one column and can only include columns that are also in report dataset.
  - The table must start in the first cell A1 of the **Data** sheet.

3. Report Metadata 
-->

## <a name="understanding-excel-layouts"></a>Сведения о макетах Excel

Есть несколько вещей, которые вы должны знать или учитывать, когда начинаете создавать или вносить изменения в макеты Excel. Каждый макет Excel должен включать два элемента: лист **Данные** и таблица **Данные**. Эти элементы составляют основу макета, определяя бизнес-данные из Business Central, с которыми вы можете работать. Вы можете думать о листе **Данные** как о своего рода контракте между макетом в бизнес-данных. Вы будете использовать эти данные в качестве источника расчетов и визуализаций, которые вы хотите представить на других листах.

К структуре книги Excel предъявляются определенные требования. Если требования не соблюдены, у вас возникнут проблемы с использованием макета. На следующей диаграмме и в таблице показаны элементы макета Excel и требования.

[![Показывает разные элементы макета Excel.](media/excel-layout-callouts-2.png)](media/excel-layout-callouts-2.png#lightbox)

|Кол-во|Элемент|Описание|Обязательно|
|---|-------|----|---|
|1|Лист **Данные**|<ul><li>Должно быть имя **Данные**</li><li>Может включать только одну таблицу, и таблица должна быть названа **Данные**</li></ul>|![Обязательно](media/check.png) | 
|2|Таблица **Данные**|<ul><li>Должно быть имя **Данные**</li><li>Должен иметь хотя бы один столбец.</li><li>Может включать только столбцы из набора данных отчета.</li><li>Должен начинаться в первой ячейке **А1** листа **Данные**</li></ul>|![Обязательно](media/check.png)|
|3|Листы презентации|<ul><li>Используется для представления данных.</li><li>Данные поступают с листа **Данные**. </li></ul>||
|4|Лист **Метаданные отчета**|<ul><li>Автоматически включается, если макет был создан путем экспорта другого отчета в формате Excel</li><li>Содержит общую информацию об отчете</li><li>Можно удалить</li></ul>|

Подводя итог, что вы можете и не можете делать на листе **Данные**:

- Не меняйте имя листа **Данные**, таблицы **Данные** и столбцов.
- Вы можете удалить или скрыть столбцы.
- Не добавляйте столбцы, если они не включены в набор данных отчета.
- Листы можно размещать в любом порядке. Например, лист **Данные** может быть первым или последним.

## <a name="see-related-training-at-microsoft-learn"></a>См. соответствующее обучение на странице [Microsoft Learn](/learn/modules/change-documents-dynamics-365-business-central/index)

## <a name="see-also"></a>См. также

[Управление макетами отчетов](ui-manage-report-layouts.md)  
[Смена текущего макета отчета](ui-how-change-layout-currently-used-report.md)  
[Импорт и экспорт пользовательского макета отчета или документа](ui-how-import-and-export-report-layout.md)  
[Работа с отчетами, пакетными заданиями и XMLport](ui-work-report.md)  
[Подготовка финансовой отчетности с помощью финансовых отчетов и категорий счетов](bi-how-work-account-schedule.md) 
[Бизнес-аналитика](bi.md)  
[Работа с [!INCLUDE[prod_short](includes/prod_short.md)]](ui-work-product.md)  
[Анализ данных отчета с помощью Excel](report-analyze-excel.md).


[!INCLUDE[footer-include](includes/footer-banner.md)]