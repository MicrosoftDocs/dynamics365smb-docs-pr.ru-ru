---
title: Работа с макетами Excel
description: 'Узнайте, как создавать и изменять макеты отчетов, созданные с помощью Excel.'
author: jswymer
ms.topic: conceptual
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: 'customized report, document layout, logo, personalize'
ms.search.form: '9650, 9652'
ms.date: 11/10/2022
ms.author: jswymer
---
# <a name="working-with-microsoft-excel-layouts"></a>Работа с макетами Microsoft Excel

Макеты отчетов Microsoft Excel основаны на книгах Excel (файлы XLSX). С ними можно создавать отчеты, которые включают знакомые функции Excel для обобщения, анализа и представления данных, такие как формулы, сводные таблицы и сводные диаграммы.

![Показывает пример макета Excel.](media/excel-layout-2.png)

В этой статье объясняются некоторые важные вещи, которые вам нужно знать, чтобы начать работу с макетами Excel.

## <a name="why-use-excel-layouts"></a>Зачем использовать макеты Excel?

Преимущества использования макетов Excel:

- Создавайте интерактивные отчеты с помощью визуализаций, таких как срезы.
- Просматривайте необработанные данные из набора данных отчета, что помогает понять, как работает отчет и откуда берутся данные о визуальных элементах.
- Используйте встроенные функции Microsoft Office для постобработки подготовленных отчетов, включая:
  - [Защита листов](https://support.microsoft.com/office/protect-a-worksheet-3179efdb-1285-4d49-a9c3-f4ca36276de6)
  - [Применение меток конфиденциальности](https://support.microsoft.com/office/apply-sensitivity-labels-to-your-files-and-email-in-office-2f96e7cd-d5a4-403b-8bd7-4cc636bae0f9)
  - [Добавление комментариев и заметок](https://support.microsoft.com/office/insert-comments-and-notes-in-excel-65f504d8-160b-4a05-ac30-46fbd5227a52)
  - [Прогнозирование и анализ](https://support.microsoft.com/office/introduction-to-what-if-analysis-22bffa5f-e891-4acc-bf7a-e4645c446fb4)
- Используйте установленные надстройки и интеграции приложений, таких как потоки Power Automate или OneDrive.

## <a name="get-started"></a>Начать

В основном есть две задачи, связанные с настройкой макета Excel отчета:

1. Создайте новый файл макета Excel.
2. Добавьте новый макет в отчет.

## <a name="task-1-create-the-excel-layout-file"></a>Задача 1. Создайте новый файл макета Excel

Ниже приведены три способа создания файла макета Excel для отчета.

### [Из любого отчета](#tab/any-report)

Выполните следующие шаги для создания макета Excel из любого отчета, независимо от текущего типа макета. Макет Excel будет содержать необходимый лист **Данные** и таблицу, лист **Метаданные отчета** и ничего больше.

[!INCLUDE[open-report-layouts-page](includes/open-report-layouts-page.md)]
2. На странице **Макеты отчетов** выберите любой макет для отчета, затем выберите действие **Выполнить отчет**.
3. На странице запроса отчета выберите **Отправить** > **Microsoft Excel Документ (только данные)** > **ОК**.

   На этом шаге загружается книга Excel, содержащая набор данных отчета.
4. Откройте загруженный файл в Excel, внесите изменения, затем сохраните файл.

### [Из другого макета отчета Excel](#tab/other-layout)

Если для отчета уже существует макет Excel, вы можете использовать существующий макет в качестве отправной точки. Есть два подхода к получению копии макета. Вы можете экспортировать существующий макет со страницы **Макеты отчетов** или загрузить макет со страницы запроса отчета. Оба способа загружают файл макета Excel, который включает все листы существующего файла. Разница в том, что когда вы загружаете его со страницы запроса, макет включает фактические данные. (Эти данные не обязательны, но они помогают при разработке макета.)

#### <a name="approach-1-export-the-layout-from-the-report-layouts-page"></a>Подход 1. Экспорт макета на странице **Макеты отчетов**

[!INCLUDE[open-report-layouts-page](includes/open-report-layouts-page.md)]
2. Выберите макет Excel из списка, затем выберите действие **Экспорт макета** в верхней части страницы.
3. Откройте файл в Excel, внесите изменения, затем сохраните файл.

#### <a name="approach-2-download-the-layout-from-the-reports-request-page"></a>Подход 2. Загрузите макет со страницы запроса отчета

[!INCLUDE[open-report-layouts-page](includes/open-report-layouts-page.md)]
2. На странице **Макеты отчетов** выберите любой макет для отчета, затем выберите действие **Выполнить отчет**.
3. На странице запроса отчета выберите **Загрузить**.
4. Откройте файл в Excel, внесите изменения, затем сохраните файл.

### [Из кода AL](#tab/from-code)

Это самый продвинутый метод создания макета отчета Excel. Поскольку для этого требуется знание кода AL, он нацелен на программистов. При таком подходе макеты Excel являются частью пакета расширения, который вы устанавливаете. Подробнее см. в разделе [Создание отчета макета Excel](/dynamics365/business-central/dev-itpro/developer/devenv-howto-excel-report-layout) в справке для разработчиков и ИТ-специалистов.

---

## <a name="task-2-add-the-excel-layout-to-the-report"></a>Задача 2. Добавьте макет Excel в отчет

Когда у вас есть файл макета Excel, следующая задача — добавить его в качестве нового макета для отчета.

[!INCLUDE[open-report-layouts-page](includes/open-report-layouts-page.md)]
2. Выберите **Создать макет**.
3. Задайте **Идентификатор отчета** на *Отчет*.
4. Введите название в поле **Имя макета**.
5. Задайте **Параметры формата** как **Excel**.
6. Нажмите **ОК**, а затем выполните одно из следующих действий, чтобы загрузить файл макета для отчета:

   [!INCLUDE[file-upload](includes/file-upload.md)]

   Выбранный файл загружается в макет, и открывается страница **Макеты отчетов**.
8. Чтобы посмотреть, как отчет выглядит с новым макетом, выберите макет в списке, затем выберите **Выполнить отчет**.

<!--

**Data** sheet
  - An Excel layout must contain a sheet named **Data**.
  - The **Data** sheet must include a table named **Data**.

**Data** table
  - The **Data** sheet must include a table named **Data**.
  - The table must have at least one column and can only include columns that are also in the report dataset.
  - The table must start in the first cell **A1** of the **Data** sheet.

3. Report metadata 
-->

## <a name="understanding-excel-layouts"></a>Сведения о макетах Excel

Есть несколько вещей, которые следует знать или учитывать при создании или внесении изменений в макеты Excel. Каждый макет Excel должен включать два элемента: лист **Данные** и таблица **Данные**. Эти элементы составляют основу макета, определяя бизнес-данные из Business Central, с которыми вы можете работать. Вы можете думать о листе **Данные** как о своего рода контракте между макетом и бизнес-данными. Вы будете использовать эти данные в качестве источника расчетов и визуализаций, которые вы хотите представить на других листах.

К структуре книги Excel предъявляются определенные требования. Если требования не соблюдены, у вас возникнут проблемы с использованием макета. На следующей диаграмме и в таблице показаны элементы макета Excel и требования.

[![Показывает разные элементы макета Excel.](media/excel-layout-callouts-2.png)](media/excel-layout-callouts-2.png#lightbox)

|№|Элемент|Описанием|Обязательно|
|---|-------|----|---|
|1|Лист **Данные**|<ul><li>Должно быть имя **Данные**.</li><li>Может включать только одну таблицу, которая должна называться **Данные**.</li></ul>|![Обязательно](media/check.png) | 
|2|Таблица **Данные**|<ul><li>Должно быть имя **Данные**.</li><li>Должен иметь хотя бы один столбец.</li><li>Может включать только столбцы из набора данных отчета.</li><li>Должен начинаться в первой ячейке **А1** листа **Данные**.</li></ul>|![Обязательно](media/check.png)|
|3|Листы презентации|<ul><li>Используется для представления данных.</li><li>Данные поступают с листа **Данные**. </li></ul>||
|4|Лист **Метаданные отчета**|<ul><li>Автоматически включается, если макет был создан путем экспорта другого отчета Excel.</li><li>Содержит общую информацию об отчете.</li><li>Можно удалить.</li></ul>|

Таким образом, это то, что вы должны и не должны делать на листе **Данные**:

- Не меняйте имя листа **Данные**, таблицы **Данные** и столбцов.
- Вы можете удалить или скрыть столбцы.
- Не добавляйте столбцы, если они не включены в набор данных отчета.
- Вы можете размещать листы в любом порядке, с листом **Данные** первым или последним.

## <a name="see-also"></a>См. также

[Управление макетами отчетов](ui-manage-report-layouts.md)  
[Смена текущего макета отчета](ui-how-change-layout-currently-used-report.md)  
[Импорт и экспорт пользовательского макета отчета или документа](ui-how-import-and-export-report-layout.md)  
[Работа с отчетами, пакетными заданиями и XMLport](ui-work-report.md)  
[Подготовка Financial Reporting с помощью финансовых данных и категорий счетов](bi-how-work-account-schedule.md)  
[Бизнес-аналитика](bi.md)  
[Работа с [!INCLUDE[prod_short](includes/prod_short.md)]](ui-work-product.md)  
[Анализ данных отчета с помощью Excel](report-analyze-excel.md)  

[!INCLUDE[footer-include](includes/footer-banner.md)]
