---
title: Работа с отчетами, пакетными заданиями и XMLport
description: Узнайте о вводе отчета в очередь заданий и планирование его обработки в конкретные дату и время.
author: jswymer
ms.service: dynamics365-business-central
ms.topic: conceptual
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: task, process, report, print, schedule, save, Excel, PDF, Word, dataset
ms.date: 06/21/2021
ms.author: jswymer
ms.openlocfilehash: d62c16ef8c511464fde86a1766499e37f8a07b1f
ms.sourcegitcommit: 2ab6709741be16ca8029e2afadf19d28cf00fbc7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/14/2022
ms.locfileid: "7972204"
---
# <a name="working-with-reports-batch-jobs-and-xmlports"></a>Работа с отчетами, пакетными заданиями и XMLport

Отчет собирает информацию на основе указанного набора критериев. Он систематизирует и представляет информацию в удобном для чтения формате, который вы можете распечатать или сохранить в виде файла. Предусмотрено много отчетов, к которым можно получить доступ с помощью приложения. Отчеты обычно содержат сведения относительно контекста страницы, на которой вы находитесь. Например, страница **Клиент** включает отчеты "10 лучших клиентов", "Статистика продаж" и т. п.

Пакетные задания и XMLport более или менее аналогичны отчетам, но используются больше для обработки экспорта данных. Например, пакетное задание **Создать напоминания** создает документы-напоминания для клиентов с просроченными платежами.  

> [!NOTE]
> В этом разделе в основном упоминается "отчет", но аналогичная информация относится к пакетным заданиям и XMLport.

## <a name="getting-started"></a>Приступая к работе

Отчеты можно найти на вкладке **Отчеты** на выбранных страницах или можно использовать поиск ![Лампочка, которая открывает функцию Что вы хотите сделать.](media/ui-search/search_small.png "Что вы хотите сделать") для поиска отчетов по имени.

При открытии отчета, пакетного задания или XMLport обычно отображается страница, запроса позволяющая настроить различные параметры и фильтры, которые определяют, что требуется включить в отчет. В следующих разделах объясняется, как использовать страницу запроса для создания, предварительного просмотра и печати отчета.

## <a name="using-default-values---predefined-settings"></a><a name="SavedSettings"></a>Использование значений по умолчанию — предопределенные настройки 

Большинство страниц запросов включают поле **Использовать значения по умолчанию из**. Это поле позволяет вам выбрать предопределенные настройки для отчета, которые автоматически устанавливают параметры и фильтры для отчета. Выберите запись из раскрывающегося списка, и вы увидите, что параметры и фильтры на странице запроса изменятся соответствующим образом.

Всегда доступна запись **Последние использованные параметры и фильтры**. Эта операция задает в отчете использование параметров и фильтров, которые использовались при последнем использовании отчета.

В поле **Использовать значения по умолчанию из** обеспечивает быстрый и надежный способ создания отчетов, содержащих правильные данные. После выбора записи вы можете изменить любые параметры и фильтры перед предварительным просмотром или печатью отчета. Внесенные изменения не будут сохранены в выбранной операции предопределенных настроек, но будут сохранены в операции **Последние использованные параметры и фильтры**.

>[!NOTE]
> Стандартные настройки обычно устанавливаются и управляются администратором. Дополнительные сведения см. в разделе [Управление сохраненными настройками для отчетов и пакетных заданий](reports-saving-reusing-settings.md).

## <a name="specifying-the-data-to-include-in-reports"></a>Определение данных для включения в отчеты

Используйте поля в **Параметры** и **Фильтры** для изменения ограничения информации, которую вы хотите в отчете. Фильтры в отчете устанавливаются примерно так же, как фильтры в списках. Дополнительные сведения см. в разделе [Фильтрация](ui-enter-criteria-filters.md#filtering).

> [!CAUTION]
> Раздел **Фильтровать список по** на странице запроса предоставляет общие возможности фильтрации для отчетов. Эти фильтры являются необязательными.
>
> Некоторые отчеты игнорируют такие фильтры, то есть выходные данные отчета не зависят от фильтра, заданного в разделе **Фильтровать список по**. Невозможно предоставить список того, какие поля игнорируются в каких отчетах, поэтому вам придется экспериментировать с фильтрами при их использовании.
>
> **Пример**. При использовании пакетного задания **Создать напоминания** фильтр для поля **Книга операций по клиентам** для **Уровень последнего учтенного напоминания** игнорируется, поскольку фильтры являются фиксированными для данного пакетного задания.

## <a name="previewing-a-report"></a>Предварительный просмотр отчета

Предварительный просмотр отчета позволяет увидеть, как он будет выглядеть, перед его печатью. Предварительный просмотр не зависит от выбранного принтера в поле **Принтер** на странице запроса. Он контролируется браузером. После предварительного просмотра вы можете вернуться на страницу запроса и внести необходимые изменения в параметры и фильтры.

Чтобы просмотреть отчет, выберите **Предварительный просмотр** или **Предварительный просмотр и закрытие** на странице запроса отчета. Отображаемая кнопка зависит от отчета, поэтому в некоторых отчетах есть кнопка **Предварительный просмотр**, а у других **Предварительный просмотр и закрытие**. Обе кнопки открывают предварительный просмотр отчета. Разница в том, что **Предварительный просмотр** оставляет страницу запроса открытой, поэтому вы можете вернуться к ней, внести изменения, повторно просмотреть или распечатать. С **Предварительный просмотр и закрытие** страница запроса закрывается, поэтому вам придется снова открыть отчет, чтобы внести изменения или распечатать.

> [!NOTE]
> Если вы используете Business Central выпуска 2020 волны 1 или более раннюю версию, есть только кнопка **Предварительный просмотр**, закрывающая страницу запроса при предварительном просмотре, как описано для **Предварительный просмотр и закрытие**.

### <a name="working-with-the-preview"></a>Работа с предварительным просмотром

В предварительном просмотре используйте строку меню в окне предварительного просмотра отчета для выполнения следующих действий:

- Переход по страницам
- Увеличение и уменьшение
- Изменение размеров по размеру страницы
- Выберите текст

    Можно копировать текст из отчетов, а затем вставлять его в другие места, например на страницу в [!INCLUDE[prod_short](includes/prod_short.md)] или в Microsoft Word.  Например, с помощью мыши вы нажимаете и удерживаете то место, где хотите начать. Затем переместите мышь, чтобы выбрать одно или несколько слов, предложений или абзацев. Нажмите правую кнопку мыши и выберите **Копировать**. Затем выбранный текст можно затем вставить в любом требуемом месте.
- Сдвиньте документ

    Можно переместить видимую область отчета в любом направлении, чтобы просмотреть другие области отчета. Панорамирование удобно, если отчет был увеличен для просмотра подробных сведений.  Например, при использовании мыши, нажмите и удерживайте клавишу мыши в любом месте предварительного просмотра отчета и перемещайте мышь.

- Загрузка в PDF-файл на компьютере или в сети.
- Печать

## <a name="saving-a-report-to-a-file"></a>Сохранение отчета в файл

Можно сохранить отчет в PDF-документ, документ Microsoft Word или книгу Microsoft Excel, выбрав кнопку **Отправить**, затем выбрав нужный вариант.

### <a name="send-to-excel"></a>Отправка в Excel

<!-- The following table describes the options for saving the report results as a worksheet in an Excel workbook.

|Option  |Description  |
|---------|---------|
|Microsoft Excel Document (data and layout)|Export the report results with the RDLC layout applied. Use this option if you want to export the data one time, and only want to make minor changes to its appearance, such as font and color scheme. <br><br>**Note**: Some reports might export numbers as text, so it's a good idea to verify the numbers. |
|Microsoft Excel Document (data only)|Export the report results and the criteria that was used to generate them, such as the parameters you specified on the request page, metadata, and the fields that control the layout of the printed report. Use this option when you want to do ad hoc analysis of the data or diagnose data issues in reports. For example, you can filter the data and use Power Pivot to display it.<br><br>This option exports all columns, including columns that hold formatting instructions for other values and filters. In columns that hold binary data like images, instead of actually values, fields will include the text **Binary data ({0} bytes)**, where **{0}** indicates the number of bytes.<br><br>**NOTE** With Business Central on-premises, the Business Central Server includes a configurations setting, called **Max Data Rows Allowed to Send to Excel**. This setting limits the number of rows that can be exported to Excel. If you don't see the expected number of rows, it might be because of this setting. For more information, see [Configuring Business Central Server](/dynamics365/business-central/dev-itpro/administration/configure-server-instance#General) or contact your administrator.|-->

Есть два варианта сохранения результатов отчета в виде листа в книге Excel: **Документ Microsoft Excel (данные и макет)** и **Документ Microsoft Excel (только данные)**

#### <a name="microsoft-excel-document-data-and-layout"></a>[Документ Microsoft Excel (данные и макет)](#tab/data-and-layout)

Этот параметр доступен только для отчетов, использующих макет RDLC. Он экспортирует результаты отчета с примененным макетом RDLC. Используйте этот вариант, если вы хотите экспортировать данные один раз и хотите внести лишь незначительные изменения в их внешний вид, такие как шрифт и цветовую схему.

#### <a name="microsoft-excel-document-data-only"></a><a name="exportdataonly"></a>[Документ Microsoft Excel (только данные)](#tab/data-only)

При параметре **Документ Microsoft Excel (только данные)** экспортируются результаты отчета и критерии, которые использовались для их создания &mdash; но он не включается макет отчета. Файл Excel будет включать полный набор данных в виде необработанных данных, упорядоченных по строкам и столбцам. Включены все столбцы данных набора данных отчета, независимо от того, используются ли они в макете отчета.  Используйте этот вариант, если хотите:

- Сделать специальный анализ данных. Например, вы можете отфильтровать данные и использовать Power Pivot, чтобы отобразить их.

  Каждый раз, когда вы экспортируете результаты, создается новый лист. С помощью параметра **Документ Microsoft Excel (только данные)** вы можете запустить тот же самый отчет и повторно использовать изменения форматирования. Например, для Power Pivot вы можете запустить отчет еще раз для другого периода времени, скопировать результаты на лист, а затем обновить его. Также приложение отчетности можно найти в [AppSource](https://appsource.microsoft.com/).
- Проверяйте набор данных отчета при создании или изменении настраиваемых макетов отчета.

  Для получения информации о создании настраиваемых макетов отчетов прочитайте [Создание или изменение настраиваемых макетов отчетов](ui-how-create-custom-report-layout.md)
- Диагностируйте проблемы с данными в отчетах.

##### <a name="for-administrators"></a>Для администраторов

- **Документ Microsoft Excel (только данные)** был представлен в качестве дополнительной функции в выпуске 2021 волны 1, обновление 18.3. Чтобы предоставить пользователям доступ к этой функции, включите обновление функции **Сохранить набор данных отчета в документ Microsoft Excel** в **Управление функциями**. Для получения дополнительной информации см. [Раннее включение новых функций](/dynamics365/business-central/dev-itpro/administration/feature-management). В выпуске 2021 волны 2 эта функция станет постоянной, поэтому вам не придется ее включать.

- Учетным записям пользователей потребуется разрешение **<!--Export Report Dataset To Excel-->Разрешить действие "Экспорт набора данных отчета в Excel"**, которое вы можете применить, используя набор разрешений **Инструменты для поиска и устранения неполадок** или **Экспорт отчета в Excel**.  

- Вы не можете экспортировать отчет, содержащий более 1 048 576 строк или 16 384 столбцов.

    > [!NOTE]
    > В локальной версии Business Central максимальное количество экспортируемых строк может быть еще меньше. Business Central Server включает параметр конфигурации, называемый **Максимальное количество строк данных, разрешенное для отправки в Excel**, для уменьшения предела от максимального значения. Для получения дополнительной информации прочитайте [Настройка Business Central Server](/dynamics365/business-central/dev-itpro/administration/configure-server-instance#General) или обратитесь к своему администратору.

##### <a name="for-developers-and-advanced-users"></a>Для разработчиков и опытных пользователей

При параметре **Документ Microsoft Excel (только данные)** экспортируются все столбцы, включая столбцы, содержащие фильтры и инструкции по форматированию для других значений. Вот несколько интересных моментов:

- Двоичные данные в поле, например изображение, не экспортируются.

  В столбцах, содержащих двоичные данные, поля будут включать текст **Двоичные данные (байт: {0})**, где **{0}** указывает количество байтов.
- Начиная с выпуска Business Central 2021 волны 2 файл Excel также включает лист **Метаданные отчета**.

  На этом листе показаны фильтры, примененные к отчету, и общие свойства отчета, такие как имя, идентификатор и сведения о расширении. Фильтры показаны в столбце **Фильтр (DataItem::Table::FilterGroupNo::FieldName)**. Фильтры в этом столбце включают фильтры, установленные на странице запроса отчета. Он также включает фильтры, определенные в коде AL, например [свойство DataItemLink](/dynamics365/business-central/dev-itpro/developer/properties/devenv-dataitemlink-reports-property) и [свойство DataItemTableView](/dynamics365/business-central/dev-itpro/developer/properties/devenv-dataitemtableview-property).

Для получения дополнительной информации о структуре отчетов прочитайте [Обзор отчета](/dynamics365/business-central/dev-itpro/developer/devenv-reports).

---

> [!NOTE]
> В некоторых отчетах числа экспортируются в виде текста, что не позволяет выполнять вычисления или использовать Power Pivot в ячейках на листе Excel. После экспорта рекомендуется проверить числа на листе. Если вы хотите провести анализ и построить диаграммы чисел, измените формат соответствующих ячеек с **Текст** на **Число**. Подробнее о форматировании чисел в ячейках смотрите в видео [Форматирование чисел в ячейках в Microsoft Excel](https://www.youtube.com/watch?v=2suE4YmZu_Q).

### <a name="microsoft-word-document"></a>Документ Microsoft Word
Используйте параметр **Документ Microsoft Word** для создания отчета в виде документа Word.  

> [!NOTE]
> Вы можете указать макет, который будет использоваться для каждого отчета на странице **Выбор отчета** в поле **Выбранный макет**. Настройка по умолчанию для отчетов — **RDLC (встроенный)**, создаются отчеты в том же или аналогичном макете, что и макет **Документ Microsoft Word**. Однако ключевое различие заключается в том, хотите ли вы создать один или несколько отчетных документов. Для отдельных документов вы можете использовать параметр RDLC (встроено). Для нескольких документов установите **Документ Microsoft Word** в качестве макета по умолчанию для отчета. Дополнительные сведения см. в разделе [Управление макетами отчетов и документов](ui-manage-report-layouts.md).

## <a name="scheduling-a-report-to-run"></a><a name="ScheduleReport"></a> Планирование выполнения отчета

Можно запланировать выполнение отчета или пакетного задания на заданную дату и время. Запланированные отчеты и пакетные задания вводятся в очередь заданий и обрабатываются в запланированное время, как и другие задания. После нажатия кнопки **Отправить** необходимо выбрать вариант **Запланировать**, а затем ввести такую информацию, как принтер, время и дата. Отчет добавляется в очередь заданий и будет выполнен в указанное время. Если отчет обработан, элемент будет удален из очереди заданий. Дополнительные сведения см. в разделе [Использование очередей работ для планирования задач](admin-job-queues-schedule-tasks.md).  

Когда вы планируете выполнить отчет, вы можете указать, что он должен выполняться каждый четверг, установив поле **Формула даты следующего запуска** на *D4*, например. Подробнее см. в разделе [Использование формул дат](ui-enter-date-ranges.md#using-date-formulas).  

Можно сохранить отчет в файле (например, Excel, Word или PDF), напечатать его или только создать отчет. Если выбрано сохранить отчет в файл, обработанный отчет отправляется в область **Входящие отчеты** в вашем ролевом центре, где его можно просмотреть.  

## <a name="printing-a-report"></a><a name="PrintReport"></a>Печать отчета

Для печати отчета выберите кнопку **Печать** на странице запроса или в строке меню на странице **Предварительный просмотр**.

### <a name="printer"></a><a name="Printer"></a>Принтер

Поле **Принтер** на странице запроса содержит название принтера, на который будет отправлен отчет. Чтобы сменить принтер, просто выберите принтер из списка.

> [!NOTE]
> **(Обрабатывается браузером)** означает, что для отчета не назначен принтер. В этом случае браузер обработает распечатку и отобразит стандартный интерфейс, где вы можете выбрать локальный принтер, подключенный к вашему устройству. Пункт **(Обрабатывается браузером)** недоступен в мобильном приложении [!INCLUDE[prod_short](includes/prod_short.md)] или приложении для Microsoft Teams.

> [!TIP]
> Принтер, выбранный по умолчанию, настраивается на странице **Выбор принтера**. Для получения информации об изменении принтера по умолчанию см. раздел [Чтобы выбрать, на каких принтерах печатаются какие отчеты](ui-specify-printer-selection-reports.md#default).

### <a name="printing-reports-in-thai"></a>Печать отчетов на тайском языке

Конкретно в тайской версии [!INCLUDE[prod_short](includes/prod_short.md)] кнопка **Печать** не может правильно печатать отчеты из-за ограничений в службе, которая формирует пригодный для печати PDF-файл. Вместо этого, можно открыть в отчет в Word, затем сохранить его как печатаемый PDF.  

Или можно попросить администратора создать макет отчета Word для наиболее часто используемых отчетов. Дополнительные сведения см. в разделе [Управление макетами отчетов и документов](ui-manage-report-layouts.md).  

## <a name="changing-report-layouts"></a>Смена макетов отчетов

Макет отчета определяет, что отображается в отчете, как он скомпонован и в каком стиле. Если требуется переключиться на другой макет, см. раздел [Смена текущего макета отчета](ui-how-change-layout-currently-used-report.md). Если требуется настроить собственный макет отчета, см. раздел [Создание и изменение пользовательского макета отчета](ui-how-create-custom-report-layout.md).

## <a name="advanced-options"></a>Дополнительные параметры

Поля в **Дополнительно** задают ограничения для создаваемого отчета для управления ресурсами принтера. Обычно вам не нужно менять эти настройки, если у вас нет большого отчета. Если отчет превышает эти ограничения при попытке предварительного просмотра или печати, появляется сообщение о том, какое ограничение было превышено. Затем вы можете изменить настройки в соответствии с вашим отчетом. Однако каждое поле имеет максимальное значение, о котором вам следует знать:

|Поле|Максимальное значение|
|-----|-------------|
|Максимальное время отрисовки|12:00:00|
|Максимальное количество строк|1000 000|
|Максимальное количество документов|500|

> [!NOTE]
> Максимальные значения могут быть разными для [!INCLUDE[prod_short](includes/prod_short.md)] (локальная версия), и администратор может их изменить. Дополнительные сведения см. в разделе [Настройка Business Central Server — отчеты](/dynamics365/business-central/dev-itpro/administration/configure-server-instance#Reports). Для обзора ограничений отчетов [!INCLUDE[prod_short](includes/prod_short.md)] (онлайн), см. [Операционные ограничения](/dynamics365/business-central/dev-itpro/administration/operational-limits-online).

## <a name="see-also"></a>См. также

[Настройка принтеров](ui-specify-printer-selection-reports.md)  
[Работа с календарными датами и значениями времени](ui-enter-date-ranges.md)  
[Управление макетами отчетов и документов](ui-manage-report-layouts.md)  
[Работа с [!INCLUDE[prod_short](includes/prod_short.md)]](ui-work-product.md)


[!INCLUDE[footer-include](includes/footer-banner.md)]